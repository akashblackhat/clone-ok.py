import marshal,base64
exec(base64.b64decode(" IyMjIEltcG9ydCBNb2R1bGUKaW1wb3J0IHJlcXVlc3RzLCBiczQsIHN5cywgb3MsIHJhbmRvbSwgdGltZSwgcmUsIGpzb24sIHV1aWQsIHN1YnByb2Nlc3MsIHBsYXRmb3JtLCBiYXNlNjQKZnJvbSByYW5kb20gaW1wb3J0IHJhbmRpbnQKZnJvbSBjb25jdXJyZW50LmZ1dHVyZXMgaW1wb3J0IFRocmVhZFBvb2xFeGVjdXRvciBhcyBUaHJlYWRQb29sCmZyb20gYnM0IGltcG9ydCBCZWF1dGlmdWxTb3VwIGFzIHBhcgpmcm9tIGRhdGV0aW1lIGltcG9ydCBkYXRlCmZyb20gZGF0ZXRpbWUgaW1wb3J0IGRhdGV0aW1lCmZyb20gdXJsbGliLnBhcnNlIGltcG9ydCBxdW90ZQoKIyMjIFBlcnVtcGFtYWFuIE1vZHVsZSAmIFN5bnRheApfcmVxX3Nlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCkKX3JlcV9nZXRfID0gcmVxdWVzdHMuZ2V0Cl9yZXFfcG9zdF8gPSByZXF1ZXN0cy5wb3N0Cl9qc19sb18gPSBqc29uLmxvYWRzCl9jaWNpX2F6aW12YXVfID0gaW5wdXQKX2F6aW12YXVfZGFwdW50YV8gPSBvcGVuCl9jaWNpX2NpY2lfID0gZXhpdAoKIyMjIFdhcm5hClogPSAiXDAzM1sxOzMwbSIgICMgSGl0YW0KUCA9ICJcMDMzWzE7MzdtIiAgIyBQdXRpaApNID0gIlwwMzNbMTszMW0iICAjIE1lcmFoCkggPSAiXDAzM1sxOzMybSIgICMgSGlqYXUKSyA9ICJcMDMzWzE7MzNtIiAgIyBLdW5pbmcKQiA9ICJcMDMzWzE7MzRtIiAgIyBCaXJ1ClUgPSAiXDAzM1sxOzM1bSIgICMgVW5ndQpPID0gIlwwMzNbMTszNm0iICAjIEJpcnUgTXVkYQpOID0gIlwwMzNbMG0iICAjIFdhcm5hIE1hdGkKCiMjIyBIb3N0ICYgUGVuYW1wdW5nYW4KaG9zdCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20iCm9rID0gW10KY3AgPSBbXQp0dGwgPSBbXQpjb3VudCA9IDEKZGF0YV8xID0ge30KZGF0YV8yID0ge30KZGF0YV9jaGFuZ2VfMSA9IHt9CmRhdGFfY2hhbmdlXzIgPSB7fQpkYXRhX3VzZXIgPSBbXQpoZWFkZXJfZ3J1cCA9IHsKICAgICJ1c2VyLWFnZW50IjogIk1vemlsbGEvNS4wIChNYWNpbnRvc2g7IEludGVsIE1hYyBPUyBYIDEwXzE1XzcpIEFwcGxlV2ViS2l0LzUzNy4zNiAoS0hUTUwsIGxpa2UgR2Vja28pIENocm9tZS85Ni4wLjQ2NjQuMTEwIFNhZmFyaS81MzcuMzYifQpoZWFkZXJfbmFtYSA9IHsib3JpZ2luIjogImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbSIsICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tR0IsZW4tVVM7cT0wLjksZW47cT0wLjgsYm47cT0wLjciLAogICAgICAgICAgICAgICAiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLAogICAgICAgICAgICAgICAiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLAogICAgICAgICAgICAgICAidXNlci1hZ2VudCI6ICJNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNC40LjQ7IGVuLWF1OyBTQU1TVU5HIFNNLU45MTVHIEJ1aWxkL0tUVTg0UCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLVEhNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8yLjAgQ2hyb21lLzM0LjAuMTg0Ny43NiBNb2JpbGUgU2FmYXJpLzUzNy4zNiIsCiAgICAgICAgICAgICAgICJIb3N0IjogIiIuam9pbihiczQucmUuZmluZGFsbCgiOi8vKC4qPykkIiwgImh0dHBzOi8vbS5mYWNlYm9vay5jb20iKSksCiAgICAgICAgICAgICAgICJyZWZlcmVyIjogImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04IiwgImNhY2hlLWNvbnRyb2wiOiAibWF4LWFnZT0wIiwKICAgICAgICAgICAgICAgInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiAiMSIsICJjb250ZW50LXR5cGUiOiAiYXBwbGljYXRpb24veC13d3ctZm9ybS11cmxlbmNvZGVkIn0KaGVhZGVyX2hhc2h0YWcgPSB7J2F1dGhvcml0eSc6ICdtYmFzaWMuZmFjZWJvb2suY29tJywgJ21ldGhvZCc6ICdHRVQnLCAncGF0aCc6ICcvZmF2aWNvbi5pY28nLCAnc2NoZW1lJzogJ2h0dHBzJywKICAgICAgICAgICAgICAgICAgJ2FjY2VwdCc6ICdpbWFnZS9hdmlmLGltYWdlL3dlYnAsaW1hZ2UvYXBuZyxpbWFnZS9zdmcreG1sLGltYWdlLyosKi8qO3E9MC44JywKICAgICAgICAgICAgICAgICAgJ2FjY2VwdC1lbmNvZGluZyc6ICdnemlwLCBkZWZsYXRlJywgJ2FjY2VwdC1sYW5ndWFnZSc6ICdlbi1VUyxlbjtxPTAuOScsCiAgICAgICAgICAgICAgICAgICd1c2VyLWFnZW50JzogJ01vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjQuNDsgZW4tYXU7IFNBTVNVTkcgU00tTjkxNUcgQnVpbGQvS1RVODRQKSBBcHBsZVdlYktpdC81MzcuMzYgKEtUSE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzIuMCBDaHJvbWUvMzQuMC4xODQ3Ljc2IE1vYmlsZSBTYWZhcmkvNTM3LjM2JywKICAgICAgICAgICAgICAgICAgJ29yaWdpbic6ICdodHRwczovL3d3dy5mYWNlYm9vay5jb20nLCAncmVmZXJlcic6ICdodHRwczovL3d3dy5mYWNlYm9vay5jb20nfQoKciA9IHN0cihyYW5kb20ucmFuZGludCgxLCA5OTk5KSkKcnggPSByLnJlcGxhY2UoIjEiLCAiQSIpLnJlcGxhY2UoIjIiLCAiQyIpLnJlcGxhY2UoIjMiLCAiQiIpLnJlcGxhY2UoIjQiLCAiRSIpLnJlcGxhY2UoIjUiLCAiSCIpLnJlcGxhY2UoIjYiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiSSIpLnJlcGxhY2UoCiAgICAiNyIsICJZIikKcGxpc3QgPSAocGxhdGZvcm0udW5hbWUoKSlbMl0KYmFzZXggPSBwbGlzdApiYXNleDEgPSBiYXNleC5lbmNvZGUoJ2FzY2lpJykKYmFzZXgyID0gYmFzZTY0LmI2NGVuY29kZShiYXNleDEpCmJhc2V4MyA9IGJhc2V4Mi5kZWNvZGUoJ2FzY2lpJykKYmFzZTQgPSAoYmFzZXgzKS51cHBlcigpCmJhc2VzcGxpdCA9IGJhc2U0LnJlcGxhY2UoJz0nLCAnTicpLnJlcGxhY2UoJ0EnLCAnMycpLnJlcGxhY2UoJ0InLCAnOScpLnJlcGxhY2UoJ0MnLCAnNycpLnJlcGxhY2UoJ0QnLCAnMScpLnJlcGxhY2UoJ0UnLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICc0JykucmVwbGFjZSgKICAgICdNJywgJzInKS5yZXBsYWNlKCdMJywgJzYnKS5yZXBsYWNlKCdGJywgJzgnKS5yZXBsYWNlKCdOJywgJ0UnKS5yZXBsYWNlKCdUJywgJ1InKS5yZXBsYWNlKCI1IiwgIlgiKS5yZXBsYWNlKCIxIiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJYIikKCnRyeToKICAgIHJxID0gcmVxdWVzdHMuZ2V0KCdodHRwczovL3Bhc3RlYmluLmNvbS9yYXcvbkVwanQ2UU4nKS50ZXh0CmV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjoKICAgIHByaW50KCdcbk5PIElOVEVSTkVUIENPTk5FQ1RJT05cbicpCiAgICBleGl0KCkKCiMjIyBXYWt0dSAmIFRhbmdnYWwKX19zZWthcmFuZ19fID0gZGF0ZXRpbWUubm93KCkKX190YWh1bl9fID0gX19zZWthcmFuZ19fLnllYXIKX19idWxhbl9fID0gX19zZWthcmFuZ19fLm1vbnRoCl9faGFyaV9fID0gX19zZWthcmFuZ19fLmRheQoKYnVsYW5fdHRsID0geyIwMSI6ICJKQU4iLCAiMDIiOiAiRkVCIiwgIjAzIjogIk1BUiIsICIwNCI6ICJBUFIiLCAiMDUiOiAiTUFZIiwgIjA2IjogIkpVTiIsICIwNyI6ICJKVUwiLCAiMDgiOiAiQVVHIiwKICAgICAgICAgICAgICIwOSI6ICJTRVAiLCAiMTAiOiAiT0NUIiwgIjExIjogIk5PViIsICIxMiI6ICJERUMifQpfbGlzdF9idWxhbl8gPSBbIkpBTiIsICJGRUIiLCAiTUFSIiwgIkFQUiIsICJNQVkiLCAiSlVOIiwgIkpVTCIsICJBVUciLCAiU0VQIiwgIk9DVCIsICJOT1YiLCAiREVDIl0KCnRyeToKICAgIGlmIF9fYnVsYW5fXyA8IDAgb3IgX19idWxhbl9fID4gMTI6CiAgICAgICAgX2NpY2lfY2ljaV8oKQogICAgX2J1bGFuX3Nla2FyYW5nXyA9IF9fYnVsYW5fXyAtIDEKZXhjZXB0IFZhbHVlRXJyb3I6CiAgICBfY2ljaV9jaWNpXygpCl9idWxhbl8gPSBfbGlzdF9idWxhbl9bX2J1bGFuX3Nla2FyYW5nX10KdGFuZ2dhbCA9ICgiJXMtJXMtJXMiICUgKF9faGFyaV9fLCBfYnVsYW5fLCBfX3RhaHVuX18pKQoKX215X2FjY291bnRfID0gWwogICAgJzEwMDA0NTIwMzg1NTI5NCcsICcxMDAwMTQ4MzkyNzAyMDUnXQoKIyMjIFVzZXIgQWdlbnQKdWFfaW50ZWxtYWMgPSAnTW96aWxsYS81LjAgKE1hY2ludG9zaDsgSW50ZWwgTWFjIE9TIFggMTBfMTVfNykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzk2LjAuNDY2NC4xMTAgU2FmYXJpLzUzNy4zNjtdJwp1YV9ub2tpYSA9ICdNb3ppbGxhLzQuMSAoY29tcGF0aWJsZTsgTVNJRSA1LjA7IFN5bWJpYW4gT1M7IE5va2lhIDc2MTA7NDUxKSBPcGVyYSA2LjIwJwp1YV9hc3VzID0gJ0RhbHZpay8xLjYuMCAoTGludXg7IFU7IEFuZHJvaWQgNC40LjI7IEFTVVNfVDAwUSBCdWlsZC9LVlQ0OUwpL0NMREMtMS4xO10nCnVhX2h1YXdlaSA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNy4wOyBIVUFXRUkgQ0FaLUFMMTA7IEhNU0NvcmUgNS4zLjAuMzEyOyBHTVNDb3JlIDIwLjM5LjE1KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvODMuMC40MTAzLjEwNiBIdWF3ZWlCcm93c2VyLzExLjEuMC4zMDIgTW9iaWxlIFNhZmFyaS81MzcuMzYgW0ZCQU4vRU1BO0ZCTEMvZW5fVVM7RkJBVi8xNzMuMC4wLjEwLjExODtdJyAgIyBET05FCnVhX3Zpdm8gPSAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBWMjAyNykgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgQ2hyb21lLzgwLjAuMzk4Ny45OSBNb2JpbGUgU2FmYXJpLzUzNy4zNicKdWFfb3BwbyA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNC4xLjE7IFg5MDkgQnVpbGQvSlJPMDNMKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMzAuMC4xNTk5LjkyIE1vYmlsZSBTYWZhcmkvNTM3LjM2IFtGQkFOL0VNQTtGQkxDL2VuX1VTO0ZCQVYvMTczLjAuMC4xMC4xMTg7XScKdWFfc2Ftc3VuZyA9ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNS4wLjE7IFNBTVNVTkcgR1QtSTk1MTUgQnVpbGQvTFJYMjJDKSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBTYW1zdW5nQnJvd3Nlci8yLjEgQ2hyb21lLzM0LjAuMTg0Ny43NiBNb2JpbGUgU2FmYXJpLzUzNy4zNjtdJwp1YV93aW5kb3dzID0gJ01vemlsbGEvNS4wIChYMTE7IFU7IExpbnV4IGk2ODY7IGZyLUZSOyBydjoxLjcuOCkgR2Vja28vMjAwNTA1MTEgRmlyZWZveC8xLjAuNDtdJwp1YV94aWFvbWkgPSAnTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDExOyBNaSA5VCBQcm8gQnVpbGQvUktRMS4yMDA4MjYuMDAyOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzk0LjAuNDYwNi44MCBNb2JpbGUgU2FmYXJpLzUzNy4zNiBSZWRkaXQvVmVyc2lvbiAyMDIxLjM4LjAvQnVpbGQgMzY1MDMyL0FuZHJvaWQgMTEgW0ZCQU4vRU1BO0ZCTEMvZW5fVVM7RkJBVi8yNDcuMC4wLjUuMTMwO10nCgoKIyMjIENsZWFyIExvZ2luIFNlc3Npb24KZGVmIGJlcnNpaCgpOgogICAgdHJ5OgogICAgICAgIG9zLnJlbW92ZSgndG9rZW4udHh0JykKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKCdjb29raWVzLnR4dCcpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwoKCiMjIyBEaXNwbGF5IFRleHQKZGVmIGphbGFuKHopOgogICAgZm9yIGUgaW4geiArICJcbiI6IHN5cy5zdGRvdXQud3JpdGUoZSk7c3lzLnN0ZG91dC5mbHVzaCgpO3RpbWUuc2xlZXAoMC4wNCkKCgpkZWYgbWxha3Uoeik6CiAgICBmb3IgZSBpbiB6ICsgIlxuIjogc3lzLnN0ZG91dC53cml0ZShlKTtzeXMuc3Rkb3V0LmZsdXNoKCk7dGltZS5zbGVlcCgwLjAzKQoKCmRlZiBwc2Ioeik6CiAgICBmb3IgZSBpbiB6ICsgJ1xuJzoKICAgICAgICBzeXMuc3Rkb3V0LndyaXRlKGUpCiAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgdGltZS5zbGVlcCgwLjAwMSkKCgojIyMgQ2xlYXIgVGVybWluYWwKZGVmIGNsZWFyKCk6CiAgICBpZiAibGludXgiIGluIHN5cy5wbGF0Zm9ybS5sb3dlcigpOgogICAgICAgIG9zLnN5c3RlbSgiY2xlYXIiKQogICAgZWxpZiAid2luIiBpbiBzeXMucGxhdGZvcm0ubG93ZXIoKToKICAgICAgICBvcy5zeXN0ZW0oImNscyIpCiAgICBlbHNlOgogICAgICAgIG9zLnN5c3RlbSgiY2xlYXIiKQoKCmxvZ28gPSAiIiIKXDAzM1sxOzkxbSAgICAgICAgICAgClwwMzNbMTs5MW0gIAog4paI4paI4paI4paI4paI4pWXIOKWiOKWiOKVlyAg4paI4paI4pWXIOKWiOKWiOKWiOKWiOKWiOKVlyDilojilojilojilojilojilojilojilZfilojilojilZcgIOKWiOKWiOKVlwrilojilojilZTilZDilZDilojilojilZfilojilojilZEg4paI4paI4pWU4pWd4paI4paI4pWU4pWQ4pWQ4paI4paI4pWX4paI4paI4pWU4pWQ4pWQ4pWQ4pWQ4pWd4paI4paI4pWRICDilojilojilZEK4paI4paI4paI4paI4paI4paI4paI4pWR4paI4paI4paI4paI4paI4pWU4pWdIOKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVl+KWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkQrilojilojilZTilZDilZDilojilojilZHilojilojilZTilZDilojilojilZcg4paI4paI4pWU4pWQ4pWQ4paI4paI4pWR4pWa4pWQ4pWQ4pWQ4pWQ4paI4paI4pWR4paI4paI4pWU4pWQ4pWQ4paI4paI4pWRCuKWiOKWiOKVkSAg4paI4paI4pWR4paI4paI4pWRICDilojilojilZfilojilojilZEgIOKWiOKWiOKVkeKWiOKWiOKWiOKWiOKWiOKWiOKWiOKVkeKWiOKWiOKVkSAg4paI4paI4pWRCuKVmuKVkOKVnSAg4pWa4pWQ4pWd4pWa4pWQ4pWdICDilZrilZDilZ3ilZrilZDilZ0gIOKVmuKVkOKVneKVmuKVkOKVkOKVkOKVkOKVkOKVkOKVneKVmuKVkOKVnSAg4pWa4pWQ4pWdIFYyLjAKTVkgSEFDS0lORyBHUk9VUCA6IGh0dHBzOi8vcmIuZ3kvbTNwdWF0CiAgICAgICAgICAgICBGQUNFQk9PSyBDTE9ORVIKXDAzM1sxOzk3bS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tClwwMzNbMTs5MW0gQXV0aG9yICAgICAgOiBBS0FTSCBCTEFDSyBIQVQKXDAzM1sxOzkxbSBXaGF0c0FwcCAgICA6ICs5MSA4Mzg5MDIwOTQ5ClwwMzNbMTs5MW0gWW91VHViZSAgICAgOiBURUNITklDQUwgQUtBU0ggU0tJTExTIApcMDMzWzE7OTFtIEZBQ0VCT09LICAgIDogaHR0cHM6Ly9yYi5neS9tM3B1YXQKXDAzM1sxOzkxbSBUSVAgICAgICAgICA6IFVTRSA0RyBTSU0gClwwMzNbMTs5N20tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLQoiIiIKCgojIyMgTG9nbwpkZWYgYmFubmVyKCk6CiAgICBvcy5zeXN0ZW0oImNsZWFyIikKICAgIHByaW50KGxvZ28pCgoKZGVmIGNla19kZXYoKToKICAgIF9pc2lfZGV2XyA9IF9hemltdmF1X2RhcHVudGFfKCdjb29raWVzLnR4dCcsICdyJykucmVhZCgpCiAgICBpZiAnbnVsbCcgaW4gX2lzaV9kZXZfOgogICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVJTlZBTElEIENPT0tJRVMsIFJFLUxPR0lOIFdJVEggQ09PS0lFUycgJSAoTSwgUCwgTSwgUCkpO2JlcnNpaCgpO19jaWNpX2NpY2lfKCkKICAgIGVsc2U6CiAgICAgICAgcGFzcwoKCmRlZiBib3RfZm9sbG93KF90b2tfZGV2Xyk6CiAgICB0cnk6CiAgICAgICAgZm9yIF9saXN0XyBpbiBfbXlfYWNjb3VudF86CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIF9yZXFfcG9zdF8oCiAgICAgICAgICAgICAgICAgICAgImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL3N1YnNjcmliZXJzP2FjY2Vzc190b2tlbj0lcyIgJSAoX2xpc3RfLCBfdG9rX2Rldl8pKTt0aW1lLnNsZWVwKDAuMykKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgIHByaW50KCclcyAnICUgKE8pKTsKICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0xPR0lOIFNVQ0NFU1NGVUwgJXNeX14nICUgKEgsIFAsIEgsIEgsIFApKTsKICAgICAgICB0aW1lLnNsZWVwKDIpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwoKCmRlZiBtZW51X2xvZygpOgogICAgYmVyc2loKCk7CiAgICBjbGVhcigpCiAgICBiYW5uZXIoKQogICAgdmFyX21lbnUoKQogICAgcG11ID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICVzJyAlIChILCBQLCBILCBLLCBIKSkKICAgIHByaW50KCclcyAnICUgKE8pKQogICAgaWYgcG11IGluIFsnJ106CiAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgUCkpO21lbnVfbG9nKCkKICAgIGVsaWYgcG11IGluIFsnMScsICcwMScsICcwMDEnLCAnYSddOgogICAgICAgIGRlZmF1bHR1YSgpCiAgICAgICAgdG9rZW4gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzVE9LRU4gOiAlcycgJSAoSCwgUCwgSCwgSywgSCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB4ID0gX3JlcV9nZXRfKCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49IiArIHRva2VuKTt5ID0gX2pzX2xvXyh4LnRleHQpO24gPSB5WwogICAgICAgICAgICAgICAgJ25hbWUnXTt4ZCA9IF9hemltdmF1X2RhcHVudGFfKCJ0b2tlbi50eHQiLCAidyIpO3hkLndyaXRlKHRva2VuKTt4ZC5jbG9zZSgpO3h6ID0gX2F6aW12YXVfZGFwdW50YV8oCiAgICAgICAgICAgICAgICAnY29va2llcy50eHQnLCAndycpO3h6LndyaXRlKCdudWxsJyk7eHouY2xvc2UoKTtib3RfZm9sbG93KHRva2VuKTttZW51KCkKICAgICAgICBleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpO2phbGFuKCclcyBbJXMhJXNdICVzVE9LRU4gSU5WQUxJRCcgJSAoTSwgUCwgTSwgUCkpO2JlcnNpaCgpO21lbnVfbG9nKCkKICAgICAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6CiAgICAgICAgICAgIHByaW50KCclcyAnICUgKE8pKTtqYWxhbignJXMgWyVzISVzXSAlc0NPTk5FQ1RJT04gUFJPQkxFTScgJSAoTSwgUCwgTSwgUCkpO19jaWNpX2NpY2lfKCkKICAgIGVsaWYgcG11IGluIFsnMicsICcwMicsICcwMDInLCAnYiddOgogICAgICAgIGRlZmF1bHR1YSgpCiAgICAgICAgY29va2llID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NPT0tJRVMgOiAlcycgJSAoSCwgUCwgSCwgSywgSCkpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBoZWFkZXIgPSB7J0hvc3QnOiAnYnVzaW5lc3MuZmFjZWJvb2suY29tJywgJ2NhY2hlLWNvbnRyb2wnOiAnbWF4LWFnZT0wJywgJ3VwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMnOiAnMScsCiAgICAgICAgICAgICAgICAgICAgICAndXNlci1hZ2VudCc6ICdNb3ppbGxhLzUuMCAoTGludXg7IEFuZHJvaWQgNC40LjQ7IGVuLWF1OyBTQU1TVU5HIFNNLU45MTVHIEJ1aWxkL0tUVTg0UCkgQXBwbGVXZWJLaXQvNTM3LjM2IChLVEhNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi8yLjAgQ2hyb21lLzM0LjAuMTg0Ny43NiBNb2JpbGUgU2FmYXJpLzUzNy4zNicsCiAgICAgICAgICAgICAgICAgICAgICAnYWNjZXB0JzogJ3RleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgnLAogICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnQtdHlwZSc6ICd0ZXh0L2h0bWw7IGNoYXJzZXQ9dXRmLTgnLCAnYWNjZXB0LWVuY29kaW5nJzogJ2d6aXAsIGRlZmxhdGUnLAogICAgICAgICAgICAgICAgICAgICAgJ2FjY2VwdC1sYW5ndWFnZSc6ICdlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNycsICdjb29raWUnOiBjb29raWV9O3IgPSBfcmVxX2dldF8oCiAgICAgICAgICAgICAgICAiaHR0cHM6Ly9idXNpbmVzcy5mYWNlYm9vay5jb20vY3JlYXRvcnN0dWRpby9ob21lIiwgaGVhZGVycz1oZWFkZXIpO3AgPSByZS5zZWFyY2goCiAgICAgICAgICAgICAgICAneyJhY2Nlc3NUb2tlbiI6IihFQUFcdyspJywgci50ZXh0KTt0b2tlbiA9IHAuZ3JvdXAoMSk7eGQgPSBfYXppbXZhdV9kYXB1bnRhXygidG9rZW4udHh0IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJ3Iik7eGQud3JpdGUoCiAgICAgICAgICAgICAgICB0b2tlbik7eGQuY2xvc2UoKTt4eiA9IF9hemltdmF1X2RhcHVudGFfKCdjb29raWVzLnR4dCcsICd3Jyk7eHoud3JpdGUoY29va2llKTt4ei5jbG9zZSgpO2JvdF9mb2xsb3coCiAgICAgICAgICAgICAgICB0b2tlbik7bWVudSgpCiAgICAgICAgZXhjZXB0IHJlcXVlc3RzLmV4Y2VwdGlvbnMuQ29ubmVjdGlvbkVycm9yOgogICAgICAgICAgICBwcmludCgnJXMgJyAlIChPKSk7amFsYW4oJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nICUgKE0sIFAsIE0sIFApKTtfY2ljaV9jaWNpXygpCiAgICAgICAgZXhjZXB0IChLZXlFcnJvciwgSU9FcnJvciwgQXR0cmlidXRlRXJyb3IpOgogICAgICAgICAgICBwcmludCgnJXMgJyAlIChPKSk7amFsYW4oJyVzIFslcyElc10gJXNDT09LSUVTIElOVkFMSUQnICUgKE0sIFAsIE0sIFApKTtiZXJzaWgoKTttZW51X2xvZygpCiAgICBlbGlmIHBtdSBpbiBbJzAnLCAnMDAnLCAnMDAwJywgJ3onXToKICAgICAgICBleGl0KCkKICAgIGVsc2U6CiAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgUCkpO21lbnVfbG9nKCkKCgpkZWYgbWVudSgpOgogICAgY2xlYXIoKQogICAgYmFubmVyKCkKICAgIGppZCA9ICcnCiAgICB0cnk6CiAgICAgICAgX2F6aW12YXVfID0gX2F6aW12YXVfZGFwdW50YV8oInRva2VuLnR4dCIsICJyIikucmVhZCgpOwogICAgICAgIF9jaWNpXyA9IF9hemltdmF1X2RhcHVudGFfKCJjb29raWVzLnR4dCIsICJyIikucmVhZCgpOwogICAgICAgIF9zYWxzYWJpbGFfID0geyJjb29raWUiOiBfY2ljaV99CiAgICAgICAgaWYgJ251bGwnIGluIF9jaWNpXzoKICAgICAgICAgICAgc3RhdHVzX2Nvb2tpZXMgPSAoJyVzTk8nICUgKE0pKTtXID0gWjtZID0gUDsgQjEgPSBaOyBPMSA9IFo7IEsxID0gWjsgSDEgPSBaOyBNMSA9IFo7IFAxID0gWgogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHN0YXR1c19jb29raWVzID0gKCclc1lFUycgJSAoSCkpO1cgPSBIOyBZID0gSzsgQjEgPSBCOyBPMSA9IE87IEsxID0gSzsgSDEgPSBIOyBNMSA9IE07IFAxID0gUAogICAgZXhjZXB0IChLZXlFcnJvciwgSU9FcnJvcik6CiAgICAgICAgcHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcycgJSAoTSwgUCwgTSwgUCkpO3ByaW50KCclcyAnICUgKE0pKTtqYWxhbigKICAgICAgICAgICAgJyVzIFslcyElc10gJXNUT0tFTi9DT09LSUVTIElOVkFMSUQnICUgKE0sIFAsIE0sIFApKTtiZXJzaWgoKTttZW51X2xvZygpCgogICAgdHJ5OgogICAgICAgIHRva2VuID0gX2F6aW12YXVfZGFwdW50YV8oInRva2VuLnR4dCIsICJyIikucmVhZCgpO3ggPSBfcmVxX2dldF8oCiAgICAgICAgICAgICJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS9tZT9hY2Nlc3NfdG9rZW49IiArIHRva2VuKTt5ID0gX2pzX2xvXyh4LnRleHQpO24gPSB5WyduYW1lJ10udXBwZXIoKTtpID0geVsnaWQnXQogICAgZXhjZXB0IChLZXlFcnJvciwgSU9FcnJvcik6CiAgICAgICAgcHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcycgJSAoTSwgUCwgTSwgTSkpO3ByaW50KCclcyAnICUgKE0pKTtqYWxhbigKICAgICAgICAgICAgJyVzIFslcyElc10gJXNUT0tFTi9DT09LSUVTIElOVkFMSUQnICUgKE0sIFAsIE0sIFApKTtiZXJzaWgoKTttZW51X2xvZygpCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6CiAgICAgICAgcHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcycgJSAoTSwgUCwgTSwgUCkpO3ByaW50KCclcyAnICUgKE0pKTtqYWxhbigKICAgICAgICAgICAgJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nICUgKE0sIFAsIE0sIFApKTtfY2ljaV9jaWNpXygpCiAgICBleGNlcHQgcmVxdWVzdHMuZXhjZXB0aW9ucy5Db25uZWN0aW9uRXJyb3I6CiAgICAgICAgcHJpbnQoJyVzIFsgJXNPUFBTUyA6KSAlc10lcycgJSAoTSwgUCwgTSwgUCkpO3ByaW50KCclcyAnICUgKE0pKTtqYWxhbigKICAgICAgICAgICAgJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nICUgKE0sIFAsIE0sIFApKTtfY2ljaV9jaWNpXygpCiAgICB0cnk6CiAgICAgICAgYSA9IF9yZXFfZ2V0XygiaHR0cDovL2lwLWFwaS5jb20vanNvbi8iLAogICAgICAgICAgICAgICAgICAgICAgaGVhZGVycz17IlJlZmVyZXIiOiAiaHR0cDovL2lwLWFwaS5jb20vIiwgIkNvbnRlbnQtVHlwZSI6ICJhcHBsaWNhdGlvbi9qc29uOyBjaGFyc2V0PXV0Zi04IiwKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJVc2VyLUFnZW50IjogIk1vemlsbGEvNS4wIChMaW51eDsgQW5kcm9pZCA0LjQuNDsgZW4tYXU7IFNBTVNVTkcgU00tTjkxNUcgQnVpbGQvS1RVODRQKSBBcHBsZVdlYktpdC81MzcuMzYgKEtUSE1MLCBsaWtlIEdlY2tvKSBWZXJzaW9uLzIuMCBDaHJvbWUvMzQuMC4xODQ3Ljc2IE1vYmlsZSBTYWZhcmkvNTM3LjM2O10ifSkuanNvbigpO2lwID0gXAogICAgICAgIGFbInF1ZXJ5Il07bG9jID0gYVsiY291bnRyeSJdLnVwcGVyKCkKICAgIGV4Y2VwdCBLZXlFcnJvcjoKICAgICAgICBpcCA9ICIgIgogICAgcHNiKCcgICAgICAgICAlc+OAiyVz44CLJXPjgIslc1dlbGNvbWUlc+OAiiVz44CKJXPjgIonICUgKE0sIEgsIEIsIEgsIEIsIEgsIE0pKQogICAgcHJpbnQoJyVzICcgJSAoTykpCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzTkFNRSAgICVzOiAlcyVzJyAlIChILCBQLCBILCBCLCBLLCBILCBuKSkKICAgIHByaW50KCclcyBbJXPigKIlc10gJXNJRCAgICAgJXM6ICVzJXMnICUgKEgsIFAsIEgsIEIsIEssIEgsIGkpKQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0lQICAgICAlczogJXMlcycgJSAoSCwgUCwgSCwgQiwgSywgSCwgaXApKQogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0ZST00gICAlczogJXMlcycgJSAoSCwgUCwgSCwgQiwgSywgSCwgbG9jKSkKICAgIHByaW50KCcnKQogICAgcHJpbnQoJyVzIFslcz5fJXNdICVzVE9LRU4lcy8lc0NPT0tJRVMgJXM6ICVzWUVTJXMvJXMnICUgKEgsIFAsIEgsIEIsIFosIEIsIEssIEgsIFAsIHN0YXR1c19jb29raWVzKSkKICAgIHByaW50KCclcyAnICUgKE8pKQogICAgcHNiKCclcyBbJXMwMSVzXSAlc0NyYWNrIFBVQkxJQyBJRCAnICUgKEgsIFAsIEgsIEgpKQogICAgcHNiKCclcyBbJXMwMiVzXSAlc0NyYWNrIEZST00gRk9MTE9XRVIgSUQgVjEnICUgKEgsIFAsIEgsIEIxKSkKICAgIHBzYignJXMgWyVzMDQlc10gJXNDcmFjayBGUk9NIFNFQVJDSCBOQU1FIElEICcgJSAoSCwgUCwgSCwgTzEpKQogICAgcHNiKCclcyBbJXMwNSVzXSAlc0NyYWNrIEZST00gTUVTU0FHRSBMSVNUIElEICcgJSAoSCwgUCwgSCwgSzEpKQogICAgcHNiKCclcyBbJXMwNiVzXSAlc0NyYWNrIEZST00gUE9TVCBSRUFDVFMgJyAlIChILCBQLCBILCBIMSkpCiAgICBwc2IoJyVzIFslczA3JXNdICVzQ3JhY2sgRlJPTSBQT1NUIENPTU1FTlRTICcgJSAoSCwgUCwgSCwgQjEpKQogICAgcHNiKCclcyBbJXMwOCVzXSAlc0NyYWNrIEZST00gR1JPVVAgTUVNQkVSUyAnICUgKEgsIFAsIEgsIE0xKSkKICAgIHBzYignJXMgWyVzMDklc10gJXNDcmFjayBJRCBGUk9NIEVNQUlMJyAlIChILCBQLCBILCBPKSkKICAgIHBzYignJXMgWyVzMTAlc10gJXNDcmFjayBVU0VSTkFNRScgJSAoSCwgUCwgSCwgSykpCiAgICBwc2IoJyVzIFslczExJXNdICVzQ3JhY2sgRlJPTSBIQVNIVEFHJyAlIChILCBQLCBILCBCMSkpCiAgICBwc2IoJyVzIFslczEyJXNdICVzQ3JhY2sgSUQgRlJPTSBIT01FIFBBR0UnICUgKEgsIFAsIEgsIFAxKSkKICAgIHBzYignJXMgWyVzMTMlc10gJXNDcmFjayBJRCBGUk9NIEZSSUVORCBSRVFVRVNUUyAnICUgKEgsIFAsIEgsIEsxKSkKICAgIHBzYignJXMgWyVzMTQlc10gJXNDcmFjayBGUk9NIFNFTlQgUkVRVUVTVFMgJyAlIChILCBQLCBILCBIMSkpCiAgICBwc2IoJyVzIFslczE1JXNdICVzQ3JhY2sgVUlEIEZST00gUFVCTElDIElEJyAlIChILCBQLCBILCBPKSkKICAgIHBzYignJXMgWyVzMTYlc10gJXNDcmFjayBBVVRPIENMT05FIENSQUNLRUQgSURTJyAlIChILCBQLCBILCBLKSkKICAgIHBzYignJXMgWyVzMTclc10gJXNWSUVXIENMT05FIFJFU1VMVFMgJyAlIChILCBQLCBILCBQKSkKICAgIHBzYignJXMgWyVzMTglc10gJXNVU0VSIEFHRU5UIFNFVFRJTkdTICcgJSAoSCwgUCwgSCwgTSkpCiAgICBwc2IoJyVzIFslczE5JXNdICVzIEZJTEUnICUgKEgsIFAsIEgsIEgpKQogICAgcHNiKCclcyBbJXMwMCVzXSAlc0xPR09VVCcgJSAoSCwgTSwgSCwgTSkpCiAgICBwcmludCgnJykKICAgIHBtID0gX2NpY2lfYXppbXZhdV8oJyVzIFslcz5fJXNdICVzQ0hPT1NFIDogJXMnICUgKEgsIFAsIEgsIEssIEgpKQogICAgcHJpbnQoJyVzICcgJSAoTykpCiAgICBpZiBwbSBpbiBbJyddOgogICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKFAsIE0sIFAsIE0pKTttZW51KCkKICAgIGVsaWYgcG0gaW4gWycxJywgJzAxJywgJzAwMScsICdhJ106CiAgICAgICAgcHVibGlrKHRva2VuKQogICAgZWxpZiBwbSBpbiBbJzInLCAnMDInLCAnMDAyJywgJ2InXToKICAgICAgICBwZW5naWt1dCh0b2tlbikKICAgIGVsaWYgcG0gaW4gWyczJywgJzAzJywgJzAwMycsICdjJ106CiAgICAgICAgY2VrX2RldigpO2ZvbGxvd2Vycyhfc2Fsc2FiaWxhXykKICAgIGVsaWYgcG0gaW4gWyc0JywgJzA0JywgJzAwNCcsICdkJ106CiAgICAgICAgY2VrX2RldigpO2R1bXBfbmFtZShfc2Fsc2FiaWxhXykKICAgIGVsaWYgcG0gaW4gWyc1JywgJzA1JywgJzAwNScsICdlJ106CiAgICAgICAgY2VrX2RldigpO2R1bXBfcGVzYW4oX3NhbHNhYmlsYV8sIG4sIGkpCiAgICBlbGlmIHBtIGluIFsnNicsICcwNicsICcwMDYnLCAnZiddOgogICAgICAgIGNla19kZXYoKTttYWluX2xpa2Vycyhfc2Fsc2FiaWxhXykKICAgIGVsaWYgcG0gaW4gWyc3JywgJzA3JywgJzAwNycsICdnJ106CiAgICAgICAgY2VrX2RldigpO21haW5fa29tZW4oX3NhbHNhYmlsYV8pCiAgICBlbGlmIHBtIGluIFsnOCcsICcwOCcsICcwMDgnLCAnaCddOgogICAgICAgIGNla19kZXYoKTtkdW1wX2dydXAoX3NhbHNhYmlsYV8sIF9hemltdmF1XykKICAgIGVsaWYgcG0gaW4gWyc5JywgJzA5JywgJzAwOScsICdpJ106CiAgICAgICAgZHVtcF9lbWFpbCgpCiAgICBlbGlmIHBtIGluIFsnMTAnLCAnMDEwJywgJzAwMTAnLCAnaiddOgogICAgICAgIGR1bXBfdXNlcm5hbWUoKQogICAgZWxpZiBwbSBpbiBbJzExJywgJzAxMScsICcwMDExJywgJ2snXToKICAgICAgICBjZWtfZGV2KCk7aGFzaHRhZyhfc2Fsc2FiaWxhXykKICAgIGVsaWYgcG0gaW4gWycxMicsICcwMTInLCAnMDAxMicsICdsJ106CiAgICAgICAgY2VrX2RldigpO2JlcmFuZGEoX3NhbHNhYmlsYV8pCiAgICBlbGlmIHBtIGluIFsnMTMnLCAnMDEzJywgJzAwMTMnLCAnbSddOgogICAgICAgIGNla19kZXYoKTtwZXJtaW50YWFuX3BlcnRlbWFuYW5fbWFzdWsoX3NhbHNhYmlsYV8pCiAgICBlbGlmIHBtIGluIFsnMTQnLCAnMDE0JywgJzAwMTQnLCAnbiddOgogICAgICAgIGNla19kZXYoKTtwZXJtaW50YWFuX3BlcnRlbWFuYW5fa2VsdWFyKF9zYWxzYWJpbGFfKQogICAgZWxpZiBwbSBpbiBbJzE1JywgJzAxNScsICcwMDE1JywgJ28nXToKICAgICAgICB0ZW1hbl90YXJnZXQoKQogICAgZWxpZiBwbSBpbiBbJzE2JywgJzAxNicsICcwMDE2JywgJ3AnXToKICAgICAgICBjZWtfcmVzdWx0KCkKICAgIGVsaWYgcG0gaW4gWycxNycsICcwMTcnLCAnMDAxNycsICdxJ106CiAgICAgICAgcmVzdWx0KCkKICAgIGVsaWYgcG0gaW4gWycxOCcsICcwMTgnLCAnMDAxOCcsICdyJ106CiAgICAgICAgdWdlbigpCiAgICBlbGlmIHBtIGluIFsnMTknLCAnMDE5JywgJzAwMTknLCAncyddOgogICAgICAgIGZpbGUoKQogICAgZWxpZiBwbSBpbiBbJzAnLCAnMDAnLCAnMDAwJywgJ3onXToKICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc1NFRSBZT1UgJXMlcyVzJyAlIChILCBQLCBILCBLLCBPLCBuLCBQKSk7YmVyc2loKCk7bWVudV9sb2coKQogICAgZWxzZToKICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCgoKZGVmIGRlZmF1bHR1YSgpOgogICAgdWEgPSB1YV94aWFvbWkKICAgIHRyeToKICAgICAgICB1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCAndycpO3VnZW50LndyaXRlKHVhKTt1Z2VudC5jbG9zZSgpCiAgICBleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKICAgICAgICBtZW51X2xvZygpCgoKZGVmIHVnZW4oKToKICAgIHZhcl91Z2VuKCkKICAgIHBtdSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnICUgKEgsIFAsIEgsIEspKQogICAgcHJpbnQoJyVzICcgJSAoTykpCiAgICBpZiBwbXUgaW4gWyIiXToKICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCiAgICBlbGlmIHBtdSBpbiBbJzEnLCAnMDEnLCAnMDAxJywgJ2EnXToKICAgICAgICBvcy5zeXN0ZW0oCiAgICAgICAgICAgICd4ZGctb3BlbiBodHRwczovL3d3dy5nb29nbGUuY29tL3NlYXJjaD9xPU15K1VzZXIrQWdlbnQmb3E9TXkrVXNlcitBZ2VudCZhcXM9Y2hyb21lLi42OWk1N2owbDNqMGkyMmkzMGw2LjQ2NzRqMGoxJnNvdXJjZWlkPWNocm9tZSZpZT1VVEYtOCcpO19jaWNpX2F6aW12YXVfKAogICAgICAgICAgICAnJXMgWyAlc0JBQ0sgJXNdJXMnICUgKE0sIFAsIE0sIEspKTttZW51KCkKICAgIGVsaWYgcG11IGluIFsnMicsICcwMicsICcwMDInLCAnYiddOgogICAgICAgIG9zLnN5c3RlbSgicm0gLXJmIHVnZW50LnR4dCIpOwogICAgICAgIHVhID0gX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIFVTRVIgQUdFTlQgOiBcblxuIiAlIChILCBQLCBILCBLKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsICd3Jyk7dWdlbnQud3JpdGUodWEpO3VnZW50LmNsb3NlKCk7amFsYW4oCiAgICAgICAgICAgICAgICAiXG4lcyBbICVzU1VDQ0VTU0ZVTExZIENIQU5HRUQgVVNFUiBBR0VOVCAlc10iICUgKEgsIFAsIEgpKTtwcmludCgnJXMgJyAlIChPKSk7X2NpY2lfYXppbXZhdV8oCiAgICAgICAgICAgICAgICAnJXMgWyAlc0JBQ0sgJXNdJXMnICUgKEgsIFAsIEgsIEspKTttZW51KCkKICAgICAgICBleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKICAgICAgICAgICAgamFsYW4oIlxuJXMgWyAlc0ZBSUxFRCBUTyBDSEFOR0UgVVNFUiBBR0VOVCAlc10iICUgKFosIE0sIFopKTtwcmludCgnJXMgJyAlIChNKSk7X2NpY2lfYXppbXZhdV8oCiAgICAgICAgICAgICAgICAnJXMgWyAlc0JBQ0sgJXNdJXMnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgIGVsaWYgcG11IGluIFsnMycsICcwMycsICcwMDMnLCAnYyddOgogICAgICAgIHVnZW5faHAoKQogICAgZWxpZiBwbXUgaW4gWyc0JywgJzA0JywgJzAwNCcsICdkJ106CiAgICAgICAgb3Muc3lzdGVtKCJybSAtcmYgdWdlbnQudHh0Iik7amFsYW4oIiVzIFsgJXNVU0VSIEFHRU5UIFNVQ0NFU1NGVUxMWSBERUxFVEVEICVzXSIgJSAoSCwgUCwgSCkpO3ByaW50KAogICAgICAgICAgICAnJXMgJyAlIChPKSk7X2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyAlIChILCBQLCBILCBLKSk7bWVudSgpCiAgICBlbGlmIHBtdSBpbiBbJzUnLCAnMDUnLCAnMDA1JywgJ2UnXToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHVuZ3NlciA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCAncicpLnJlYWQoKQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsIElPRXJyb3IpOgogICAgICAgICAgICB1bmdzZXIgPSAnTk9UIEZPVU5EJwogICAgICAgIHByaW50KCIlcyBbJXPigKIlc10gJXNZT1VSIFVTRVIgQUdFTlQgIDogXG5cbiVzJXMiICUgKEgsIFAsIEgsIFAsIE8sIHVuZ3NlcikpOwogICAgICAgIGphbGFuKCJcbiVzIFsgJXNUSElTIElTIFlPVVIgQ1VSUkVOVCBVU0VSIEFHRU5UICVzXSIgJSAoSCwgSywgSCkpOwogICAgICAgIHByaW50KCclcyAnICUgKE8pKTsKICAgICAgICBfY2ljaV9hemltdmF1XygnJXMgWyAlc0JBQ0sgJXNdJXMnICUgKEgsIFAsIEgsIEspKTsKICAgICAgICBtZW51KCkKICAgIGVsaWYgcG11IGluIFsnMCcsICcwMCcsICcwMDAnLCAnZiddOgogICAgICAgIG1lbnUoKQogICAgZWxzZToKICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSkKCgpkZWYgdWdlbl9ocCgpOgogICAgb3Muc3lzdGVtKCJybSAtcmYgdWdlbnQudHh0IikKICAgIHByaW50KCclcyBbJXMxJXNdICVJTlRFTE1BQycgJSAoSCwgUCwgSCwgSykpCiAgICBwcmludCgnJXMgWyVzMiVzXSAlc05PS0lBJyAlIChILCBQLCBILCBIKSkKICAgIHByaW50KCclcyBbJXMzJXNdICVzQVNVUycgJSAoSCwgUCwgSCwgTSkpCiAgICBwcmludCgnJXMgWyVzNCVzXSAlc0hVQVdFSScgJSAoSCwgUCwgSCwgQikpCiAgICBwcmludCgnJXMgWyVzNSVzXSAlc1ZJVk8nICUgKEgsIFAsIEgsIE8pKQogICAgcHJpbnQoJyVzIFslczYlc10gJXNPUFBPJyAlIChILCBQLCBILCBLKSkKICAgIHByaW50KCclcyBbJXM3JXNdICVzU0FNU1VORycgJSAoSCwgUCwgSCwgQikpCiAgICBwcmludCgnJXMgWyVzOCVzXSAlc1dJTkRPV1MnICUgKEgsIFAsIEgsIE0pKQogICAgcHJpbnQoJyVzIFslczklc10gJXNYSUFPTUknICUgKEgsIFAsIEgsIE0pKQogICAgcHJpbnQoJycpCiAgICBwYyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnICUgKEgsIFAsIEgsIEspKQogICAgcHJpbnQoJyVzICcgJSAoTykpCiAgICBpZiBwYyBpbiBbJyddOgogICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIE0pKTttZW51KCkKICAgIGVsaWYgcGMgaW4gWycxJywgJzAxJ106CiAgICAgICAgdWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3cnKTt1Z2VudC53cml0ZSh1YV94aWFvbWkpO3VnZW50LmNsb3NlKCkKICAgIGVsaWYgcGMgaW4gWycyJywgJzAyJ106CiAgICAgICAgdWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3cnKTt1Z2VudC53cml0ZSh1YV9ub2tpYSk7dWdlbnQuY2xvc2UoKQogICAgZWxpZiBwYyBpbiBbJzMnLCAnMDMnXToKICAgICAgICB1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCAndycpO3VnZW50LndyaXRlKHVhX2FzdXMpO3VnZW50LmNsb3NlKCkKICAgIGVsaWYgcGMgaW4gWyc0JywgJzA0J106CiAgICAgICAgdWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3cnKTt1Z2VudC53cml0ZSh1YV9odWF3ZWkpO3VnZW50LmNsb3NlKCkKICAgIGVsaWYgcGMgaW4gWyc1JywgJzA1J106CiAgICAgICAgdWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3cnKTt1Z2VudC53cml0ZSh1YV92aXZvKTt1Z2VudC5jbG9zZSgpCiAgICBlbGlmIHBjIGluIFsnNicsICcwNiddOgogICAgICAgIHVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsICd3Jyk7dWdlbnQud3JpdGUodWFfb3Bwbyk7dWdlbnQuY2xvc2UoKQogICAgZWxpZiBwYyBpbiBbJzcnLCAnMDcnXToKICAgICAgICB1Z2VudCA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCAndycpO3VnZW50LndyaXRlKHVhX3NhbXN1bmcpO3VnZW50LmNsb3NlKCkKICAgIGVsaWYgcGMgaW4gWyc4JywgJzA4J106CiAgICAgICAgdWdlbnQgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3cnKTt1Z2VudC53cml0ZSh1YV93aW5kb3dzKTt1Z2VudC5jbG9zZSgpCiAgICBlbGlmIHBjIGluIFsnOScsICcwOSddOgogICAgICAgIHVnZW50ID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsICd3Jyk7dWdlbnQud3JpdGUodWFfaW50ZWxtYWMpO3VnZW50LmNsb3NlKCkKICAgIGVsc2U6CiAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgUCkpO21lbnUoKQogICAgamFsYW4oIiVzIFsgJXNTVUNDRVNTRlVMTFkgQ0hBTkdFRCBVU0VSIEFHRU5UICVzXSIgJSAoSCwgUCwgSCkpOwogICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgX2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyAlIChNLCBQLCBNLCBQKSk7CiAgICBtZW51KCkKCgpkZWYgcHVibGlrKHRva2VuKToKICAgIGppZCA9ICc1MDAwJwogICAgdHJ5OgogICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNXUklURSBcJ21lXCcgVE8gUkVUUklFVkUgRlJJRU5EIElEJyAlIChILCBQLCBILCBLKSk7CiAgICAgICAgaXQgPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDogIiAlIChILCBQLCBILCBLKSk7CiAgICAgICAgY2VrX3RhcmdldF9jcmFja18oaXQpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBwYiA9IF9yZXFfZ2V0XygKICAgICAgICAgICAgICAgICJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iICsgaXQgKyAiP2ZpZWxkcz1uYW1lLGlkLGZpcnN0X25hbWUsbWlkZGxlX25hbWUsbGFzdF9uYW1lLG5hbWVfZm9ybWF0LHBpY3R1cmUsc2hvcnRfbmFtZSZhY2Nlc3NfdG9rZW49IiArIHRva2VuKTtvYiA9IF9qc19sb18oCiAgICAgICAgICAgICAgICBwYi50ZXh0KTtwcmludCgnJXMgWyVz4oCiJXNdICVzTkFNRSA6ICVzJyAlIChILCBQLCBILCBLLCBvYlsnbmFtZSddKSkKICAgICAgICBleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpO2phbGFuKCclcyBbJXMhJXNdICVzSUQgTk9UIEZPVU5EJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCiAgICAgICAgciA9IF9yZXFfZ2V0XygKICAgICAgICAgICAgImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL2ZyaWVuZHM/bGltaXQ9JXMmZmllbGRzPW5hbWUsaWQsZmlyc3RfbmFtZSxtaWRkbGVfbmFtZSxsYXN0X25hbWUsbmFtZV9mb3JtYXQscGljdHVyZSxzaG9ydF9uYW1lJmFjY2Vzc190b2tlbj0lcyIgJSAoCiAgICAgICAgICAgIGl0LCBqaWQsIHRva2VuKSk7CiAgICAgICAgaWQgPSBbXTsKICAgICAgICB6ID0gX2pzX2xvXyhyLnRleHQpOwogICAgICAgIHhjID0gKG9iWyJmaXJzdF9uYW1lIl0gKyAiLmpzb24iKS5yZXBsYWNlKCIgIiwgIl8iKTsKICAgICAgICB4YiA9IF9hemltdmF1X2RhcHVudGFfKHhjLCAidyIpCiAgICAgICAgZm9yIGEgaW4gelsiZGF0YSJdOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBpZC5hcHBlbmQoYVsiaWQiXSArICLigKIiICsgYVsibmFtZSJdKTt4Yi53cml0ZShhWyJpZCJdICsgIuKAoiIgKyBhWyJuYW1lIl0gKyAiXG4iKQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgIHhiLmNsb3NlKCk7CiAgICAgICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMnICUgKEgsIFAsIEgsIEssIGxlbihpZCkpKTsKICAgICAgICByZXR1cm4gY3JhY2soeGMpCiAgICBleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKICAgICAgICBfY2ljaV9jaWNpXygnJXMgWyVzISVzXSAlc0lOVkFMSUQgVE9LRU4vQ09PS0lFUyBPUiBJRCBOT1QgRk9VTkQnICUgKE0sIFAsIE0sIFApKQoKCmRlZiBwZW5naWt1dCh0b2tlbik6CiAgICB0cnk6CiAgICAgICAgamlkID0gJzEwMDAwJwogICAgICAgIHggPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tL21lP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pCiAgICAgICAgeSA9IGpzb24ubG9hZHMoeC50ZXh0KQogICAgICAgIG4gPSB5WyduYW1lJ10udXBwZXIoKQogICAgZXhjZXB0IChLZXlFcnJvciwgSU9FcnJvcik6CiAgICAgICAgeG94KCclcyBbJXMhJXNdICVzSU5WQUxJRCBUT0tFTi9DT09LSUVTJyAlIChNLCBQLCBNLCBQKSkKICAgICAgICBvcy5zeXN0ZW0oJ3JtIC1yZiB0b2tlbi50eHQnKQogICAgICAgIG1lbnVfbG9nKCkKICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjoKICAgICAgICB4b3goJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nICUgKE0sIFAsIE0sIFApKQogICAgICAgIGV4aXQoKQogICAgdHJ5OgogICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNXUklURSBcJ21lXCcgRk9SIFRBS0lORyBGUklFTkQgSUQnICUgKEgsIFAsIEgsIEspKQogICAgICAgIGl0ID0gaW5wdXQoIiVzIFslc+KAoiVzXSAlc1RBUkdFVCBJRCA6ICVzIiAlIChILCBQLCBILCBLLCBIKSkKICAgICAgICB0cnk6CiAgICAgICAgICAgIHBiID0gcmVxdWVzdHMuZ2V0KCJodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8iICsgaXQgKyAiP2FjY2Vzc190b2tlbj0iICsgdG9rZW4pCiAgICAgICAgICAgIG9iID0ganNvbi5sb2FkcyhwYi50ZXh0KQogICAgICAgICAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzTkFNRSA6ICVzJXMnICUgKEgsIFAsIEgsIE8sIEgsIG9iWyduYW1lJ10udXBwZXIoKSkpCiAgICAgICAgZXhjZXB0IChLZXlFcnJvciwgSU9FcnJvcik6CiAgICAgICAgICAgIHByaW50CiAgICAgICAgICAgIHhveCgnJXMgWyVzISVzXSAlc0lEIE5PVCBGT1VORCcgJSAoTSwgUCwgTSwgUCkpCiAgICAgICAgICAgIG1lbnUoKQogICAgICAgIHIgPSByZXF1ZXN0cy5nZXQoImh0dHBzOi8vZ3JhcGguZmFjZWJvb2suY29tLyVzL3N1YnNjcmliZXJzP2xpbWl0PSVzJmFjY2Vzc190b2tlbj0lcyIgJSAoaXQsIGppZCwgdG9rZW4pKQogICAgICAgIGlkID0gW10KICAgICAgICB6ID0ganNvbi5sb2FkcyhyLnRleHQpCiAgICAgICAgeGMgPSAob2JbImZpcnN0X25hbWUiXSArICIuanNvbiIpLnJlcGxhY2UoIiAiLCAiXyIpCiAgICAgICAgeGIgPSBvcGVuKHhjLCAidyIpCiAgICAgICAgZm9yIGEgaW4gelsiZGF0YSJdOgogICAgICAgICAgICBpZC5hcHBlbmQoYVsiaWQiXSArICLigKIiICsgYVsibmFtZSJdKQogICAgICAgICAgICB4Yi53cml0ZShhWyJpZCJdICsgIuKAoiIgKyBhWyJuYW1lIl0gKyAiXG4iKQogICAgICAgIHhiLmNsb3NlKCkKICAgICAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzQUxMIElEIDogJXMlcycgJSAoSCwgUCwgSCwgTywgSCwgbGVuKGlkKSkpCiAgICAgICAgcmV0dXJuIGNyYWNrKHhjKQogICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgIGV4aXQoJyVzIFslcyElc10gJXNFUlJPUiA6ICVzJyAlIChNLCBQLCBNLCBQLCBlKSkKCgpkZWYgZm9sbG93ZXJzKGNvb2tpZXMpOgogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBUQVJHRVQgSUQgOiAnICUgKEgsIFAsIEgsIEspKTsKICAgIHByaW50KCIlcyBbJXPigKIlc10gJXNQUkVTUyBDVFJMK0MgVE8gU1RPUCBEVU1QIiAlIChILCBQLCBILCBLKSk7CiAgICBfZmlsZV8gPSBfcXVlcnlfICsgJy5qc29uJzsKICAgIF91cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc3Vic2NyaWJlL2xpc3RzLz9pZD0nICsgX3F1ZXJ5XzsKICAgIF9maWxlXyA9IChfcXVlcnlfICsgJy5qc29uJykucmVwbGFjZSgnICcsICdfJykKICAgIHRyeToKICAgICAgICBvcy5yZW1vdmUoX2ZpbGVfKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIGV4ZWNfZm9sbG93ZXJzKF91cmxfZGV2XywgY29va2llcywgX2ZpbGVfKTsKICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTsKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGV4ZWNfZm9sbG93ZXJzKHVybCwgY29va2llcywgX2ZpbGVfKToKICAgIG9wZW4oX2ZpbGVfLCAnYScpOwogICAgX3JlcV9zZXNfID0gcmVxdWVzdHMuU2Vzc2lvbigpOwogICAgX3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsIGNvb2tpZXM9Y29va2llcyk7CiAgICBfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsICdodG1sLnBhcnNlcicpOwogICAgX2J1a2FfZmlsZV8gPSBvcGVuKF9maWxlXykucmVhZCgpOwogICAgcHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiICUgKEgsIFAsIEgsIEssIEgsIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwKICAgICAgICAgIGVuZD0nICcpOwogICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICB0cnk6CiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLCBocmVmPVRydWUpOgogICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9jaWNpXy5nZXQoJ2hyZWYnKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBfbmFtZV9kZXZfID0gX2NpY2lfLnRleHQ7CiAgICAgICAgICAgICAgICAgICAgX2lkX2Rldl8gPSAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCJwcm9maWxlXC5waHBcP2lkPSguKj8pJiIsIF9jaWNpXy5nZXQoImhyZWYiKSkpCiAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgb3BlbihfZmlsZV8sICdhKycpLndyaXRlKCclc+KAoiVzXG4nICUgKF9pZF9kZXZfLCBfbmFtZV9kZXZfKSkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLCBocmVmPVRydWUpOgogICAgICAgICAgICBpZiAnU2VlIG1vcmUnIGluIF9jaWNpXy50ZXh0OiB1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2NpY2lfLmdldCgnaHJlZicpO2V4ZWNfZm9sbG93ZXJzKAogICAgICAgICAgICAgICAgdXJsX2RldiwgY29va2llcywgX2ZpbGVfKQogICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoCiAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQoKCmRlZiBtYWluX2xpa2VycyhfYXppbXZhdV8pOgogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBQT1NUIElEIDogJyAlIChILCBQLCBILCBLKSk7CiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIgJSAoSCwgUCwgSCwgSykpOwogICAgX2ZpbGVfID0gX3F1ZXJ5XyArICcuanNvbicKICAgIHRyeToKICAgICAgICBvcy5yZW1vdmUoX3F1ZXJ5XyArICcuanNvbicpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwogICAgX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCAndycpOwogICAgX3VybF8gPSAoJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS91ZmkvcmVhY3Rpb24vcHJvZmlsZS9icm93c2VyLz9mdF9lbnRfaWRlbnRpZmllcj0nICsgX3F1ZXJ5Xyk7CiAgICBzY3JhcGVfbGlrZXJzKF9hemltdmF1XywgX3VybF8sIF9maWxlXykKICAgIGlmIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpID09IDA6IHByaW50KAogICAgICAgICdcbiVzIFslcyElc10gJXNQT1NUIE5PVCBGT1VORCcgJSAoTSwgUCwgTSwgUCkpO19jaWNpX2NpY2lfKCkKICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTsKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIHNjcmFwZV9saWtlcnMoX2F6aW12YXVfLCBfdXJsXywgX2ZpbGVfKToKICAgIF9zZXNfID0gX3JlcV9zZXNfOwogICAgX3VybF9sb2FkXyA9IF9zZXNfLmdldChfdXJsXywgY29va2llcz1fYXppbXZhdV8sIGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQuZW5jb2RlKCJ1dGYtOCIpOwogICAgX3Nlc19wYXJfID0gcGFyKF91cmxfbG9hZF8sICdodG1sLnBhcnNlcicpOwogICAgcHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiICUgKEgsIFAsIEgsIEssIEgsIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwKICAgICAgICAgIGVuZD0nICcpOwogICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICB0cnk6CiAgICAgICAgZm9yIF9pc2lfIGluIF9zZXNfcGFyXy5maW5kX2FsbCgnaDMnKToKICAgICAgICAgICAgZm9yIF9pZF8gaW4gX2lzaV8uZmluZF9hbGwoJ2EnLCBocmVmPVRydWUpOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2lkXy5nZXQoImhyZWYiKToKICAgICAgICAgICAgICAgICAgICAgICAgX2FfID0gX2lkXy5nZXQoImhyZWYiKS5zcGxpdCgnPScpWzFdO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sICdhKycpLndyaXRlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2FfICsgJ+KAoicgKyBfX2lkX18gKyAnXG4nKQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIF9hXyA9IF9pZF8uZ2V0KCJocmVmIikuc3BsaXQoJy8nKVsxXTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCAnYSsnKS53cml0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hXyArICfigKInICsgX19pZF9fICsgJ1xuJykKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZvciBfbGFuanV0XyBpbiBfc2VzX3Bhcl8uZmluZF9hbGwoImEiLCBocmVmPVRydWUpOgogICAgICAgICAgICBpZiAiU2VlIG1vcmUiIGluIF9sYW5qdXRfLnRleHQ6CiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2NyYXBlX2xpa2VycyhfYXppbXZhdV8sICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIiArIF9sYW5qdXRfLmdldCgiaHJlZiIpLCBfZmlsZV8pO2JyZWFrCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnJXMlcycgJSAoTSwgZSkpCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiAlICgKICAgICAgICBILCBQLCBILCBLLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIG1haW5fa29tZW4oX2F6aW12YXVfKToKICAgIF9xdWVyeV8gPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgUE9TVCBJRCA6ICcgJSAoSCwgUCwgSCwgSykpOwogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiICUgKEgsIFAsIEgsIEspKTsKICAgIF9maWxlXyA9IF9xdWVyeV8gKyAnLmpzb24nCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKF9xdWVyeV8gKyAnLmpzb24nKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIF9hemltdmF1X2RhcHVudGFfKF9maWxlXywgJ3cnKTsKICAgIF91cmxfID0gKCdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vJyArIF9xdWVyeV8pOwogICAgc2NyYXBlX2tvbWVuKF9hemltdmF1XywgX3VybF8sIF9maWxlXykKICAgIGlmIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpID09IDA6IHByaW50KAogICAgICAgICdcbiVzIFslcyElc10gJXNQT1NUIE5PVCBGT1VORCcgJSAoTSwgUCwgTSwgUCkpO19jaWNpX2NpY2lfKCkKICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTsKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIHNjcmFwZV9rb21lbihfYXppbXZhdV8sIF91cmxfLCBfZmlsZV8pOgogICAgX3Nlc18gPSBfcmVxX3Nlc187CiAgICBfdXJsX2xvYWRfID0gX3Nlc18uZ2V0KF91cmxfLCBjb29raWVzPV9hemltdmF1XywgaGVhZGVycz1oZWFkZXJfZ3J1cCkudGV4dC5lbmNvZGUoInV0Zi04Iik7CiAgICBfc2VzX3Bhcl8gPSBwYXIoX3VybF9sb2FkXywgJ2h0bWwucGFyc2VyJyk7CiAgICBwcmludCgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIgJSAoSCwgUCwgSCwgSywgSCwgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpLAogICAgICAgICAgZW5kPScgJyk7CiAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgIHRyeToKICAgICAgICBmb3IgX2lzaV8gaW4gX3Nlc19wYXJfLmZpbmRfYWxsKCdoMycpOgogICAgICAgICAgICBmb3IgX2lkXyBpbiBfaXNpXy5maW5kX2FsbCgnYScsIGhyZWY9VHJ1ZSk6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgaWYgInByb2ZpbGUucGhwIiBpbiBfaWRfLmdldCgiaHJlZiIpOgogICAgICAgICAgICAgICAgICAgICAgICBfYV8gPSAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCJwcm9maWxlXC5waHBcP2lkPSguKj8pJiIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkXy5nZXQoImhyZWYiKSkpO19faWRfXyA9IF9pZF8udGV4dDtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYSsnKS53cml0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cihfYV8pLnNwbGl0KCcmJylbMF0gKyAn4oCiJyArIF9faWRfXyArICdcbicpCiAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgX2FfID0gIiIuam9pbigKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGJzNC5yZS5maW5kYWxsKCIvKC4qPylcPyIsIF9pZF8uZ2V0KCJocmVmIikpKTtfX2lkX18gPSBfaWRfLnRleHQ7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYSsnKS53cml0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cihfYV8pLnNwbGl0KCc/JylbMF0gKyAn4oCiJyArIF9faWRfXyArICdcbicpCiAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICBmb3IgX2xhbmp1dF8gaW4gX3Nlc19wYXJfLmZpbmRfYWxsKCJhIiwgaHJlZj1UcnVlKToKICAgICAgICAgICAgaWYgIlZpZXcgbW9yZSBjb21tZW50c+KApiIgaW4gX2xhbmp1dF8udGV4dDoKICAgICAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBzY3JhcGVfa29tZW4oX2F6aW12YXVfLCAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIgKyBfbGFuanV0Xy5nZXQoImhyZWYiKSwgX2ZpbGVfKTticmVhawogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJyVzJXMnICUgKE0sIGUpKQogICAgICAgICAgICBlbGlmICJWaWV3IHByZXZpb3VzIGNvbW1lbnRz4oCmIiBpbiBfbGFuanV0Xy50ZXh0OgogICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNjcmFwZV9saWtlcnMoX2F6aW12YXVfLCAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIgKyBfbGFuanV0Xy5nZXQoImhyZWYiKSwgX2ZpbGVfKTticmVhawogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJyVzJXMnICUgKE0sIGUpKQogICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoCiAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soX2ZpbGVfKQoKCmNsYXNzIGR1bXBfZ3J1cDoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBfYXppbXZhdV8sIF9jaWNpXyk6CiAgICAgICAgc2VsZi5nbGlzdCA9IFtdOwogICAgICAgIHNlbGYuX2dydXBfID0gW107CiAgICAgICAgc2VsZi5pZCA9ICdfX2F6aW12YXVfXy5qc29uJzsKICAgICAgICBzZWxmLnRva2VuID0gX2NpY2lfOwogICAgICAgIHNlbGYuY29va2llcyA9IF9hemltdmF1XzsKICAgICAgICBzZWxmLmhlYWRlciA9IHsKICAgICAgICAgICAgInVzZXItYWdlbnQiOiAiTW96aWxsYS81LjAgKExpbnV4OyBBbmRyb2lkIDEwOyBNaSA5VCBQcm8gQnVpbGQvUUtRMS4xOTA4MjUuMDAyOyB3dikgQXBwbGVXZWJLaXQvNTM3LjM2IChLSFRNTCwgbGlrZSBHZWNrbykgVmVyc2lvbi80LjAgQ2hyb21lLzg4LjAuNDMyNC4xODEgTW9iaWxlIFNhZmFyaS81MzcuMzYgW0ZCQU4vRU1BO0ZCTEMvZW5fVVM7RkJBVi8xNzMuMC4wLjEwLjExODtdIn07CiAgICAgICAgc2VsZi5tYWluX2dyb3VwKCJodHRwczovL20uZmFjZWJvb2suY29tL2dyb3Vwcy8/c2VlbW9yZSIpCgogICAgZGVmIG1haW5fZ3JvdXAoc2VsZiwgdXJsX2Rldik6CiAgICAgICAgYnMgPSBiczQuQmVhdXRpZnVsU291cChfcmVxX2dldF8odXJsX2RldiwgY29va2llcz1zZWxmLmNvb2tpZXMsIGhlYWRlcnM9c2VsZi5oZWFkZXIpLnRleHQsICJodG1sLnBhcnNlciIpCiAgICAgICAgZm9yIF9jaWNpXyBpbiBicy5maW5kX2FsbCgiYSIsIGhyZWY9VHJ1ZSk6CiAgICAgICAgICAgIGlmICIvZ3JvdXBzLyIgaW4gX2NpY2lfLmdldCgiaHJlZiIpOgogICAgICAgICAgICAgICAgaWYgImNhdGVnb3J5IiBpbiBfY2ljaV8uZ2V0KCJocmVmIikgb3IgImNyZWF0ZSIgaW4gX2NpY2lfLmdldCgiaHJlZiIpOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHNlbGYuZ2xpc3QuYXBwZW5kKAogICAgICAgICAgICAgICAgICAgICAgICB7ImlkIjogIiIuam9pbihiczQucmUuZmluZGFsbCgiL2dyb3Vwcy8oLio/KVw/IiwgX2NpY2lfLmdldCgiaHJlZiIpKSksICJuYW1lIjogX2NpY2lfLnRleHR9KQogICAgICAgIGlmIGxlbihzZWxmLmdsaXN0KSAhPSAwOgogICAgICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzWU9VIEpPSU4gJXMlcyVzIEdST1VQIiAlIChILCBQLCBILCBLLCBPLCBsZW4oc2VsZi5nbGlzdCksIFApKTsKICAgICAgICAgICAgcHJpbnQoJyVzIFslczElc10gJXNTRUFSQ0ggQUxMIEdST1VQUyBKT0lOJyAlIChILCBQLCBILCBLKSk7CiAgICAgICAgICAgIHByaW50KCclcyBbJXMyJXNdICVzU0VBUkNIIEdST1VQUyBCWSBOQU1FJyAlIChILCBQLCBILCBLKSk7CiAgICAgICAgICAgIHByaW50KCclcyBbJXMzJXNdICVzU0VBUkNIIEdST1VQUyBCWSBJRCcgJSAoSCwgUCwgSCwgSykpCiAgICAgICAgICAgIHdoaWxlIFRydWU6CiAgICAgICAgICAgICAgICBjID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICcgJSAoSCwgUCwgSCwgSykpOwogICAgICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpCiAgICAgICAgICAgICAgICBpZiBjID09ICIiOgogICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBlbGlmIGMgPT0gIjEiOgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2F5YSgpCiAgICAgICAgICAgICAgICBlbGlmIGMgPT0gIjIiOgogICAgICAgICAgICAgICAgICAgIHNlbGYuc2VhcmNoKCkKICAgICAgICAgICAgICAgIGVsaWYgYyA9PSAiMyI6CiAgICAgICAgICAgICAgICAgICAgc2VsZi5tYW51YWwoKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1lPVSBET04nVCBKT0lOIEFOWSBHUk9VUCIgJSAoSCwgUCwgSCwgSykpO3NlbGYubWFudWFsKCkKCiAgICBkZWYgc2F5YShzZWxmKToKICAgICAgICBzZWxmLmZsID0gKHNlbGYuaWQpCiAgICAgICAgdHJ5OgogICAgICAgICAgICBvcy5yZW1vdmUoc2VsZi5mbCkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIgJSAoSCwgUCwgSCwgSykpCiAgICAgICAgdHJ5OgogICAgICAgICAgICB1cmwgPSAiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vbWUvZ3JvdXBzP2FjY2Vzc190b2tlbj17fSIuZm9ybWF0KHNlbGYudG9rZW4pCiAgICAgICAgICAgIHdpdGggX3JlcV9zZXNfIGFzIHNlc186CiAgICAgICAgICAgICAgICBkYXRhID0gc2VzXy5nZXQodXJsKS5qc29uKCkKICAgICAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gZGF0YVsiZGF0YSJdOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5fZ3J1cF8uYXBwZW5kKF9hemltdmF1X1siaWQiXSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZm9yIF9jaWNpXyBpbiBzZWxmLl9ncnVwXzoKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBzZWxmLnVybF9ncnVwID0gKCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vYnJvd3NlL2dyb3VwL21lbWJlcnMvP2lkPSVzIiAlICgKICAgICAgICAgICAgICAgICAgICAgICAgX2NpY2lfKSk7c2VsZi5leGVjX2dydXBfc2F5YSgpO3ByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiAlICgKICAgICAgICAgICAgICAgICAgICBILCBQLCBILCBQLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICAgICAgICAgICAgICBwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRlJPTSBNWSBHUk9VUCIgJSAoCiAgICAgICAgICAgICAgICAgICAgSCwgUCwgSCwgUCwgbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoJ1xuJXMgWyVzISVzXSAlc0VSUk9SIElOIFNFQ1RJT04gOiAlcycgJSAoTSwgUCwgTSwgUCwgX2Vycm9yXykpO19jaWNpX2NpY2lfKCkKICAgICAgICBleGNlcHQgKEtleUVycm9yLCBJT0Vycm9yKToKICAgICAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNDT09LSUUgSU5WQUxJRCcgJSAoTSwgUCwgTSwgUCkpO21lbnUoKQogICAgICAgIGV4Y2VwdCByZXF1ZXN0cy5leGNlcHRpb25zLkNvbm5lY3Rpb25FcnJvcjoKICAgICAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNDT05ORUNUSU9OIFBST0JMRU0nICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NIE1ZIEdST1VQIiAlICgKICAgICAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOgogICAgICAgICAgICBwcmludCgnXG4lcyBbJXMhJXNdICVzRXJyb3IgRGkgQmFnaWFuIDogJXMnICUgKE0sIFAsIE0sIFAsIF9lcnJvcl8pKTtfY2ljaV9jaWNpXygpCgogICAgZGVmIGV4ZWNfZ3J1cF9zYXlhKHNlbGYpOgogICAgICAgIGdsb2JhbCBjb3VudAogICAgICAgIHdpdGggX3JlcV9zZXNfIGFzIHNlc186CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGRhdGEgPSBzZXNfLmdldChzZWxmLnVybF9ncnVwLCBjb29raWVzPXNlbGYuY29va2llcywgaGVhZGVycz1zZWxmLmhlYWRlcikuY29udGVudDsKICAgICAgICAgICAgICAgIHNvcF9kZXYgPSBwYXIoZGF0YSwgImh0bWwucGFyc2VyIik7CiAgICAgICAgICAgICAgICBtZW1iZXJzID0gc29wX2Rldi5maW5kKCJkaXYiLCBpZD0ib2JqZWN0c19jb250YWluZXIiKQogICAgICAgICAgICAgICAgZm9yIGRldiBpbiBtZW1iZXJzLmZpbmRfYWxsKCJ0YWJsZSIpOgogICAgICAgICAgICAgICAgICAgIHVzZXJfID0gZGV2WyJpZCJdLnJlcGxhY2UoIm1lbWJlcl8iLCAiIik7CiAgICAgICAgICAgICAgICAgICAgbmFtYV8gPSByZS5maW5kYWxsKCc8aW1nIGFsdD0iKC4qKSwgcHJvZmlsZSBwaWN0dXJlIicsIHN0cihkZXYpKVswXQogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCwgJ2ErJykud3JpdGUoc3RyKHVzZXJfKSArICLigKIiICsgc3RyKG5hbWFfKSArICJcbiIpLmNsb3NlKCkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIHByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiAlICgKICAgICAgICAgICAgICAgIEgsIFAsIEgsIEssIEgsIGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksIGVuZD0nICcpOwogICAgICAgICAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgICAgICAgICBpZiAiU2VlIG1vcmUiIGluIHN0cihzb3BfZGV2KTogdXJsID0gc29wX2Rldi5maW5kKCJhIiwgc3RyaW5nPSJTZWUgbW9yZSIpWwogICAgICAgICAgICAgICAgICAgICJocmVmIl07dXJsX2dydXAgPSAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tIiArIHVybDtzZWxmLmV4ZWNfZ3J1cF9zYXlhKCkKICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICAgICAgcHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIERhcmkgR3J1cCBTYXlhIiAlICgKICAgICAgICAgICAgICAgIEgsIFAsIEgsIEssIGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQogICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86CiAgICAgICAgICAgICAgICBwcmludCgnXG4lcyBbJXMhJXNdICVzRXJyb3IgRGkgQmFnaWFuIDogJXMnICUgKE0sIFAsIE0sIFAsIF9lcnJvcl8pKTtfY2ljaV9jaWNpXygpCgogICAgZGVmIG1hbnVhbChzZWxmKToKICAgICAgICBpZCA9IF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBHUk9VUCBJRCA6ICIgJSAoSCwgUCwgSCwgSykpCiAgICAgICAgaWYgaWQgPT0gIiI6CiAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICByID0gYnM0LkJlYXV0aWZ1bFNvdXAoCiAgICAgICAgICAgICAgICBfcmVxX2dldF8oImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIgKyBpZCwgaGVhZGVycz1oZWFkZXJfZ3J1cCwgY29va2llcz1zZWxmLmNvb2tpZXMpLnRleHQsCiAgICAgICAgICAgICAgICAiaHRtbC5wYXJzZXIiKQogICAgICAgICAgICBpZiAibm8gY29udGVudCIgaW4gci5maW5kKCJ0aXRsZSIpLnRleHQubG93ZXIoKToKICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzUFJJVkFURSBHUk9VUCAvIFdST05HIElEJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBzZWxmLmxpc3RlZCA9IHsiaWQiOiBpZCwgIm5hbWUiOiByLmZpbmQoInRpdGxlIikudGV4dH07CiAgICAgICAgICAgICAgICBzZWxmLmYoaWQpOwogICAgICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgICAgICAgICAgICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc05BTUUgOiAlcyIgJSAoSCwgUCwgSCwgSywgc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTsKICAgICAgICAgICAgICAgIHhkID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0R1bXAgSUQvVXNlcm5hbWU/IFtpL3VdIDogJyAlIChILCBQLCBILCBLKSk7CiAgICAgICAgICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIgJSAoSCwgUCwgSCwgSykpCiAgICAgICAgICAgICAgICBpZiB4ZCBpbiBbJyddOgogICAgICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgICAgICAgICAgICAgIGVsaWYgeGQgaW4gWydpJywgJ0knLCAnMSddOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kdW1wX2lkKCJodHRwczovL20uZmFjZWJvb2suY29tL2dyb3Vwcy8iICsgaWQpO3ByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAgICAgIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIERhcmkgJXMiICUgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkKICAgICAgICAgICAgICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiAlICgKICAgICAgICAgICAgICAgICAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJ1xuJXMgWyVzISVzXSAlc0Vycm9yIERpIEJhZ2lhbiA6ICVzJyAlIChNLCBQLCBNLCBQLCBfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQogICAgICAgICAgICAgICAgZWxpZiB4ZCBpbiBbJ3UnLCAnVScsICcyJ106CiAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIgKyBpZCk7cHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRGFyaSAlcyIgJSAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBILCBQLCBILCBLLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIEZST00gJXMiICUgKAogICAgICAgICAgICAgICAgICAgICAgICBILCBQLCBILCBLLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksCiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGVkLmdldCgibmFtZSIpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyAlIChNLCBQLCBNLCBNLCBfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBNKSk7bWVudSgpCgogICAgZGVmIHNlYXJjaChzZWxmKToKICAgICAgICB3aGl0ZWxpc3QgPSBbXTsKICAgICAgICBxID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc05BTUUgOiAnICUgKEgsIFAsIEgsIEspKS5sb3dlcigpCiAgICAgICAgaWYgcSA9PSAnJzoKICAgICAgICAgICAgc2VsZi5zZWFyY2goKQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGZvciBlLCBpIGluIGVudW1lcmF0ZShzZWxmLmdsaXN0KToKICAgICAgICAgICAgICAgIGlmIHEgaW4gaS5nZXQoIm5hbWUiKS5sb3dlcigpOiB3aGl0ZWxpc3QuYXBwZW5kKGkpO3ByaW50KAogICAgICAgICAgICAgICAgICAgICclcyBbJXMlcyVzXSAlcyVzJyAlIChPLCBQLCBsZW4od2hpdGVsaXN0KSwgTywgUCwgaS5nZXQoIm5hbWUiKS5yZXBsYWNlKHEsICIlcyIgJSAocSkpKSkKICAgICAgICAgICAgaWYgbGVuKHdoaXRlbGlzdCkgPT0gMDoKICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzUFJJVkFURSBHUk9VUCBPUiBXUk9ORyBJRCcgJSAoTSwgUCwgTSwgUCkpO21lbnUoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgc2VsZi5jaG9pY2Uod2hpdGVsaXN0LCBxKQoKICAgIGRlZiBjaG9pY2Uoc2VsZiwgd2hpdGVsaXN0LCBxKToKICAgICAgICB0cnk6CiAgICAgICAgICAgIHNlbGYubGlzdGVkID0gd2hpdGVsaXN0W2ludChfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJyAlIChILCBQLCBILCBLKSkpIC0gaW50KDEpXTsKICAgICAgICAgICAgc2VsZi5mKHEpOwogICAgICAgICAgICBwcmludCgnJXMgJyAlIChPKSk7CiAgICAgICAgICAgIHByaW50KCIlcyBbJXPigKIlc10gJXNOQU1FIDogJXMiICUgKEgsIFAsIEgsIEssIHNlbGYubGlzdGVkLmdldCgibmFtZSIpKSk7CiAgICAgICAgICAgIHhkID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0RVTVAvVVNFUk5BTUU/ICVzWyVzaSVzLyVzdSVzXSA6ICcgJSAoSCwgUCwgSCwgSywgWiwgTSwgWiwgSCwgWikpOwogICAgICAgICAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIgJSAoSCwgUCwgSCwgSykpCiAgICAgICAgICAgIGlmIHhkIGluIFsnJ106CiAgICAgICAgICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCiAgICAgICAgICAgIGVsaWYgeGQgaW4gWydpJywgJ0knLCAnMSddOgogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIHNlbGYuZHVtcF9pZCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9ncm91cHMvIiArIHNlbGYubGlzdGVkLmdldCgiaWQiKSk7cHJpbnQoCiAgICAgICAgICAgICAgICAgICAgICAgICJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBEYXJpICVzIiAlICgKICAgICAgICAgICAgICAgICAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLAogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjayhzZWxmLmZsKQogICAgICAgICAgICAgICAgZXhjZXB0IEtleWJvYXJkSW50ZXJydXB0OgogICAgICAgICAgICAgICAgICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NICVzIiAlICgKICAgICAgICAgICAgICAgICAgICBILCBQLCBILCBLLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSksCiAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgX2Vycm9yXzoKICAgICAgICAgICAgICAgICAgICBwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyAlIChNLCBQLCBNLCBQLCBfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQogICAgICAgICAgICBlbGlmIHhkIGluIFsndScsICdVJywgJzInXToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBzZWxmLmR1bXBfdXNlcm5hbWUoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vZ3JvdXBzLyIgKyBzZWxmLmxpc3RlZC5nZXQoImlkIikpO3ByaW50KAogICAgICAgICAgICAgICAgICAgICAgICAiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRGFyaSAlcyIgJSAoCiAgICAgICAgICAgICAgICAgICAgICAgIEgsIFAsIEgsIEssIGxlbihfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCkuc3BsaXRsaW5lcygpKSwKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5saXN0ZWQuZ2V0KCJuYW1lIikpKTtyZXR1cm4gY3JhY2soc2VsZi5mbCkKICAgICAgICAgICAgICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICAgICAgICAgICAgICBwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQgRGFyaSAlcyIgJSAoCiAgICAgICAgICAgICAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLAogICAgICAgICAgICAgICAgICAgIHNlbGYubGlzdGVkLmdldCgibmFtZSIpKSk7cmV0dXJuIGNyYWNrKHNlbGYuZmwpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIF9lcnJvcl86CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoJ1xuJXMgWyVzISVzXSAlc0VSUk9SIElOIFNFQ1RJT04gOiAlcycgJSAoTSwgUCwgTSwgUCwgX2Vycm9yXykpO19jaWNpX2NpY2lfKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgICAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCBGUk9NICVzIiAlICgKICAgICAgICAgICAgSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKS5zcGxpdGxpbmVzKCkpLCBzZWxmLmxpc3RlZC5nZXQoIm5hbWUiKSkpO3JldHVybiBjcmFjaygKICAgICAgICAgICAgICAgIHNlbGYuZmwpCiAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBfZXJyb3JfOgogICAgICAgICAgICBwcmludCgnXG4lcyBbJXMhJXNdICVzRVJST1IgSU4gU0VDVElPTiA6ICVzJyAlIChNLCBQLCBNLCBQLCBfZXJyb3JfKSk7X2NpY2lfY2ljaV8oKQoKICAgIGRlZiBmKHNlbGYsIGlkKToKICAgICAgICBzZWxmLmZsID0gKGlkLnJlcGxhY2UoJyAnLCAnXycpICsgJy5qc29uJykKICAgICAgICBpZiBzZWxmLmZsID09ICcnOiBzZWxmLmYoKQogICAgICAgIHRyeToKICAgICAgICAgICAgb3MucmVtb3ZlKHNlbGYuZmwpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCwgInciKS5jbG9zZSgpCgogICAgZGVmIGR1bXBfdXNlcm5hbWUoc2VsZiwgdXJsKToKICAgICAgICByID0gYnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybCwgY29va2llcz1zZWxmLmNvb2tpZXMsIGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQsICJodG1sLnBhcnNlciIpOwogICAgICAgIHByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiAlIChILCBQLCBILCBLLCBILCBsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpLAogICAgICAgICAgICAgIGVuZD0nICcpOwogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgIGZvciBpIGluIHIuZmluZF9hbGwoImgzIik6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGxlbihiczQucmUuZmluZGFsbCgiXC8iLCBpLmZpbmQoImEiLCBocmVmPVRydWUpLmdldCgiaHJlZiIpKSkgPT0gMToKICAgICAgICAgICAgICAgICAgICBvZ2VoID0gaS5maW5kKCJhIiwgaHJlZj1UcnVlKQogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gb2dlaC5nZXQoImhyZWYiKToKICAgICAgICAgICAgICAgICAgICAgICAgYSA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIiwgb2dlaC5nZXQoImhyZWYiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKSA9PSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCAiYSsiKS53cml0ZSgiJXPigKIlc1xuIiAlIChhLCBvZ2VoLnRleHQpKTtjb250aW51ZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCIvKC4qPylcPyIsIG9nZWguZ2V0KCJocmVmIikpKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBsZW4oYSkgPT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgYSBpbiBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCwgImErIikud3JpdGUoIiVz4oCiJXNcbiIgJSAoYSwgb2dlaC50ZXh0KSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICBmb3IgaSBpbiByLmZpbmRfYWxsKCJhIiwgaHJlZj1UcnVlKToKICAgICAgICAgICAgaWYgIlNlZSBNb3JlIFBvc3RzIiBpbiBpLnRleHQ6CiAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5kdW1wX3VzZXJuYW1lKCJodHRwczovL20uZmFjZWJvb2suY29tLyIgKyBpLmdldCgiaHJlZiIpKTticmVhawogICAgICAgICAgICAgICAgICAgIGV4Y2VwdCBFeGNlcHRpb24gYXMgZToKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoJ1xyJXMgWyVzISVzXSAlc1JFUEVBVCcgJSAoTSwgUCwgTSwgTSkpO2NvbnRpbnVlCgogICAgZGVmIGR1bXBfaWQoc2VsZiwgdXJsKToKICAgICAgICByID0gYnM0LkJlYXV0aWZ1bFNvdXAoX3JlcV9nZXRfKHVybCwgY29va2llcz1zZWxmLmNvb2tpZXMsIGhlYWRlcnM9aGVhZGVyX2dydXApLnRleHQsICJodG1sLnBhcnNlciIpOwogICAgICAgIHByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiAlIChILCBQLCBILCBLLCBILCBsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCkucmVhZCgpLnNwbGl0bGluZXMoKSkpLAogICAgICAgICAgICAgIGVuZD0nICcpOwogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgIGZvciBpIGluIHIuZmluZF9hbGwoImgzIik6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmIGxlbihiczQucmUuZmluZGFsbCgiXC8iLCBpLmZpbmQoImEiLCBocmVmPVRydWUpLmdldCgiaHJlZiIpKSkgPT0gMToKICAgICAgICAgICAgICAgICAgICBvZ2VoID0gaS5maW5kKCJhIiwgaHJlZj1UcnVlKQogICAgICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gb2dlaC5nZXQoImhyZWYiKToKICAgICAgICAgICAgICAgICAgICAgICAgYSA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIiwgb2dlaC5nZXQoImhyZWYiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIGxlbihhKSA9PSAwOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiBhIGluIF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmwpLnJlYWQoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsLCAiYSsiKS53cml0ZSgiJXPigKIlc1xuIiAlIChhLCBvZ2VoLnRleHQpKTtjb250aW51ZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGEgPSAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCIvKC4qPylcPyIsIG9nZWguZ2V0KCJocmVmIikpKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBsZW4oYSkgPT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgYSBpbiBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZsKS5yZWFkKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oc2VsZi5mbCwgImErIikud3JpdGUoIiVz4oCiJXNcbiIgJSAoX2dldF9pZF8oYSksIG9nZWgudGV4dCkpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZm9yIGkgaW4gci5maW5kX2FsbCgiYSIsIGhyZWY9VHJ1ZSk6CiAgICAgICAgICAgIGlmICJTZWUgTW9yZSBQb3N0cyIgaW4gaS50ZXh0OgogICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZHVtcF9pZCgiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS8iICsgaS5nZXQoImhyZWYiKSk7YnJlYWsKICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgIHByaW50KCdcciVzIFslcyElc10gJXNNZW5ndWxhbmdpJyAlIChNLCBQLCBNLCBQKSk7Y29udGludWUKCgpkZWYgX2dldF9pZF8odXNlcm5hbWUpOgogICAgdXJsID0gImh0dHBzOi8vbG9va3VwLWlkLmNvbS8jIgogICAgd2l0aCBfcmVxX3Nlc18gYXMgZGV2OgogICAgICAgIHBheWxvYWQgPSB7ImZidXJsIjogImh0dHBzOi8vbS5mYWNlYm9vay5jb20ve30iLmZvcm1hdCh1c2VybmFtZSksICJjaGVjayI6ICJMb29rdXAifQogICAgICAgIGlmICJmYWNlYm9vayIgaW4gdXNlcm5hbWU6IHBheWxvYWQgPSB7ImZidXJsIjogdXNlcm5hbWUsICJjaGVjayI6ICJMb29rdXAifQogICAgICAgIGRhdGFfZGV2ID0gZGV2LnBvc3QodXJsLCBkYXRhPXBheWxvYWQpLmNvbnRlbnQ7CiAgICAgICAgc29wXyA9IHBhcihkYXRhX2RldiwgImh0bWwucGFyc2VyIik7CiAgICAgICAgaWRfID0gc29wXy5maW5kKCJzcGFuIiwgaWQ9ImNvZGUiKTsKICAgICAgICB1c2VyX2dldF9pZCA9IGlkXy50ZXh0CiAgICAgICAgcmV0dXJuIHVzZXJfZ2V0X2lkCgoKZGVmIGR1bXBfbmFtZShfYXppbXZhdV8pOgogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiBrdXJkJyAlIChILCBQLCBILCBLKSk7CiAgICBfX25hbWVfXyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBOQU1FIDogJyAlIChILCBQLCBILCBLKSkuc3BsaXQoJywnKTsKICAgIF9maWxlXyA9ICdkdW1wX25hbWUuanNvbicKICAgIHRyeToKICAgICAgICBvcy5yZW1vdmUoX2ZpbGVfKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIGZvciBfbmFtZV8gaW4gX19uYW1lX186IF91cmxfID0gImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS9zZWFyY2gvcGVvcGxlLz9xPSIgKyBfbmFtZV87Y2FyaV9uYW1hKF9maWxlXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hemltdmF1XywgX3VybF8pCiAgICBfYnVrYV9maWxlXyA9IF9hemltdmF1X2RhcHVudGFfKF9maWxlXywgJ3InKS5yZWFkKCkuc3BsaXRsaW5lcygpOwogICAgcHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzVE9UQUwgSUQgOiAlcyIgJSAoSCwgUCwgSCwgSywgc3RyKGxlbihfYnVrYV9maWxlXykpKSkKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGNhcmlfbmFtYShfZmlsZV8sIF9jb29raWVzXywgX3VybF8pOgogICAgX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCAiYSsiKTsKICAgIF9yZXFfc2VzX2Rldl8gPSBiczQuQmVhdXRpZnVsU291cChfcmVxX2dldF8oX3VybF8sIGNvb2tpZXM9X2Nvb2tpZXNfLCBoZWFkZXJzPWhlYWRlcl9uYW1hKS50ZXh0LCAiaHRtbC5wYXJzZXIiKQogICAgZm9yIF9hemltdmF1X2Rldl8gaW4gX3JlcV9zZXNfZGV2Xy5maW5kX2FsbCgiYSIsIGhyZWY9VHJ1ZSk6CiAgICAgICAgcHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiICUgKEgsIFAsIEgsIEssIEgsIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwKICAgICAgICAgICAgICBlbmQ9JycpOwogICAgICAgIHN5cy5zdGRvdXQuZmx1c2goKQogICAgICAgIGlmICI8aW1nIGFsdD0iIGluIHN0cihfYXppbXZhdV9kZXZfKToKICAgICAgICAgICAgaWYgImhvbWUucGhwIiBpbiBzdHIoX2F6aW12YXVfZGV2X1siaHJlZiJdKToKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBfc3RyX2Rldl8gPSBzdHIoX2F6aW12YXVfZGV2X1siaHJlZiJdKQogICAgICAgICAgICAgICAgaWYgInByb2ZpbGUucGhwIiBpbiBfc3RyX2Rldl86CiAgICAgICAgICAgICAgICAgICAgX25hbWVfID0gX2F6aW12YXVfZGV2Xy5maW5kKCJpbWciKS5nZXQoImFsdCIpLnJlcGxhY2UoIiwgcHJvZmlsZSBwaWN0dXJlIiwgIiIpOwogICAgICAgICAgICAgICAgICAgIF9maW5kXyA9IGJzNC5yZS5maW5kYWxsKCIvcHJvZmlsZVwucGhwXD9pZD0oLio/KSYiLCBfc3RyX2Rldl8pCiAgICAgICAgICAgICAgICAgICAgaWYgbGVuKF9maW5kXykgIT0gMDoKICAgICAgICAgICAgICAgICAgICAgICAgX3VzZXJfID0gIiIuam9pbihfZmluZF8pCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIF91c2VyXyBpbiBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9hemltdmF1X2RhcHVudGFfKF9maWxlXywgImErIikud3JpdGUoIiVz4oCiJXNcbiIgJSAoX3VzZXJfLCBfbmFtZV8pKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBfZmluZF8gPSBiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLCBfc3RyX2Rldl8pOwogICAgICAgICAgICAgICAgICAgIF9uYW1lXyA9IF9hemltdmF1X2Rldl8uZmluZCgiaW1nIikuZ2V0KCJhbHQiKS5yZXBsYWNlKCIsIHByb2ZpbGUgcGljdHVyZSIsICIiKQogICAgICAgICAgICAgICAgICAgIGlmIGxlbihfZmluZF8pICE9IDA6CiAgICAgICAgICAgICAgICAgICAgICAgIF91c2VyXyA9ICIiLmpvaW4oX2ZpbmRfKQogICAgICAgICAgICAgICAgICAgICAgICBpZiBfdXNlcl8gaW4gX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sICJhKyIpLndyaXRlKCIlc+KAoiVzXG4iICUgKF91c2VyXywgX25hbWVfKSkKICAgICAgICBpZiAiU2VlIE1vcmUgUmVzdWx0cyIgaW4gX2F6aW12YXVfZGV2Xy50ZXh0OiBjYXJpX25hbWEoX2ZpbGVfLCBfY29va2llc18sIF9hemltdmF1X2Rldl9bImhyZWYiXSkKCgpjbGFzcyBkdW1wX3Blc2FuOgogICAgZGVmIF9faW5pdF9fKHNlbGYsIF9jb29raWVzXywgX25hbWFfLCBfaWRfKToKICAgICAgICBzZWxmLmNvb2tpZXMgPSBfY29va2llc187CiAgICAgICAgc2VsZi5pZCA9IF9pZF87CiAgICAgICAgc2VsZi5maWxlcyA9IChfbmFtYV8gKyAnLmpzb24nKS5yZXBsYWNlKCIgIiwgIl8iKTsKICAgICAgICBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmZpbGVzLCAidyIpLmNsb3NlKCk7CiAgICAgICAgc2VsZi5kdW1wKCJodHRwczovL20uZmFjZWJvb2suY29tL21lc3NhZ2VzIikKCiAgICBkZWYgZHVtcChzZWxmLCB1cmwpOgogICAgICAgIF9yZXFfc2VzX2Rldl8gPSBiczQuQmVhdXRpZnVsU291cChfcmVxX2dldF8odXJsLCBoZWFkZXJzPWhlYWRlcl9uYW1hLCBjb29raWVzPXNlbGYuY29va2llcykudGV4dCwgImh0bWwucGFyc2VyIikKICAgICAgICBmb3IgX2Rldl8gaW4gX3JlcV9zZXNfZGV2Xy5maW5kX2FsbCgiYSIsIGhyZWY9VHJ1ZSk6CiAgICAgICAgICAgIGlmICIvbWVzc2FnZXMvcmVhZCIgaW4gX2Rldl8uZ2V0KCJocmVmIik6CiAgICAgICAgICAgICAgICBfc291cF8gPSBiczQucmUuZmluZGFsbCgiY2lkXC5jXC4oLio/KSUzQSguKj8pJiIsIF9kZXZfLmdldCgiaHJlZiIpKQogICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgIGZvciBfdXNlcl8gaW4gbGlzdChfc291cF8ucG9wKCkpOgogICAgICAgICAgICAgICAgICAgICAgICBpZiBfdXNlcl8gaW4gc2VsZi5pZDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAiRmFjZWJvb2sgdXNlciIgaW4gX2Rldl8udGV4dC5sb3dlcigpOiBjb250aW51ZQogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oc2VsZi5maWxlcywgImErIikud3JpdGUoIiVz4oCiJXNcbiIgJSAoX3VzZXJfLCBfZGV2Xy50ZXh0KSk7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiXHIlcyBbJXPigKIlc10gJXNUQUtJTkcgJXMlcyBJRCIgJSAoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBILCBQLCBILCBLLCBILCBsZW4oX2F6aW12YXVfZGFwdW50YV8oc2VsZi5maWxlcykucmVhZCgpLnNwbGl0bGluZXMoKSkpLCBlbmQ9JycpOwogICAgICAgICAgICAgICAgICAgICAgICAgICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgaWYgIlNlZSBPbGRlciBNZXNzYWdlcyIgaW4gX2Rldl8udGV4dDogc2VsZi5kdW1wKCJodHRwczovL20uZmFjZWJvb2suY29tLyIgKyBfZGV2Xy5nZXQoImhyZWYiKSkKICAgICAgICBfYnVrYV9maWxlXyA9IF9hemltdmF1X2RhcHVudGFfKHNlbGYuZmlsZXMsICdyJykucmVhZCgpLnNwbGl0bGluZXMoKTsKICAgICAgICBwcmludCgiXG4lcyBbJXPigKIlc10gJXNBTEwgSUQgOiAlcyIgJSAoSCwgUCwgSCwgSywgc3RyKGxlbihfYnVrYV9maWxlXykpKSkKICAgICAgICByZXR1cm4gY3JhY2soc2VsZi5maWxlcykKCgpkZWYgZmlsZSgpOgogICAgdHJ5OgogICAgICAgIHByaW50KCIiKQogICAgICAgIHhjID0gaW5wdXQoJyVzIFslc+KAoiVzXSAlc0ZJTEUgOiAlcycgJSAoSCwgUCwgSCwgSywgSCkpCiAgICAgICAgaWQgPSBvcGVuKHhjKS5yZWFkKCkuc3BsaXRsaW5lcygpCiAgICAgICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0FMTCBJRCA6ICVzJXMnICUgKEgsIFAsIEgsIE8sIEgsIGxlbihpZCkpKQogICAgICAgIHJldHVybiBjcmFjayh4YykKICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICBwcmludCgiJXMgWyVzISVzXSAlc0ZJTEUgTk9UIEVYSVNUSU5HIiAlIChNLCBQLCBNLCBNKSkKICAgICAgICBmaWxlKCkKCgpkZWYgZHVtcF9lbWFpbCgpOgogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiBhaG1hZGt1cmQ4MTkgIiAlIChILCBQLCBILCBLKSk7CiAgICBfcXVlcnlfID0gX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIE5BTUUgOiAiICUgKEgsIFAsIEgsIEspKS5sb3dlcigpCiAgICBpZiBsZW4oX3F1ZXJ5XykgPCAzOiBqYWxhbignJXMgWyVzISVzXSAlc05BTUUgTVVTVCBCRSBNT1JFIFRIQU4gMiBESUdJVFMnICUgKE0sIFAsIE0sIFApKTt0aW1lLnNsZWVwKDIpO21lbnUoKQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiAlc2dtYWlsLmNvbSIgJSAoSCwgUCwgSCwgSywgSCkpOwogICAgX2RvbWFpbl8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgRE9NQUlOIDogIiAlIChILCBQLCBILCBLKSkubG93ZXIoKQogICAgaWYgJ0AnIGluIF9kb21haW5fOiBfZG9tYWluXyA9IF9kb21haW5fLnNwbGl0KCdAJylbMV0KICAgIF9saW1pdF9hd2FsXyA9IGludChfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgU1RBUklORyBOVU1CRVIgOiAiICUgKEgsIFAsIEgsIEspKSk7CiAgICBfbGltaXRfYWtoaXJfID0gaW50KF9jaWNpX2F6aW12YXVfKCIlcyBbJXPigKIlc10gJXNFTlRFUiBFTkRJTkcgTlVNQkVSIDogIiAlIChILCBQLCBILCBLKSkpOwogICAgX2ZpbGVfID0gKF9xdWVyeV8gKyAiLmpzb24iKS5yZXBsYWNlKCIgIiwgIl8iKQogICAgdHJ5OgogICAgICAgIG9zLnJlbW92ZShfZmlsZV8pCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwogICAgZXhlY19lbWFpbChfcXVlcnlfLCBfZG9tYWluXywgX2xpbWl0X2F3YWxfLCBfbGltaXRfYWtoaXJfLCBfZmlsZV8pCgoKZGVmIGV4ZWNfZW1haWwoX19xdWVyeV9fLCBfZG9tYWluXywgX2xpbWl0X2F3YWxfLCBfbGltaXRfYWtoaXJfLCBfZmlsZV8pOgogICAgX2hpdHVuZ19lbWFpbF8xXyA9IF9saW1pdF9hd2FsXyArIDE7CiAgICBfaGl0dW5nX2VtYWlsXzJfID0gX2xpbWl0X2F3YWxfICsgMTsKICAgIF9oaXR1bmdfZW1haWxfM18gPSBfbGltaXRfYXdhbF8gKyAxOwogICAgX2hpdHVuZ19lbWFpbF9mdWxsXyA9IF9saW1pdF9hd2FsXyArIDEKICAgIGlmICcgJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbGlmICcuJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbGlmICdfJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbGlmICctJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbHNlOgogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzFfID0gX19xdWVyeV9fCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICB0cnk6CiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXywgX2xpbWl0X2FraGlyXyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG5hbWEgPSBfcXVlcnlfMV87ZW1haWwgPSAoJyVzJXNAJXMnICUgKF9xdWVyeV8xXywgc3RyKF9oaXR1bmdfZW1haWxfMV8pLCBfZG9tYWluXykpO19hemltdmF1X2RhcHVudGFfKAogICAgICAgICAgICAgICAgICAgIF9maWxlXywgJ2ErJykud3JpdGUoJyVz4oCiJXNcbicgJSAoZW1haWwsIG5hbWEpKTtfaGl0dW5nX2VtYWlsXzFfICs9IDEKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLCBfbGltaXRfYWtoaXJfKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbmFtYSA9IF9xdWVyeV8yXztlbWFpbCA9ICgnJXMlc0AlcycgJSAoX3F1ZXJ5XzJfLCBzdHIoX2hpdHVuZ19lbWFpbF8yXyksIF9kb21haW5fKSk7X2F6aW12YXVfZGFwdW50YV8oCiAgICAgICAgICAgICAgICAgICAgX2ZpbGVfLCAnYSsnKS53cml0ZSgnJXPigKIlc1xuJyAlIChlbWFpbCwgbmFtYSkpO19oaXR1bmdfZW1haWxfMl8gKz0gMQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sIF9saW1pdF9ha2hpcl8pOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBuYW1hID0gX3F1ZXJ5XzNfO2VtYWlsID0gKCclcyVzQCVzJyAlIChfcXVlcnlfM18sIHN0cihfaGl0dW5nX2VtYWlsXzNfKSwgX2RvbWFpbl8pKTtfYXppbXZhdV9kYXB1bnRhXygKICAgICAgICAgICAgICAgICAgICBfZmlsZV8sICdhKycpLndyaXRlKCclc+KAoiVzXG4nICUgKGVtYWlsLCBuYW1hKSk7X2hpdHVuZ19lbWFpbF8zXyArPSAxCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXywgX2xpbWl0X2FraGlyXyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmICcuJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJy4nLCAnICcpCiAgICAgICAgICAgICAgICBlbGlmICdfJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJ18nLCAnICcpCiAgICAgICAgICAgICAgICBlbGlmICctJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJy0nLCAnICcpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIF9xdWVyeV8gPSBfX3F1ZXJ5X18ucmVwbGFjZSgnICcsICcnKTtuYW1hID0gX19xdWVyeV9fCiAgICAgICAgICAgICAgICBlbWFpbCA9ICgnJXMlc0AlcycgJSAoX3F1ZXJ5Xywgc3RyKF9oaXR1bmdfZW1haWxfZnVsbF8pLCBfZG9tYWluXykpOwogICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCAnYSsnKS53cml0ZSgnJXPigKIlc1xuJyAlIChlbWFpbCwgbmFtYSkpOwogICAgICAgICAgICAgICAgX2hpdHVuZ19lbWFpbF9mdWxsXyArPSAxCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICBleGNlcHQ6CiAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNUSEVSRSBJUyBBTiBFUlJPUicgJSAoTSwgUCwgTSwgTSkpCiAgICAgICAgdGltZS5zbGVlcCgyKQogICAgICAgIG1lbnUoKQogICAgX2J1a2FfZmlsZV8gPSBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sICdyJykucmVhZCgpLnNwbGl0bGluZXMoKQogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIElEIDogJXMlcyIgJSAoSCwgUCwgSCwgSywgSCwgc3RyKGxlbihfYnVrYV9maWxlXykpKSkKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGR1bXBfdXNlcm5hbWUoKToKICAgIHByaW50KCIlcyBbJXPigKIlc10gJXNFWEFNUExFIDogJXNhaG1hZGt1cmQ4NzEiICUgKEgsIFAsIEgsIEssIEgpKTsKICAgIF9xdWVyeV8gPSBfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgTkFNRSA6ICIgJSAoSCwgUCwgSCwgSykpLmxvd2VyKCkKICAgIGlmIGxlbihfcXVlcnlfKSA8IDM6IGphbGFuKCclcyBbJXMhJXNdICVzTkFNRSBNVVNUIEJFIE1PUkUgVEhBTiAyIERJR0lUUycgJSAoTSwgUCwgTSwgTSkpO3RpbWUuc2xlZXAoMik7bWVudSgpCiAgICBfbGltaXRfYXdhbF8gPSBpbnQoX2NpY2lfYXppbXZhdV8oIiVzIFslc+KAoiVzXSAlc0VOVEVSIFNUQVJUSU5HIE5VTUJFUiAoRVg6IDEpIDogIiAlIChILCBQLCBILCBQKSkpOwogICAgX2xpbWl0X2FraGlyXyA9IGludChfY2ljaV9hemltdmF1XygiJXMgWyVz4oCiJXNdICVzRU5URVIgRU5ESU5HIE5VTUJFUiAoRVg6IDEwMDApOiAiICUgKEgsIFAsIEgsIFApKSk7CiAgICBfZmlsZV8gPSAoX3F1ZXJ5XyArICIuanNvbiIpLnJlcGxhY2UoIiAiLCAiXyIpCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKF9maWxlXykKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICBleGVjX3VzZXJuYW1lKF9xdWVyeV8sIF9saW1pdF9hd2FsXywgX2xpbWl0X2FraGlyXywgX2ZpbGVfKQoKCmRlZiBleGVjX3VzZXJuYW1lKF9fcXVlcnlfXywgX2xpbWl0X2F3YWxfLCBfbGltaXRfYWtoaXJfLCBfZmlsZV8pOgogICAgX2hpdHVuZ19lbWFpbF8xXyA9IF9saW1pdF9hd2FsXyArIDE7CiAgICBfaGl0dW5nX2VtYWlsXzJfID0gX2xpbWl0X2F3YWxfICsgMTsKICAgIF9oaXR1bmdfZW1haWxfM18gPSBfbGltaXRfYXdhbF8gKyAxOwogICAgX2hpdHVuZ19lbWFpbF9mdWxsXyA9IF9saW1pdF9hd2FsXyArIDEKICAgIGlmICcgJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJyAnKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcgJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnICcpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbGlmICcuJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy4nKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCcuJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLicpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbGlmICdfJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJ18nKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCdfJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnXycpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbGlmICctJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgdHJ5OgogICAgICAgICAgICBfcXVlcnlfMV8gPSBfX3F1ZXJ5X18uc3BsaXQoJy0nKVswXQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzJfID0gX19xdWVyeV9fLnNwbGl0KCctJylbMV0KICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHBhc3MKICAgICAgICB0cnk6CiAgICAgICAgICAgIF9xdWVyeV8zXyA9IF9fcXVlcnlfXy5zcGxpdCgnLScpWzJdCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICBlbHNlOgogICAgICAgIHRyeToKICAgICAgICAgICAgX3F1ZXJ5XzFfID0gX19xdWVyeV9fCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICB0cnk6CiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXywgX2xpbWl0X2FraGlyXyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG5hbWEgPSBfcXVlcnlfMV87ZW1haWwgPSAoJyVzJXMnICUgKF9xdWVyeV8xXywgc3RyKF9oaXR1bmdfZW1haWxfMV8pKSk7X2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAnYSsnKS53cml0ZSgKICAgICAgICAgICAgICAgICAgICAnJXPigKIlc1xuJyAlIChlbWFpbCwgbmFtYSkpO19oaXR1bmdfZW1haWxfMV8gKz0gMQogICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgIGZvciBfanVtbGFoXyBpbiByYW5nZShfbGltaXRfYXdhbF8sIF9saW1pdF9ha2hpcl8pOgogICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICBuYW1hID0gX3F1ZXJ5XzJfO2VtYWlsID0gKCclcyVzJyAlIChfcXVlcnlfMl8sIHN0cihfaGl0dW5nX2VtYWlsXzJfKSkpO19hemltdmF1X2RhcHVudGFfKF9maWxlXywKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2ErJykud3JpdGUoCiAgICAgICAgICAgICAgICAgICAgJyVz4oCiJXNcbicgJSAoZW1haWwsIG5hbWEpKTtfaGl0dW5nX2VtYWlsXzJfICs9IDEKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICBmb3IgX2p1bWxhaF8gaW4gcmFuZ2UoX2xpbWl0X2F3YWxfLCBfbGltaXRfYWtoaXJfKToKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgbmFtYSA9IF9xdWVyeV8zXztlbWFpbCA9ICgnJXMlcycgJSAoX3F1ZXJ5XzNfLCBzdHIoX2hpdHVuZ19lbWFpbF8zXykpKTtfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICdhKycpLndyaXRlKAogICAgICAgICAgICAgICAgICAgICclc+KAoiVzXG4nICUgKGVtYWlsLCBuYW1hKSk7X2hpdHVuZ19lbWFpbF8zXyArPSAxCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZm9yIF9qdW1sYWhfIGluIHJhbmdlKF9saW1pdF9hd2FsXywgX2xpbWl0X2FraGlyXyk6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIGlmICcuJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJy4nLCAnICcpCiAgICAgICAgICAgICAgICBlbGlmICdfJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJ18nLCAnICcpCiAgICAgICAgICAgICAgICBlbGlmICctJyBpbiBfX3F1ZXJ5X186CiAgICAgICAgICAgICAgICAgICAgX3F1ZXJ5XyA9IF9fcXVlcnlfXztuYW1hID0gX19xdWVyeV9fLnJlcGxhY2UoJy0nLCAnICcpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIF9xdWVyeV8gPSBfX3F1ZXJ5X18ucmVwbGFjZSgnICcsICcnKTtuYW1hID0gX19xdWVyeV9fCiAgICAgICAgICAgICAgICBlbWFpbCA9ICgnJXMlcycgJSAoX3F1ZXJ5Xywgc3RyKF9oaXR1bmdfZW1haWxfZnVsbF8pKSk7CiAgICAgICAgICAgICAgICBfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8sICdhKycpLndyaXRlKCclc+KAoiVzXG4nICUgKGVtYWlsLCBuYW1hKSk7CiAgICAgICAgICAgICAgICBfaGl0dW5nX2VtYWlsX2Z1bGxfICs9IDEKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgY29udGludWUKICAgIGV4Y2VwdDoKICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc1RIRVJFIElTIEFOIEVSUk9SJyAlIChNLCBQLCBNLCBQKSk7dGltZS5zbGVlcCgyKTttZW51KCkKICAgIF9idWthX2ZpbGVfID0gX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfLCAncicpLnJlYWQoKS5zcGxpdGxpbmVzKCk7CiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzQUxMIElEIDogJXMlcyIgJSAoSCwgUCwgSCwgSywgSCwgc3RyKGxlbihfYnVrYV9maWxlXykpKSkKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKIyMjIER1bXAgSUQgRGFyaSBIYXNodGFnCmRlZiBoYXNodGFnKGNvb2tpZXMpOgogICAgX3F1ZXJ5XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBIQVNIVEFHIDogJyAlIChILCBQLCBILCBCKSk7CiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2hhc2h0YWcvJyArIF9xdWVyeV87CiAgICBfZmlsZV8gPSAoX3F1ZXJ5XyArICcuanNvbicpLnJlcGxhY2UoJyAnLCAnXycpCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKF9maWxlXykKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIgJSAoSCwgUCwgSCwgSykpOwogICAgZXhlY19oYXNodGFnKF91cmxfZGV2XywgY29va2llcywgX2ZpbGVfKTsKICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTsKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGV4ZWNfaGFzaHRhZyh1cmwsIGNvb2tpZXMsIF9maWxlXyk6CiAgICBvcGVuKF9maWxlXywgJ2EnKTsKICAgIF9yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKTsKICAgIF9yZXFfZ2V0XyA9IF9yZXFfc2VzXy5nZXQodXJsLCBjb29raWVzPWNvb2tpZXMsIGhlYWRlcnM9aGVhZGVyX2hhc2h0YWcpOwogICAgX3NvcF9kZXZfID0gcGFyKF9yZXFfZ2V0Xy50ZXh0LCAnaHRtbC5wYXJzZXInKTsKICAgIF9idWthX2ZpbGVfID0gb3BlbihfZmlsZV8pLnJlYWQoKTsKICAgIHByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiAlIChILCBQLCBILCBLLCBILCBsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksCiAgICAgICAgICBlbmQ9JycpOwogICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICB0cnk6CiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2gzJyk6CiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX2NpY2lfLmZpbmRfYWxsKCdhJywgaHJlZj1UcnVlKToKICAgICAgICAgICAgICAgIGlmICdtYmFzaWMuZmFjZWJvb2suY29tJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6CiAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiAicHJvZmlsZS5waHAiIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0OwogICAgICAgICAgICAgICAgICAgICAgICAgICAgX2lkX2Rldl8gPSAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCJwcm9maWxlXC5waHBcP2lkPSguKj8pJiIsIF9hemltdmF1Xy5nZXQoImhyZWYiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiBfbmFtZV9kZXZfIGluIF9idWthX2ZpbGVfOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlbihfZmlsZV8sICdhKycpLndyaXRlKCclc+KAoiVzXG4nICUgKF9pZF9kZXZfLCBfbmFtZV9kZXZfKSkKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIF9pZF9kZXZfID0gIiIuam9pbihiczQucmUuZmluZGFsbCgiLyguKj8pXD8iLCBfYXppbXZhdV8uZ2V0KCJocmVmIikpKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbGlmICcvJyBpbiBfaWRfZGV2XzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9wZW4oX2ZpbGVfLCAnYSsnKS53cml0ZSgnJXPigKIlc1xuJyAlIChfaWRfZGV2XywgX25hbWVfZGV2XykpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLCBocmVmPVRydWUpOgogICAgICAgICAgICAgICAgaWYgJ1NlZSBNb3JlIFJlc3VsdHMnIGluIF9hemltdmF1Xy50ZXh0OiB1cmxfZGV2ID0gX2F6aW12YXVfLmdldCgnaHJlZicpO2V4ZWNfaGFzaHRhZyh1cmxfZGV2LCBjb29raWVzLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBfZmlsZV8pCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiAlICgKICAgICAgICBILCBQLCBILCBLLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGJlcmFuZGEoY29va2llcyk6CiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2hvbWUucGhwJzsKICAgIF9maWxlXyA9ICdiZXJhbmRhLmpzb24nCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKF9maWxlXykKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIgJSAoSCwgUCwgSCwgSykpOwogICAgZXhlY19iZXJhbmRhKF91cmxfZGV2XywgY29va2llcywgX2ZpbGVfKTsKICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTsKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGV4ZWNfYmVyYW5kYSh1cmwsIGNvb2tpZXMsIF9maWxlXyk6CiAgICBvcGVuKF9maWxlXywgJ2EnKTsKICAgIF9yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKTsKICAgIF9yZXFfZ2V0XyA9IF9yZXFfc2VzXy5nZXQodXJsLCBjb29raWVzPWNvb2tpZXMsIGhlYWRlcnM9aGVhZGVyX25hbWEpOwogICAgX3NvcF9kZXZfID0gcGFyKF9yZXFfZ2V0Xy50ZXh0LCAnaHRtbC5wYXJzZXInKTsKICAgIF9idWthX2ZpbGVfID0gb3BlbihfZmlsZV8pLnJlYWQoKTsKICAgIHByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiAlIChILCBQLCBILCBLLCBILCBsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksCiAgICAgICAgICBlbmQ9JycpOwogICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICB0cnk6CiAgICAgICAgZm9yIF9jaWNpXyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2gzJyk6CiAgICAgICAgICAgIGZvciBfYXppbXZhdV8gaW4gX2NpY2lfLmZpbmRfYWxsKCdhJywgaHJlZj1UcnVlKToKICAgICAgICAgICAgICAgIGlmICJwcm9maWxlLnBocCIgaW4gX2F6aW12YXVfLmdldCgnaHJlZicpOgogICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0OwogICAgICAgICAgICAgICAgICAgICAgICBfaWRfZGV2XyA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoInByb2ZpbGVcLnBocFw/aWQ9KC4qPykmIiwgX2F6aW12YXVfLmdldCgiaHJlZiIpKSkKICAgICAgICAgICAgICAgICAgICAgICAgaWYgX25hbWVfZGV2XyBpbiBfYnVrYV9maWxlXzoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgZWxpZiAnLycgaW4gX2lkX2Rldl86CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBvcGVuKF9maWxlXywgJ2ErJykud3JpdGUoJyVz4oCiJXNcbicgJSAoX2lkX2Rldl8sIF9uYW1lX2Rldl8pKQogICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIF9uYW1lX2Rldl8gPSBfYXppbXZhdV8udGV4dDsKICAgICAgICAgICAgICAgICAgICAgICAgX2lkX2Rldl8gPSAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCIvKC4qPylcPyIsIF9hemltdmF1Xy5nZXQoImhyZWYiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIF9uYW1lX2Rldl8gaW4gX2J1a2FfZmlsZV86CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgICAgIGVsaWYgJy8nIGluIF9pZF9kZXZfOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3BlbihfZmlsZV8sICdhKycpLndyaXRlKCclc+KAoiVzXG4nICUgKF9pZF9kZXZfLCBfbmFtZV9kZXZfKSkKICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLCBocmVmPVRydWUpOgogICAgICAgICAgICAgICAgaWYgJ1NlZSBNb3JlIFN0b3JpZXMnIGluIF9hemltdmF1Xy50ZXh0OiB1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgKICAgICAgICAgICAgICAgICAgICAnaHJlZicpO2V4ZWNfYmVyYW5kYSh1cmxfZGV2LCBjb29raWVzLCBfZmlsZV8pCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiAlICgKICAgICAgICBILCBQLCBILCBLLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayhjb29raWVzKToKICAgIF91cmxfZGV2XyA9ICdodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vZnJpZW5kcy9jZW50ZXIvcmVxdWVzdHMnOwogICAgX2ZpbGVfID0gJ2ZyaWVuZF9sb2dpbi5qc29uJwogICAgdHJ5OgogICAgICAgIG9zLnJlbW92ZShfZmlsZV8pCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1BSRVNTIENUUkwrQyBUTyBTVE9QIERVTVAiICUgKEgsIFAsIEgsIEspKTsKICAgIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX21hc3VrKF91cmxfZGV2XywgY29va2llcywgX2ZpbGVfKTsKICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTsKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX21hc3VrKHVybCwgY29va2llcywgX2ZpbGVfKToKICAgIG9wZW4oX2ZpbGVfLCAnYScpOwogICAgX3JlcV9zZXNfID0gcmVxdWVzdHMuU2Vzc2lvbigpOwogICAgX3JlcV9nZXRfID0gX3JlcV9zZXNfLmdldCh1cmwsIGNvb2tpZXM9Y29va2llcywgaGVhZGVycz1oZWFkZXJfbmFtYSk7CiAgICBfc29wX2Rldl8gPSBwYXIoX3JlcV9nZXRfLnRleHQsICdodG1sLnBhcnNlcicpOwogICAgcHJpbnQoIlxyJXMgWyVz4oCiJXNdICVzVEFLSU5HICVzJXMgSUQiICUgKEgsIFAsIEgsIEssIEgsIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSwKICAgICAgICAgIGVuZD0nJyk7CiAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgIHRyeToKICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsIGhyZWY9VHJ1ZSk6CiAgICAgICAgICAgIGlmICcvZnJpZW5kcy9ob3ZlcmNhcmQnIGluIF9hemltdmF1Xy5nZXQoJ2hyZWYnKToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICBfbmFtZV9kZXZfID0gX2F6aW12YXVfLnRleHQ7X2lkX2Rldl8gPSAiIi5qb2luKAogICAgICAgICAgICAgICAgICAgICAgICBiczQucmUuZmluZGFsbCgndWlkPSguKj8pJicsIF9hemltdmF1Xy5nZXQoJ2hyZWYnKSkpO29wZW4oX2ZpbGVfLCAnYSsnKS53cml0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgJyVz4oCiJXNcbicgJSAoX2lkX2Rldl8sIF9uYW1lX2Rldl8pKQogICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9zb3BfZGV2Xy5maW5kX2FsbCgnYScsIGhyZWY9VHJ1ZSk6CiAgICAgICAgICAgIGlmICdTZWUgTW9yZScgaW4gX2F6aW12YXVfLnRleHQ6IHVybF9kZXYgPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLycgKyBfYXppbXZhdV8uZ2V0KAogICAgICAgICAgICAgICAgJ2hyZWYnKTtleGVjX3Blcm1pbnRhYW5fcGVydGVtYW5hbl9tYXN1ayh1cmxfZGV2LCBjb29raWVzLCBfZmlsZV8pCiAgICBleGNlcHQgS2V5Ym9hcmRJbnRlcnJ1cHQ6CiAgICAgICAgcHJpbnQoIlxuJXMgWyVz4oCiJXNdICVzU1VDQ0VTU0ZVTCBEVU1QICVzIElEIiAlICgKICAgICAgICBILCBQLCBILCBLLCBsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSkpO3JldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIHBlcm1pbnRhYW5fcGVydGVtYW5hbl9rZWx1YXIoY29va2llcyk6CiAgICBfdXJsX2Rldl8gPSAnaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2ZyaWVuZHMvY2VudGVyL3JlcXVlc3RzL291dGdvaW5nJzsKICAgIF9maWxlXyA9ICdmcmllbmRfb3V0Lmpzb24nCiAgICB0cnk6CiAgICAgICAgb3MucmVtb3ZlKF9maWxlXykKICAgIGV4Y2VwdDoKICAgICAgICBwYXNzCiAgICBwcmludCgiJXMgWyVz4oCiJXNdICVzUFJFU1MgQ1RSTCtDIFRPIFNUT1AgRFVNUCIgJSAoSCwgUCwgSCwgSykpOwogICAgZXhlY19wZXJtaW50YWFuX3BlcnRlbWFuYW5fa2VsdWFyKF91cmxfZGV2XywgY29va2llcywgX2ZpbGVfKTsKICAgIHByaW50KCJcbiVzIFslc+KAoiVzXSAlc1NVQ0NFU1NGVUwgRFVNUCAlcyBJRCIgJSAoSCwgUCwgSCwgSywgbGVuKF9hemltdmF1X2RhcHVudGFfKF9maWxlXykucmVhZCgpLnNwbGl0bGluZXMoKSkpKTsKICAgIHJldHVybiBjcmFjayhfZmlsZV8pCgoKZGVmIGV4ZWNfcGVybWludGFhbl9wZXJ0ZW1hbmFuX2tlbHVhcih1cmwsIGNvb2tpZXMsIF9maWxlXyk6CiAgICBvcGVuKF9maWxlXywgJ2EnKTsKICAgIF9yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKTsKICAgIF9yZXFfZ2V0XyA9IF9yZXFfc2VzXy5nZXQodXJsLCBjb29raWVzPWNvb2tpZXMsIGhlYWRlcnM9aGVhZGVyX25hbWEpOwogICAgX3NvcF9kZXZfID0gcGFyKF9yZXFfZ2V0Xy50ZXh0LCAnaHRtbC5wYXJzZXInKTsKICAgIHByaW50KCJcciVzIFslc+KAoiVzXSAlc1RBS0lORyAlcyVzIElEIiAlIChILCBQLCBILCBLLCBILCBsZW4oX2F6aW12YXVfZGFwdW50YV8oX2ZpbGVfKS5yZWFkKCkuc3BsaXRsaW5lcygpKSksCiAgICAgICAgICBlbmQ9JycpOwogICAgc3lzLnN0ZG91dC5mbHVzaCgpCiAgICB0cnk6CiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLCBocmVmPVRydWUpOgogICAgICAgICAgICBpZiAnL2ZyaWVuZHMvaG92ZXJjYXJkJyBpbiBfYXppbXZhdV8uZ2V0KCdocmVmJyk6CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgX25hbWVfZGV2XyA9IF9hemltdmF1Xy50ZXh0O19pZF9kZXZfID0gIiIuam9pbigKICAgICAgICAgICAgICAgICAgICAgICAgYnM0LnJlLmZpbmRhbGwoJ3VpZD0oLio/KSYnLCBfYXppbXZhdV8uZ2V0KCdocmVmJykpKTtvcGVuKF9maWxlXywgJ2ErJykud3JpdGUoCiAgICAgICAgICAgICAgICAgICAgICAgICclc+KAoiVzXG4nICUgKF9pZF9kZXZfLCBfbmFtZV9kZXZfKSkKICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgZm9yIF9hemltdmF1XyBpbiBfc29wX2Rldl8uZmluZF9hbGwoJ2EnLCBocmVmPVRydWUpOgogICAgICAgICAgICBpZiAnU2VlIE1vcmUnIGluIF9hemltdmF1Xy50ZXh0OiB1cmxfZGV2ID0gJ2h0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8nICsgX2F6aW12YXVfLmdldCgKICAgICAgICAgICAgICAgICdocmVmJyk7ZXhlY19wZXJtaW50YWFuX3BlcnRlbWFuYW5fa2VsdWFyKHVybF9kZXYsIGNvb2tpZXMsIF9maWxlXykKICAgIGV4Y2VwdCBLZXlib2FyZEludGVycnVwdDoKICAgICAgICBwcmludCgiXG4lcyBbJXPigKIlc10gJXNTVUNDRVNTRlVMIERVTVAgJXMgSUQiICUgKAogICAgICAgIEgsIFAsIEgsIEssIGxlbihfYXppbXZhdV9kYXB1bnRhXyhfZmlsZV8pLnJlYWQoKS5zcGxpdGxpbmVzKCkpKSk7cmV0dXJuIGNyYWNrKF9maWxlXykKCgojIyMgQ2VrIFRhcmdldCBDcmFjawpkZWYgY2VrX3RhcmdldF9jcmFja18oX2lkXyk6CiAgICBvcGVuKCdsaXN0X2lkLnR4dCcsICdhKycpCiAgICB0cnk6CiAgICAgICAgX2Nla18gPSBvcGVuKCdsaXN0X2lkLnR4dCcsICdyJykucmVhZCgpCiAgICAgICAgaWYgX2lkXyBpbiBfY2VrXzoKICAgICAgICAgICAgaWYgX2lkXyA9PSAnbWUnOgogICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgX2Nva3p6XyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXMhJXNdICVzSUQgSEFTIEJFRU4gQ1JBQ0tFRCwgQ09OVElOVUU/IFtZL25dIDogJyAlIChNLCBQLCBNLCBQKSkKICAgICAgICAgICAgICAgIGlmIF9jb2t6el8gaW4gWycnLCAnICddOgogICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGVsaWYgX2Nva3p6XyBpbiBbJzEnLCAnMDEnLCAneSddOgogICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgIGVsaWYgX2Nva3p6XyBpbiBbJzInLCAnMCcsICduJ106CiAgICAgICAgICAgICAgICAgICAgbWVudSgpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICBlbHNlOgogICAgICAgICAgICBfYXppbXZhdV9kYXB1bnRhXygnbGlzdF9pZC50eHQnLCAiYSsiKS53cml0ZSgiJXNcbiIgJSAoX2lkXykpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwoKCiMjIyBHZW5lcmF0ZSBQYXNzd29yZApkZWYgZ2VuZXJhdGUxKF9jaWNpXyk6CiAgICBfYXppbXZhdV8gPSBbXQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6CiAgICAgICAgaWYgbGVuKGkpIDwgMzoKICAgICAgICAgICAgY29udGludWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBpID0gaS5sb3dlcigpCiAgICAgICAgICAgIGlmIGxlbihpKSA9PSAzIG9yIGxlbihpKSA9PSA0IG9yIGxlbihpKSA9PSA1OgogICAgICAgICAgICAgICAgX2F6aW12YXVfLmFwcGVuZChpICsgIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMjM0NSIpO19hemltdmF1Xy5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgaSArICIxMjM0NTY3ODkiKTtfYXppbXZhdV8uYXBwZW5kKGkgKyAiMTIzNCIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMjM0NTYiKQogICAgICAgICAgICBlbGlmIGxlbihpKSA+PSA2OgogICAgICAgICAgICAgICAgX2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkgKyAiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyMzQ1Iik7X2F6aW12YXVfLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICBpICsgIjEyMzQ1Njc4OSIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyMzQ1NiIpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBjb250aW51ZQogICAgX2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKSkKICAgIHJldHVybiBfYXppbXZhdV8KCgpkZWYgZ2VuZXJhdGUyKF9jaWNpXyk6CiAgICBfYXppbXZhdV8gPSBbXQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6CiAgICAgICAgaWYgbGVuKGkpIDwgMzoKICAgICAgICAgICAgY29udGludWUKICAgICAgICBlbHNlOgogICAgICAgICAgICBpID0gaS5sb3dlcigpCiAgICAgICAgICAgIGlmIGxlbihpKSA9PSAzIG9yIGxlbihpKSA9PSA0IG9yIGxlbihpKSA9PSA1OgogICAgICAgICAgICAgICAgX2F6aW12YXVfLmFwcGVuZChpICsgIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyMzQ1IikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9hemltdmF1Xy5hcHBlbmQoaSk7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyIik7X2F6aW12YXVfLmFwcGVuZChpICsgIjIwMDAiKTtfYXppbXZhdV8uYXBwZW5kKAogICAgICAgICAgICAgICAgICAgIGkgKyAiMTIzNCIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMTIyMzM0NCIpCiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpKTsKICAgIF9hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVswXSArIF9jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMV0pCiAgICByZXR1cm4gX2F6aW12YXVfCgoKZGVmIGdlbmVyYXRlMyhfY2ljaV8pOgogICAgX2F6aW12YXVfID0gW10KICAgIGZvciBpIGluIF9jaWNpXy5zcGxpdCgiICIpOgogICAgICAgIGlmIGxlbihpKSA8IDM6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZWxzZToKICAgICAgICAgICAgaSA9IGkubG93ZXIoKQogICAgICAgICAgICBpZiBsZW4oaSkgPT0gMyBvciBsZW4oaSkgPT0gNCBvciBsZW4oaSkgPT0gNToKICAgICAgICAgICAgICAgIF9hemltdmF1Xy5hcHBlbmQoaSArICIxMjMiKTtfYXppbXZhdV8uYXBwZW5kKGkgKyAiMTIzNCIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMjM0NSIpO19hemltdmF1Xy5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgaSArICIyMDAyIikKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIF9hemltdmF1Xy5hcHBlbmQoaSk7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyMzQ1Njc4Iik7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyIik7X2F6aW12YXVfLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICBpICsgIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMjM0Iik7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyMzQ1Iik7X2F6aW12YXVfLmFwcGVuZCgKICAgICAgICAgICAgICAgICAgICBpLnVwcGVyKCkgKyAiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpICsgIjIwMDEiKTtfYXppbXZhdV8uYXBwZW5kKGkgKyAiMTIzNDU2Nzg5IikKICAgIF9hemltdmF1Xy5hcHBlbmQoX2NpY2lfLmxvd2VyKCkpOwogICAgX2F6aW12YXVfLmFwcGVuZChfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzBdICsgX2NpY2lfLmxvd2VyKCkuc3BsaXQoIiAiKVsxXSk7CiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMF0gKyBfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzFdICsgIjEyIik7CiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpLnNwbGl0KCIgIilbMF0gKyBfY2ljaV8ubG93ZXIoKS5zcGxpdCgiICIpWzFdICsgIjEyMyIpOwogICAgX2F6aW12YXVfLmFwcGVuZCgiMTEyMjMzNDQ1NSIpCiAgICByZXR1cm4gX2F6aW12YXVfCgoKZGVmIGdlbmVyYXRlNChfY2ljaV8pOgogICAgX2F6aW12YXVfID0gW10KICAgIHBzID0gX2F6aW12YXVfZGFwdW50YV8oJ3Bhc3MudHh0JywgJ3InKS5yZWFkKCkKICAgIHBwID0gX2F6aW12YXVfZGFwdW50YV8oJ2RpZ2l0cGFzcy50eHQnLCAncicpLnJlYWQoKQogICAgZm9yIGkgaW4gX2NpY2lfLnNwbGl0KCIgIik6CiAgICAgICAgaSA9IGkubG93ZXIoKQogICAgICAgIGlmIGxlbihpKSA8IDM6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgZWxpZiBsZW4oaSkgPT0gMyBvciBsZW4oaSkgPT0gNCBvciBsZW4oaSkgPT0gNToKICAgICAgICAgICAgX2F6aW12YXVfLmFwcGVuZChpICsgIjEyMyIpO19hemltdmF1Xy5hcHBlbmQoaSArICIxMjM0NSIpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2F6aW12YXVfLmFwcGVuZChpKTtfYXppbXZhdV8uYXBwZW5kKGkgKyAiMTIzIik7X2F6aW12YXVfLmFwcGVuZChpICsgIjEyMzQ1IikKICAgIGlmIHBwIGluIFsnJywgJyAnLCAnICAnXToKICAgICAgICBwYXNzCiAgICBlbHNlOgogICAgICAgIGZvciBpIGluIF9jaWNpXy5zcGxpdCgiICIpOgogICAgICAgICAgICBpID0gaS5sb3dlcigpCiAgICAgICAgICAgIGZvciB4IGluIHBwLnNwbGl0KCcsJyk6IF9hemltdmF1Xy5hcHBlbmQoaSArIHgpCiAgICBpZiBwcyBpbiBbJycsICcgJywgJyAgJ106CiAgICAgICAgcGFzcwogICAgZWxzZToKICAgICAgICBmb3IgeiBpbiBwcy5zcGxpdCgnLCcpOiBfYXppbXZhdV8uYXBwZW5kKHopCiAgICBfYXppbXZhdV8uYXBwZW5kKF9jaWNpXy5sb3dlcigpKQogICAgcmV0dXJuIF9hemltdmF1XwoKCmRlZiB0YW1iYWhfcGFzcygpOgogICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgOiAlNzc4ODk5LDEyMzQ1NiwxMDIwMzAsNzg2Nzg2JyAlIChILCBQLCBILCBLLCBIKSk7CiAgICBjdXkgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgTUFOVUFMIFNVUFBMRU1FTlRBTCBQQVNTIFsxIFdPUkRdIDogJyAlIChILCBQLCBILCBLKSk7CiAgICBnaCA9IF9hemltdmF1X2RhcHVudGFfKCdwYXNzLnR4dCcsICd3Jyk7CiAgICBnaC53cml0ZShjdXkpOwogICAgZ2guY2xvc2UKCgpkZWYgdGFtYmFoX3Bhc3NfYW5na2EoKToKICAgIHByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIDogJXMxNDMsNzg2LGdhbWluZycgJSAoSCwgUCwgSCwgSywgSCkpOwogICAgY295ID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0VOVEVSIEFERElUSU9OQUwgUEFTUyBCRUhJTkQgTkFNRSA6ICcgJSAoSCwgUCwgSCwgSykpOwogICAgeHkgPSBfYXppbXZhdV9kYXB1bnRhXygnZGlnaXRwYXNzLnR4dCcsICd3Jyk7CiAgICB4eS53cml0ZShjb3kpOwogICAgeHkuY2xvc2UKCgojIyMgTG9nZ2VyIENyYWNrCmRlZiBsb2dfYXBpXzEoZW0sIHBhcyk6CiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCAncicpLnJlYWQoKQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgaGVhZGVyID0geyJ4LWZiLWNvbm5lY3Rpb24tYmFuZHdpZHRoIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwMDAwLjAsIDMwMDAwMDAwLjApKSwKICAgICAgICAgICAgICAieC1mYi1zaW0taG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLCAieC1mYi1uZXQtaG5pIjogc3RyKHJhbmRvbS5yYW5kaW50KDIwMDAwLCA0MDAwMCkpLAogICAgICAgICAgICAgICJ4LWZiLWNvbm5lY3Rpb24tcXVhbGl0eSI6ICJFWENFTExFTlQiLCAieC1mYi1jb25uZWN0aW9uLXR5cGUiOiAiY2VsbC5DVFJhZGlvQWNjZXNzVGVjaG5vbG9neUhTRFBBIiwKICAgICAgICAgICAgICAidXNlci1hZ2VudCI6IHVhLCAiY29udGVudC10eXBlIjogImFwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZCIsICJ4LWZiLWh0dHAtZW5naW5lIjogIkxpZ2VyIn0KICAgIHJlc3BvbnNlID0gci5nZXQoCiAgICAgICAgJ2h0dHBzOi8vYi1hcGkuZmFjZWJvb2suY29tL21ldGhvZC9hdXRoLmxvZ2luP2Zvcm1hdD1qc29uJmVtYWlsPScgKyBlbSArICcmcGFzc3dvcmQ9JyArIHBhcyArICcmY3JlZGVudGlhbHNfdHlwZT1kZXZpY2VfYmFzZWRfbG9naW5fcGFzc3dvcmQmZ2VuZXJhdGVfc2Vzc2lvbl9jb29raWVzPTEmZXJyb3JfZGV0YWlsX3R5cGU9YnV0dG9uX3dpdGhfZGlzYWJsZWQmc291cmNlPWRldmljZV9iYXNlZF9sb2dpbiZtZXRhX2luZl9mYm1ldGE9JTIwJmN1cnJlbnRseV9sb2dnZWRfaW5fdXNlcmlkPTAmbWV0aG9kPUdFVCZsb2NhbGU9ZW5fVVMmY2xpZW50X2NvdW50cnlfY29kZT1VUyZmYl9hcGlfY2FsbGVyX2NsYXNzPWNvbS5mYWNlYm9vay5mb3MuaGVhZGVyc3YyLmZiNGFvcmNhLkhlYWRlcnNWMkNvbmZpZ0ZldGNoUmVxdWVzdEhhbmRsZXImYWNjZXNzX3Rva2VuPTM1MDY4NTUzMTcyOHw2MmY4Y2U5Zjc0YjEyZjg0YzEyM2NjMjM0MzdhNGEzMiZmYl9hcGlfcmVxX2ZyaWVuZGx5X25hbWU9YXV0aGVudGljYXRlJmNwbD10cnVlJywKICAgICAgICBoZWFkZXJzPWhlYWRlcikKICAgIGlmICdzZXNzaW9uX2tleScgaW4gcmVzcG9uc2UudGV4dCBhbmQgJ0VBQUEnIGluIHJlc3BvbnNlLnRleHQ6CiAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogIm9rIiwgImVtYWlsIjogZW0sICJwYXNzIjogcGFzfQogICAgZWxpZiAnd3d3LmZhY2Vib29rLmNvbScgaW4gcmVzcG9uc2UuanNvbigpWydlcnJvcl9tc2cnXToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiY3AiLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXN9CiAgICBlbHNlOgogICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJlcnJvciIsICJlbWFpbCI6IGVtLCAicGFzcyI6IHBhc30KCgpkZWYgbG9nX2FwaV8yKGVtLCBwYXMpOgogICAgdWEgPSBfYXppbXZhdV9kYXB1bnRhXygndWdlbnQudHh0JywgJ3InKS5yZWFkKCkKICAgIHIgPSByZXF1ZXN0cy5TZXNzaW9uKCkKICAgIGhlYWRlciA9IHsieC1mYi1jb25uZWN0aW9uLWJhbmR3aWR0aCI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMDAwMC4wLCAzMDAwMDAwMC4wKSksCiAgICAgICAgICAgICAgIngtZmItc2ltLWhuaSI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMCwgNDAwMDApKSwgIngtZmItbmV0LWhuaSI6IHN0cihyYW5kb20ucmFuZGludCgyMDAwMCwgNDAwMDApKSwKICAgICAgICAgICAgICAieC1mYi1jb25uZWN0aW9uLXF1YWxpdHkiOiAiRVhDRUxMRU5UIiwgIngtZmItY29ubmVjdGlvbi10eXBlIjogImNlbGwuQ1RSYWRpb0FjY2Vzc1RlY2hub2xvZ3lIU0RQQSIsCiAgICAgICAgICAgICAgInVzZXItYWdlbnQiOiB1YSwgImNvbnRlbnQtdHlwZSI6ICJhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQiLCAieC1mYi1odHRwLWVuZ2luZSI6ICJMaWdlciJ9CiAgICBwYXJhbSA9IHsnYWNjZXNzX3Rva2VuJzogJzM1MDY4NTUzMTcyOCU3QzYyZjhjZTlmNzRiMTJmODRjMTIzY2MyMzQzN2E0YTMyJywgJ2Zvcm1hdCc6ICdqc29uJywgJ3Nka192ZXJzaW9uJzogJzInLAogICAgICAgICAgICAgJ2VtYWlsJzogZW0sICdsb2NhbGUnOiAnZW5fVVMnLCAncGFzc3dvcmQnOiBwYXMsICdzZGsnOiAnaW9zJywgJ2dlbmVyYXRlX3Nlc3Npb25fY29va2llcyc6ICcxJywKICAgICAgICAgICAgICdzaWcnOiAnM2Y1NTVmOTlmYjYxZmNkN2FhMGM0NGY1OGY1MjJlZjYnfQogICAgYXBpID0gJ2h0dHBzOi8vYi1hcGkuZmFjZWJvb2suY29tL21ldGhvZC9hdXRoLmxvZ2luJwogICAgcmVzcG9uc2UgPSByLmdldChhcGksIHBhcmFtcz1wYXJhbSwgaGVhZGVycz1oZWFkZXIpCiAgICBpZiAnc2Vzc2lvbl9rZXknIGluIHJlc3BvbnNlLnRleHQgYW5kICdFQUFBJyBpbiByZXNwb25zZS50ZXh0OgogICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJvayIsICJlbWFpbCI6IGVtLCAicGFzcyI6IHBhc30KICAgIGVsaWYgJ3d3dy5mYWNlYm9vay5jb20nIGluIHJlc3BvbnNlLmpzb24oKVsnZXJyb3JfbXNnJ106CiAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImNwIiwgImVtYWlsIjogZW0sICJwYXNzIjogcGFzfQogICAgZWxzZToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiZXJyb3IiLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXN9CgoKZGVmIGxvZ19tYmFzaWNfMShlbSwgcGFzKToKICAgIHVhID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsICdyJykucmVhZCgpCiAgICByID0gcmVxdWVzdHMuU2Vzc2lvbigpCiAgICByLmhlYWRlcnMudXBkYXRlKHsiSG9zdCI6ICJtYmFzaWMuZmFjZWJvb2suY29tIiwgImNhY2hlLWNvbnRyb2wiOiAibWF4LWFnZT0wIiwgInVwZ3JhZGUtaW5zZWN1cmUtcmVxdWVzdHMiOiAiMSIsCiAgICAgICAgICAgICAgICAgICAgICAidXNlci1hZ2VudCI6IHVhLAogICAgICAgICAgICAgICAgICAgICAgImFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwKICAgICAgICAgICAgICAgICAgICAgICJhY2NlcHQtZW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tR0IsZW4tVVM7cT0wLjksZW47cT0wLjgsYm47cT0wLjcifSkKICAgIHAgPSByLmdldCgiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tLyIpCiAgICBiID0gci5wb3N0KCJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4ucGhwIiwgZGF0YT17ImVtYWlsIjogZW0sICJwYXNzIjogcGFzLCAibG9naW4iOiAic3VibWl0In0pCiAgICBfcmF3X2Nvb2tpZXNfID0gKCI7Iikuam9pbihbIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpXSkKICAgIGlmICJjX3VzZXIiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAib2siLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJjb29raWVzIjogX3Jhd19jb29raWVzX30KICAgIGVsaWYgImNoZWNrcG9pbnQiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiY3AiLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJjb29raWVzIjogX3Jhd19jb29raWVzX30KICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImVycm9yIiwgImVtYWlsIjogZW0sICJwYXNzIjogcGFzfQoKCmRlZiBsb2dfbWJhc2ljXzIoZW0sIHBhcyk6CiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCAncicpLnJlYWQoKQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgci5oZWFkZXJzLnVwZGF0ZSh7Ikhvc3QiOiAibWJhc2ljLmZhY2Vib29rLmNvbSIsICJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsICJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjogIjEiLAogICAgICAgICAgICAgICAgICAgICAgInVzZXItYWdlbnQiOiB1YSwKICAgICAgICAgICAgICAgICAgICAgICJhY2NlcHQiOiAidGV4dC9odG1sLGFwcGxpY2F0aW9uL3hodG1sK3htbCxhcHBsaWNhdGlvbi94bWw7cT0wLjksaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCIsCiAgICAgICAgICAgICAgICAgICAgICAiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiYWNjZXB0LWxhbmd1YWdlIjogImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pCiAgICBwID0gci5nZXQoImh0dHBzOi8vbWJhc2ljLmZhY2Vib29rLmNvbS8iKQogICAgYiA9IGJzNC5CZWF1dGlmdWxTb3VwKHAudGV4dCwgImh0bWwucGFyc2VyIikKICAgIG1ldGEgPSAiIi5qb2luKGJzNC5yZS5maW5kYWxsKCdkdHNnIjpceyJ0b2tlbiI6IiguKj8pIicsIHAudGV4dCkpCiAgICBkYXRhID0ge30KICAgIGZvciBpIGluIGIoImlucHV0Iik6CiAgICAgICAgaWYgaS5nZXQoInZhbHVlIikgaXMgTm9uZToKICAgICAgICAgICAgaWYgaS5nZXQoIm5hbWUiKSA9PSAiZW1haWwiOgogICAgICAgICAgICAgICAgZGF0YS51cGRhdGUoeyJlbWFpbCI6IGVtfSkKICAgICAgICAgICAgZWxpZiBpLmdldCgibmFtZSIpID09ICJwYXNzIjoKICAgICAgICAgICAgICAgIGRhdGEudXBkYXRlKHsicGFzcyI6IHBhc30pCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBkYXRhLnVwZGF0ZSh7aS5nZXQoIm5hbWUiKTogIiJ9KQogICAgICAgIGVsc2U6CiAgICAgICAgICAgIGRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOiBpLmdldCgidmFsdWUiKX0pCiAgICBkYXRhLnVwZGF0ZSh7ImZiX2R0c2ciOiBtZXRhLCAibV9zZXNzIjogIiIsICJfX3VzZXIiOiAiMCIsICJfX3JlcSI6ICJkIiwgIl9fY3NyIjogIiIsICJfX2EiOiAiIiwgIl9fZHluIjogIiIsCiAgICAgICAgICAgICAgICAgImVuY3Bhc3MiOiAiIn0pCiAgICByLmhlYWRlcnMudXBkYXRlKHsicmVmZXJlciI6ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pCiAgICBwbyA9IHIucG9zdCgKICAgICAgICAiaHR0cHM6Ly9tYmFzaWMuZmFjZWJvb2suY29tL2xvZ2luL2RldmljZS1iYXNlZC9sb2dpbi9hc3luYy8/cmVmc3JjPWh0dHBzJTNBJTJGJTJGbS5mYWNlYm9vay5jb20lMkZsb2dpbiUyRiUzRnJlZiUzRGRibCZsd3Y9MTAwIiwKICAgICAgICBkYXRhPWRhdGEpLnRleHQKICAgIF9yYXdfY29va2llc18gPSAoIjsiKS5qb2luKFsiJXM9JXMiICUgKGtleSwgdmFsdWUpIGZvciBrZXksIHZhbHVlIGluIHIuY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCldKQogICAgaWYgImNfdXNlciIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOgogICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJvayIsICJlbWFpbCI6IGVtLCAicGFzcyI6IHBhcywgImNvb2tpZXMiOiBfcmF3X2Nvb2tpZXNffQogICAgZWxpZiAiY2hlY2twb2ludCIgaW4gbGlzdChyLmNvb2tpZXMuZ2V0X2RpY3QoKS5rZXlzKCkpOgogICAgICAgIHJldHVybiB7InN0YXR1cyI6ICJjcCIsICJlbWFpbCI6IGVtLCAicGFzcyI6IHBhcywgImNvb2tpZXMiOiBfcmF3X2Nvb2tpZXNffQogICAgZWxzZToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiZXJyb3IiLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXN9CgoKZGVmIGxvZ19tb2JpbGVfMShlbSwgcGFzKToKICAgIHVhID0gX2F6aW12YXVfZGFwdW50YV8oJ3VnZW50LnR4dCcsICdyJykucmVhZCgpCiAgICByID0gcmVxdWVzdHMuU2Vzc2lvbigpCiAgICByLmhlYWRlcnMudXBkYXRlKAogICAgICAgIHsiSG9zdCI6ICJtLmZhY2Vib29rLmNvbSIsICJjYWNoZS1jb250cm9sIjogIm1heC1hZ2U9MCIsICJ1cGdyYWRlLWluc2VjdXJlLXJlcXVlc3RzIjogIjEiLCAidXNlci1hZ2VudCI6IHVhLAogICAgICAgICAiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL3dlYnAsaW1hZ2UvYXBuZywqLyo7cT0wLjgiLAogICAgICAgICAiYWNjZXB0LWVuY29kaW5nIjogImd6aXAsIGRlZmxhdGUiLCAiYWNjZXB0LWxhbmd1YWdlIjogImVuLUdCLGVuLVVTO3E9MC45LGVuO3E9MC44LGJuO3E9MC43In0pCiAgICBwID0gci5nZXQoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vIikKICAgIGIgPSByLnBvc3QoImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4ucGhwIiwgZGF0YT17ImVtYWlsIjogZW0sICJwYXNzIjogcGFzLCAibG9naW4iOiAic3VibWl0In0pCiAgICBfcmF3X2Nvb2tpZXNfID0gKCI7Iikuam9pbihbIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpXSkKICAgIGlmICJjX3VzZXIiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAib2siLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJjb29raWVzIjogX3Jhd19jb29raWVzX30KICAgIGVsaWYgImNoZWNrcG9pbnQiIGluIHIuY29va2llcy5nZXRfZGljdCgpLmtleXMoKToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiY3AiLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJjb29raWVzIjogX3Jhd19jb29raWVzX30KICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImVycm9yIiwgImVtYWlsIjogZW0sICJwYXNzIjogcGFzfQoKCmRlZiBsb2dfbW9iaWxlXzIoZW0sIHBhcyk6CiAgICB1YSA9IF9hemltdmF1X2RhcHVudGFfKCd1Z2VudC50eHQnLCAncicpLnJlYWQoKQogICAgciA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgci5oZWFkZXJzLnVwZGF0ZSgKICAgICAgICB7Ikhvc3QiOiAibS5mYWNlYm9vay5jb20iLCAiY2FjaGUtY29udHJvbCI6ICJtYXgtYWdlPTAiLCAidXBncmFkZS1pbnNlY3VyZS1yZXF1ZXN0cyI6ICIxIiwgInVzZXItYWdlbnQiOiB1YSwKICAgICAgICAgImFjY2VwdCI6ICJ0ZXh0L2h0bWwsYXBwbGljYXRpb24veGh0bWwreG1sLGFwcGxpY2F0aW9uL3htbDtxPTAuOSxpbWFnZS93ZWJwLGltYWdlL2FwbmcsKi8qO3E9MC44IiwKICAgICAgICAgImFjY2VwdC1lbmNvZGluZyI6ICJnemlwLCBkZWZsYXRlIiwgImFjY2VwdC1sYW5ndWFnZSI6ICJlbi1HQixlbi1VUztxPTAuOSxlbjtxPTAuOCxibjtxPTAuNyJ9KQogICAgcCA9IHIuZ2V0KCJodHRwczovL20uZmFjZWJvb2suY29tLyIpCiAgICBiID0gYnM0LkJlYXV0aWZ1bFNvdXAocC50ZXh0LCAiaHRtbC5wYXJzZXIiKQogICAgbWV0YSA9ICIiLmpvaW4oYnM0LnJlLmZpbmRhbGwoJ2R0c2ciOlx7InRva2VuIjoiKC4qPykiJywgcC50ZXh0KSkKICAgIGRhdGEgPSB7fQogICAgZm9yIGkgaW4gYigiaW5wdXQiKToKICAgICAgICBpZiBpLmdldCgidmFsdWUiKSBpcyBOb25lOgogICAgICAgICAgICBpZiBpLmdldCgibmFtZSIpID09ICJlbWFpbCI6CiAgICAgICAgICAgICAgICBkYXRhLnVwZGF0ZSh7ImVtYWlsIjogZW19KQogICAgICAgICAgICBlbGlmIGkuZ2V0KCJuYW1lIikgPT0gInBhc3MiOgogICAgICAgICAgICAgICAgZGF0YS51cGRhdGUoeyJwYXNzIjogcGFzfSkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGRhdGEudXBkYXRlKHtpLmdldCgibmFtZSIpOiAiIn0pCiAgICAgICAgZWxzZToKICAgICAgICAgICAgZGF0YS51cGRhdGUoe2kuZ2V0KCJuYW1lIik6IGkuZ2V0KCJ2YWx1ZSIpfSkKICAgIGRhdGEudXBkYXRlKHsiZmJfZHRzZyI6IG1ldGEsICJtX3Nlc3MiOiAiIiwgIl9fdXNlciI6ICIwIiwgIl9fcmVxIjogImQiLCAiX19jc3IiOiAiIiwgIl9fYSI6ICIiLCAiX19keW4iOiAiIiwKICAgICAgICAgICAgICAgICAiZW5jcGFzcyI6ICIifSkKICAgIHIuaGVhZGVycy51cGRhdGUoeyJyZWZlcmVyIjogImh0dHBzOi8vbS5mYWNlYm9vay5jb20vbG9naW4vP25leHQmcmVmPWRibCZmbCZyZWZpZD04In0pCiAgICBwbyA9IHIucG9zdCgKICAgICAgICAiaHR0cHM6Ly9tLmZhY2Vib29rLmNvbS9sb2dpbi9kZXZpY2UtYmFzZWQvbG9naW4vYXN5bmMvP3JlZnNyYz1odHRwcyUzQSUyRiUyRm0uZmFjZWJvb2suY29tJTJGbG9naW4lMkYlM0ZyZWYlM0RkYmwmbHd2PTEwMCIsCiAgICAgICAgZGF0YT1kYXRhKS50ZXh0CiAgICBfcmF3X2Nvb2tpZXNfID0gKCI7Iikuam9pbihbIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiByLmNvb2tpZXMuZ2V0X2RpY3QoKS5pdGVtcygpXSkKICAgIGlmICJjX3VzZXIiIGluIGxpc3Qoci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpKToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAib2siLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJjb29raWVzIjogX3Jhd19jb29raWVzX30KICAgIGVsaWYgImNoZWNrcG9pbnQiIGluIGxpc3Qoci5jb29raWVzLmdldF9kaWN0KCkua2V5cygpKToKICAgICAgICByZXR1cm4geyJzdGF0dXMiOiAiY3AiLCAiZW1haWwiOiBlbSwgInBhc3MiOiBwYXMsICJjb29raWVzIjogX3Jhd19jb29raWVzX30KICAgIGVsc2U6CiAgICAgICAgcmV0dXJuIHsic3RhdHVzIjogImVycm9yIiwgImVtYWlsIjogZW0sICJwYXNzIjogcGFzfQoKCiMjIyBDaGVjayBPcHNpCmRlZiBjZWtfb3BzaSh1c2VyLCBwdywgZm9ybWF0KToKICAgIF9yZXFfc2VzXyA9IHJlcXVlc3RzLlNlc3Npb24oKQogICAgdHJ5OgogICAgICAgIGNla19kZXZfb3BzaSA9IG9wZW4oJ29wdGlvbl8udHh0JywgJ3InKS5yZWFkKCkKICAgIGV4Y2VwdDoKICAgICAgICBjZWtfZGV2X29wc2kgPSAnbnVsbCcKICAgIHRyeToKICAgICAgICBfYXV0b19jaGFuZ2VfcGFzc18gPSBvcGVuKCdhdXRvX2dhbnRpLnR4dCcsICdyJykucmVhZCgpCiAgICBleGNlcHQ6CiAgICAgICAgX2F1dG9fY2hhbmdlX3Bhc3NfID0gJ1llcycKICAgIHRyeToKICAgICAgICBjZWtfcGlsaWhfb3BzaSA9IG9wZW4oJ211bmN1bF9vcHNpLnR4dCcsICdyJykucmVhZCgpCiAgICBleGNlcHQ6CiAgICAgICAgY2VrX3BpbGloX29wc2kgPSAnTm8nCiAgICBfcmVxX3Nlc18uaGVhZGVycy51cGRhdGUoeyJIb3N0IjogIm1iYXNpYy5mYWNlYm9vay5jb20iLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiYWNjZXB0IjogInRleHQvaHRtbCxhcHBsaWNhdGlvbi94aHRtbCt4bWwsYXBwbGljYXRpb24veG1sO3E9MC45LGltYWdlL2F2aWYsaW1hZ2Uvd2VicCxpbWFnZS9hcG5nLCovKjtxPTAuOCxhcHBsaWNhdGlvbi9zaWduZWQtZXhjaGFuZ2U7dj1iMztxPTAuOSIsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICJhY2NlcHQtZW5jb2RpbmciOiAiZ3ppcCwgZGVmbGF0ZSIsICJhY2NlcHQtbGFuZ3VhZ2UiOiAiZW4tR0IsZW4tVVM7cT0wLjkiLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAicmVmZXJlciI6ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vIiwgInVzZXItYWdlbnQiOiB1YV94aWFvbWl9KTsKICAgIF9zb3BfZGV2XyA9IHBhcihfcmVxX3Nlc18uZ2V0KGhvc3QgKyAiL2xvZ2luLz9uZXh0JnJlZj1kYmwmZmwmcmVmaWQ9OCIpLnRleHQsICJodG1sLnBhcnNlciIpOwogICAgX2xpbmt1cmxfID0gX3NvcF9kZXZfLmZpbmQoImZvcm0iLCB7Im1ldGhvZCI6ICJwb3N0In0pCiAgICBmb3IgX2NpY2lfIGluIF9zb3BfZGV2XygiaW5wdXQiKTogZGF0YV8xLnVwZGF0ZSh7X2NpY2lfLmdldCgibmFtZSIpOiBfY2ljaV8uZ2V0KCJ2YWx1ZSIpfSkKICAgIGRhdGFfMS51cGRhdGUoeyJlbWFpbCI6IHVzZXIsICJwYXNzIjogcHd9KTsKICAgIF91cmxfcG9zdF8gPSBfcmVxX3Nlc18ucG9zdChob3N0ICsgX2xpbmt1cmxfLmdldCgiYWN0aW9uIiksIGRhdGE9ZGF0YV8xKTsKICAgIF9yZXNwb25zZV8gPSBwYXIoX3VybF9wb3N0Xy50ZXh0LCAiaHRtbC5wYXJzZXIiKQogICAgaWYgImNfdXNlciIgaW4gX3JlcV9zZXNfLmNvb2tpZXMuZ2V0X2RpY3QoKToKICAgICAgICBpZiAieW91ciBhY2NvdW50IGhhcyBiZWVuIGxvY2tlZCIgaW4gX3VybF9wb3N0Xy50ZXh0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgX2Nvb2tpZXNfID0gJycuam9pbigKICAgICAgICAgICAgICAgIF9yZXFfc2VzXy5jb29raWVzLmdldF9kaWN0KCkpO19yZXN1bHRfb2tfID0gIlxyICVzWyVTVUNDRVNTRlVMTCVzXSAlcyDigKIgJXMlcyVzICAgICAgICAgICIgJSAoCiAgICAgICAgICAgIEgsIFAsIEgsIHVzZXIsIHB3LCB0YWh1bih1c2VyKSwgUCk7Y2VrX2FwayhfcmVzdWx0X29rXywgY3Z0X2Nvb2tpZXMoX2Nvb2tpZXNfKSkKICAgIGVsaWYgImNoZWNrcG9pbnQiIGluIF9yZXFfc2VzXy5jb29raWVzLmdldF9kaWN0KCk6CiAgICAgICAgX3JhdHlhXyA9IDA7CiAgICAgICAganVtbGFoX29wc2kgPSBbXTsKICAgICAgICBfdGl0bGVfZGV2XyA9IHJlLmZpbmRhbGwoIlw8dGl0bGU+KC4qPyk8XC90aXRsZT4iLCBzdHIoX3Jlc3BvbnNlXykpOwogICAgICAgIGxpbmtfMiA9IF9yZXNwb25zZV8uZmluZCgiZm9ybSIsIHsibWV0aG9kIjogInBvc3QifSk7CiAgICAgICAgbGlzdF9pbnB1dCA9IFsnZmJfZHRzZycsICdqYXpvZXN0JywgJ2NoZWNrcG9pbnRfZGF0YScsICdzdWJtaXRbQ29udGludWVdJywgJ25oJ10KICAgICAgICBmb3IgX2F6aW12YXVfIGluIF9yZXNwb25zZV8oImlucHV0Iik6CiAgICAgICAgICAgIGlmIF9hemltdmF1Xy5nZXQoIm5hbWUiKSBpbiBsaXN0X2lucHV0OiBkYXRhXzIudXBkYXRlKHtfYXppbXZhdV8uZ2V0KCJuYW1lIik6IF9hemltdmF1Xy5nZXQoInZhbHVlIil9KQogICAgICAgIF9yZXFfYWN0XyA9IF9yZXFfc2VzXy5wb3N0KGhvc3QgKyBsaW5rXzIuZ2V0KCJhY3Rpb24iKSwgZGF0YT1kYXRhXzIpOwogICAgICAgIF9yZXNwb25zZTJfID0gcGFyKF9yZXFfYWN0Xy50ZXh0LCAiaHRtbC5wYXJzZXIiKTsKICAgICAgICBfY2hlY2tfb3BzaV8gPSBbX3NhbHNhYmlsYV8udGV4dCBmb3IgX3NhbHNhYmlsYV8gaW4gX3Jlc3BvbnNlMl8uZmluZF9hbGwoIm9wdGlvbiIpXQogICAgICAgIGlmIGxlbihfY2hlY2tfb3BzaV8pID09IDA6CiAgICAgICAgICAgIGlmICJDaGVjayB0aGUgbG9naW4gZGV0YWlscyBzaG93bi4gV2FzIGl0IHlvdT8iIGluIF90aXRsZV9kZXZfOgogICAgICAgICAgICAgICAgaWYgX2F1dG9fY2hhbmdlX3Bhc3NfID09ICdZZXMnOgogICAgICAgICAgICAgICAgICAgIGNoYW5nZV9wYXNzKHVzZXIsIF9yZXFfc2VzXywgX3Jlc3BvbnNlXywgbGlua18yKQogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBpZiBjZWtfcGlsaWhfb3BzaSA9PSAnWWVzJzoKICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoZm9ybWF0KTtwcmludCgnICAgJXPigKIgJXNPTkUgVEFQIEFDQ09VTlQnICUgKEgsIFApKTtwcmludCgiIikKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBwcmludChmb3JtYXQpO3ByaW50KCcgICAlc+KAoiAlc09ORSBUQVAgQUNDT1VOVCcgJSAoSCwgUCkpCiAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgZWxpZiBsZW4oX2NoZWNrX29wc2lfKSAhPSAwOgogICAgICAgICAgICBpZiBjZWtfcGlsaWhfb3BzaSA9PSAnWWVzJzoKICAgICAgICAgICAgICAgIGZvciBfYXN1XyBpbiByYW5nZShsZW4oX2NoZWNrX29wc2lfKSk6IF9yYXR5YV8gKz0gMTtqdW1sYWhfb3BzaS5hcHBlbmQoCiAgICAgICAgICAgICAgICAgICAgIlxuICAgICAiICsgUCArIHN0cihfYXN1XyArIDEpICsgIi4gIiArIF9jaGVja19vcHNpX1tfYXN1X10gKyAiICIpCiAgICAgICAgICAgICAgICBqdW1vcCA9ICgnJXMgICBIRVJFIEFSRSAlcyBPUFRJT05TIDogJyAlIChQLCBzdHIobGVuKGp1bWxhaF9vcHNpKSkpKTsKICAgICAgICAgICAgICAgIHByaW50KGZvcm1hdCk7CiAgICAgICAgICAgICAgICBwcmludChqdW1vcCArICIiLmpvaW4oanVtbGFoX29wc2kpKTsKICAgICAgICAgICAgICAgIHByaW50KCIiKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgcHJpbnQoZm9ybWF0KQogICAgZWxzZToKICAgICAgICBpZiAncmVzdWx0JyBpbiBjZWtfZGV2X29wc2k6CiAgICAgICAgICAgIHByaW50KGZvcm1hdCk7cHJpbnQoIiVzICAgWyVzISVzXSAlc1BBU1NXT1JEIEhBUyBDSEFOR0VEIDooIiAlIChQLCBNLCBQLCBNKSk7cHJpbnQoJycpCiAgICAgICAgZWxzZToKICAgICAgICAgICAgcHJpbnQoZm9ybWF0KQoKCiMjIyBHYW50aSBQYXNzd29yZApkZWYgYXV0b19nYW50aV9wYXNzKF9waXllXyk6CiAgICB3aGlsZSBUcnVlOgogICAgICAgIF9naW1hbmFfID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIQU5HRSBPTkUgVEFQIEFDQ09VTlQgUEFTUz8gW1kvbl0gOiAnICUgKEgsIFAsIEgsIEspKQogICAgICAgIGlmIF9naW1hbmFfIGluIFsnJ106CiAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgICAgICBlbGlmIF9naW1hbmFfIGluIFsnMScsICcwMScsICcwMDEnLCAneScsICdZJ106CiAgICAgICAgICAgIG9wZW4oJ2F1dG9fZ2FudGkudHh0JywgJ3cnKS53cml0ZSgnWWVzJyk7CiAgICAgICAgICAgIF9uZXdwYXNzXyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBPTkUgVEFQIFBBU1NXT1JEIDogJyAlIChILCBQLCBILCBLKSkKICAgICAgICAgICAgaWYgbGVuKF9uZXdwYXNzXykgPCA2OgogICAgICAgICAgICAgICAgcHJpbnQoJyVzIFslcyElc10gJXNTYW5kaSBNaW5pbWFsIDYgS2FyYWt0ZXInICUgKE0sIFAsIE0sIFApKTt0aW1lLnNsZWVwKDMpO21lbnUoKQogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgb3BlbignX25ld19wYXNzXy50eHQnLCAndycpLndyaXRlKF9uZXdwYXNzXykKICAgICAgICAgICAgaWYgX3BpeWVfID09ICdZZXMnOgogICAgICAgICAgICAgICAgb3BlbignbXVuY3VsX29wc2kudHh0JywgJ3cnKS53cml0ZSgnWWVzJykKICAgICAgICAgICAgZWxpZiBfcGl5ZV8gPT0gJ05vJzoKICAgICAgICAgICAgICAgIG9wZW4oJ211bmN1bF9vcHNpLnR4dCcsICd3Jykud3JpdGUoJ05vJykKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIG9wZW4oJ211bmN1bF9vcHNpLnR4dCcsICd3Jykud3JpdGUoJ05vJykKICAgICAgICAgICAgYnJlYWsKICAgICAgICBlbGlmIF9naW1hbmFfIGluIFsnMicsICcwMicsICcwMDInLCAnTicsICduJ106CiAgICAgICAgICAgIG9wZW4oJ2F1dG9fZ2FudGkudHh0JywgJ3cnKS53cml0ZSgnTm8nKTtwYXNzCiAgICAgICAgZWxzZToKICAgICAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgUCkpO21lbnUoKQogICAgICAgIGJyZWFrCgoKZGVmIGNoYW5nZV9wYXNzKHVzZXIsIF9yZXFfc2VzXywgX3Jlc3BvbnNlXywgbGlua18yKToKICAgIGdsb2JhbCBvaywgY3AKICAgIGZpbGVzX29rID0gIk9LLyVzLnR4dCIgJSAodGFuZ2dhbCkKICAgIHRyeToKICAgICAgICBfbmV3X3Bhc3NfID0gb3BlbignX25ld19wYXNzXy50eHQnLCAncicpLnJlYWQoKQogICAgZXhjZXB0OgogICAgICAgIF9uZXdfcGFzc18gPSAnYXppbXZhdS1fJwogICAgX3Bhc3N3b3JkXyA9ICcnLmpvaW4oX25ld19wYXNzXyk7CiAgICBfcmVzdWx0X29rXyA9ICJcciAlc1slc1NVQ0NFU1NGVUxMJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiAlIChILCBQLCBILCB1c2VyLCBfcGFzc3dvcmRfLCB0YWh1bih1c2VyKSwgUCk7CiAgICBfYnV0dG9uX2Rldl8gPSBbInN1Ym1pdFtZZXNdIiwgIm5oIiwgImZiX2R0c2ciLCAiamF6b2VzdCIsICJjaGVja3BvaW50X2RhdGEiXQogICAgZm9yIF9hemltdmF1XyBpbiBfcmVzcG9uc2VfKCJpbnB1dCIpOgogICAgICAgIGlmIF9hemltdmF1Xy5nZXQoIm5hbWUiKSBpbiBfYnV0dG9uX2Rldl86IGRhdGFfY2hhbmdlXzEudXBkYXRlKHtfYXppbXZhdV8uZ2V0KCJuYW1lIik6IF9hemltdmF1Xy5nZXQoInZhbHVlIil9KQogICAgX2dhbnRpX3Bhc3NfID0gX3JlcV9zZXNfLnBvc3QoaG9zdCArIGxpbmtfMi5nZXQoImFjdGlvbiIpLCBkYXRhPWRhdGFfY2hhbmdlXzEpLnRleHQ7CiAgICBfcmVzdWx0X3Bhc3NfID0gcGFyKF9nYW50aV9wYXNzXywgImh0bWwucGFyc2VyIik7CiAgICBfbGlua18zXyA9IF9yZXN1bHRfcGFzc18uZmluZCgiZm9ybSIsIHsibWV0aG9kIjogInBvc3QifSk7CiAgICBfYnV0dG9uX2Rldl9fMl8gPSBbInN1Ym1pdFtOZXh0XSIsICJuaCIsICJmYl9kdHNnIiwgImphem9lc3QiXQogICAgaWYgIkNyZWF0ZSBhIG5ldyBwYXNzd29yZCIgaW4gcmUuZmluZGFsbCgiXDx0aXRsZT4oLio/KTxcL3RpdGxlPiIsIHN0cihfZ2FudGlfcGFzc18pKToKICAgICAgICBmb3IgX2NpY2lfIGluIF9yZXN1bHRfcGFzc18oImlucHV0Iik6CiAgICAgICAgICAgIGlmIF9jaWNpXy5nZXQoIm5hbWUiKSBpbiBfYnV0dG9uX2Rldl9fMl86IGRhdGFfY2hhbmdlXzIudXBkYXRlKHtfY2ljaV8uZ2V0KCJuYW1lIik6IF9jaWNpXy5nZXQoInZhbHVlIil9KQogICAgICAgIGRhdGFfY2hhbmdlXzIudXBkYXRlKHsicGFzc3dvcmRfbmV3IjogX3Bhc3N3b3JkX30pOwogICAgICAgIF9zZXNfZmluYWxfID0gX3JlcV9zZXNfLnBvc3QoaG9zdCArIF9saW5rXzNfLmdldCgiYWN0aW9uIiksIGRhdGE9ZGF0YV9jaGFuZ2VfMik7CiAgICAgICAgX2Nvb2tpZXNfID0gKCI7Iikuam9pbihbIiVzPSVzIiAlIChrZXksIHZhbHVlKSBmb3Iga2V5LCB2YWx1ZSBpbiBfcmVxX3Nlc18uY29va2llcy5nZXRfZGljdCgpLml0ZW1zKCldKTsKICAgICAgICBfX2Nvb2tpZXNfXyA9IGN2dF9jb29raWVzKF9jb29raWVzXyk7CiAgICAgICAgY2VrX2FwayhfcmVzdWx0X29rXywgX19jb29raWVzX18pOwogICAgICAgIG9rLmFwcGVuZCgiJXPigKIlcyIgJSAodXNlciwgX3Bhc3N3b3JkXykpOwogICAgICAgIF9hemltdmF1X2RhcHVudGFfKGZpbGVzX29rLCAiYSsiKS53cml0ZSgiJXPigKIlc1xuIiAlICh1c2VyLCBfcGFzc3dvcmRfKSk7CiAgICAgICAgY3AgLT0gMTsKICAgICAgICBwYXNzCiAgICBlbHNlOgogICAgICAgIHBhc3MKCgojIyMgQ2VrIEFwbGlrYXNpCmRlZiBjZWtfYXBrKGhfb2ssIF9hemltdmF1Xyk6CiAgICBhcGsgPSBbXTsKICAgIHNlc18gPSByZXF1ZXN0cy5TZXNzaW9uKCkKICAgIGNla19waWxpaF9vcHNpID0gb3BlbignbXVuY3VsX29wc2kudHh0JywgJ3InKS5yZWFkKCkKICAgIHVybCA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc2V0dGluZ3MvaW5zdGFudF9nYW1lcy90YWJiZWQvP3RhYj1hY3RpdmUiOwogICAgZGF0X2dhbWUgPSBzZXNfLmdldCh1cmwsIGNvb2tpZXM9eydjb29raWUnOiBfYXppbXZhdV99KTsKICAgIGRhdGFnYW1lID0gcGFyKGRhdF9nYW1lLmNvbnRlbnQsICdodG1sLnBhcnNlcicpOwogICAgZm9ybV8gPSBkYXRhZ2FtZS5maW5kKCdmb3JtJywgbWV0aG9kPSdwb3N0JykKICAgIGZvciBhc3UgaW4gZm9ybV8uZmluZF9hbGwoImgzIik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjZWxlbmcgPSBhc3UuZmluZCgnc3BhbicpLnRleHQ7YXBrLmFwcGVuZCgnXG4gICBDb25uZWN0OiAnICsgY2VsZW5nKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgdXJsMiA9ICJodHRwczovL21iYXNpYy5mYWNlYm9vay5jb20vc2V0dGluZ3MvaW5zdGFudF9nYW1lcy90YWJiZWQvP3RhYj1pbmFjdGl2ZSI7CiAgICBkYXRfZ2FtZSA9IHNlc18uZ2V0KHVybDIsIGNvb2tpZXM9eydjb29raWUnOiBfYXppbXZhdV99KTsKICAgIGRhdGFnYW1lID0gcGFyKGRhdF9nYW1lLmNvbnRlbnQsICdodG1sLnBhcnNlcicpOwogICAgZm9ybV8gPSBkYXRhZ2FtZS5maW5kKCdmb3JtJywgbWV0aG9kPSdwb3N0JykKICAgIGZvciBhc3UgaW4gZm9ybV8uZmluZF9hbGwoImgzIik6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjZWxlbmcgPSBhc3UuZmluZCgnc3BhbicpLnRleHQ7YXBrLmFwcGVuZCgnXG4gICBDb25uZWN0OiAnICsgY2VsZW5nKQogICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgcGFzcwogICAgaWYgY2VrX3BpbGloX29wc2kgPT0gJ1llcyc6CiAgICAgICAgcHJpbnQoaF9vayArICcnLmpvaW4oYXBrKSk7cHJpbnQoJycpCiAgICBlbGlmIGNla19waWxpaF9vcHNpID09ICdObyc6CiAgICAgICAgcHJpbnQoaF9vayArICcnLmpvaW4oYXBrKSkKCgojIyMgQ2VrIFRhaHVuIFBlbWJ1YXRhbgpkZWYgdGFodW4oZngpOgogICAgaWYgKHJlLmZpbmRhbGwoIlthLXpBLVpdIiwgc3RyKGZ4KSkpOgogICAgICAgIHRhaHVueiA9ICcnCiAgICBlbHNlOgogICAgICAgIGlmIGxlbihmeCkgPT0gMTU6CiAgICAgICAgICAgIGlmIGZ4WzoxMF0gaW4gWycxMDAwMDAwMDAwJ106CiAgICAgICAgICAgICAgICB0YWh1bnogPSAnIOKAoiAyMDA5JwogICAgICAgICAgICBlbGlmIGZ4Wzo5XSBpbiBbJzEwMDAwMDAwMCddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAwOScKICAgICAgICAgICAgZWxpZiBmeFs6OF0gaW4gWycxMDAwMDAwMCddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAwOScKICAgICAgICAgICAgZWxpZiBmeFs6N10gaW4gWycxMDAwMDAwJywgJzEwMDAwMDEnLCAnMTAwMDAwMicsICcxMDAwMDAzJywgJzEwMDAwMDQnLCAnMTAwMDAwNSddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAwOScKICAgICAgICAgICAgZWxpZiBmeFs6N10gaW4gWycxMDAwMDA2JywgJzEwMDAwMDcnLCAnMTAwMDAwOCcsICcxMDAwMDA5J106CiAgICAgICAgICAgICAgICB0YWh1bnogPSAnIOKAoiAyMDEwJwogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwMSddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAxMC8yMDExJwogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwMicsICcxMDAwMDMnXToKICAgICAgICAgICAgICAgIHRhaHVueiA9ICcg4oCiIDIwMTEvMjAxMicKICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDQnXToKICAgICAgICAgICAgICAgIHRhaHVueiA9ICcg4oCiIDIwMTIvMjAxMycKICAgICAgICAgICAgZWxpZiBmeFs6Nl0gaW4gWycxMDAwMDUnLCAnMTAwMDA2J106CiAgICAgICAgICAgICAgICB0YWh1bnogPSAnIOKAoiAyMDEzLzIwMTQnCiAgICAgICAgICAgIGVsaWYgZnhbOjZdIGluIFsnMTAwMDA3JywgJzEwMDAwOCddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAxNC8yMDE1JwogICAgICAgICAgICBlbGlmIGZ4Wzo2XSBpbiBbJzEwMDAwOSddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAxNScKICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwMSddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAxNS8yMDE2JwogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDAyJ106CiAgICAgICAgICAgICAgICB0YWh1bnogPSAnIOKAoiAyMDE2LzIwMTcnCiAgICAgICAgICAgIGVsaWYgZnhbOjVdIGluIFsnMTAwMDMnXToKICAgICAgICAgICAgICAgIHRhaHVueiA9ICcg4oCiIDIwMTgvMjAxOScKICAgICAgICAgICAgZWxpZiBmeFs6NV0gaW4gWycxMDAwNCddOgogICAgICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAxOS8yMDIwJwogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDA1J106CiAgICAgICAgICAgICAgICB0YWh1bnogPSAnIOKAoiAyMDIwJwogICAgICAgICAgICBlbGlmIGZ4Wzo1XSBpbiBbJzEwMDA2JywgJzEwMDA3JywgJzEwMDA4J106CiAgICAgICAgICAgICAgICB0YWh1bnogPSAnIOKAoiAyMDIxJwogICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgdGFodW56ID0gJycKICAgICAgICBlbGlmIGxlbihmeCkgaW4gWzksIDEwXToKICAgICAgICAgICAgdGFodW56ID0gJyDigKIgMjAwOC8yMDA5JwogICAgICAgIGVsaWYgbGVuKGZ4KSA9PSA4OgogICAgICAgICAgICB0YWh1bnogPSAnIOKAoiAyMDA3LzIwMDgnCiAgICAgICAgZWxpZiBsZW4oZngpID09IDc6CiAgICAgICAgICAgIHRhaHVueiA9ICcg4oCiIDIwMDYvMjAwNycKICAgICAgICBlbHNlOgogICAgICAgICAgICB0YWh1bnogPSAnJwogICAgcmV0dXJuIHRhaHVuegoKCiMjIyBDb252ZXJ0IENvb2tpZXMKZGVmIGN2dF9jb29raWVzKHJhd19jb29raWVzKToKICAgIG8gPSB7fQogICAgIyBfcmF3X2Nvb2tpZXNfd2FydmVzdF8gPSBjX3VzZXIsZGF0cixkbm9uY2UsZnIsc2IseHMKICAgICMgX3Jhd19jb29raWVzX2FhcF8gICAgID0gY191c2VyLGZyLHNiLHhzLGRhdHIKICAgICMgX2Nvb2tlZF9jb29raWVzXyAgICAgID0gc2IsZGF0cixjX3VzZXIseHMsZnIKICAgIGtpa28gPSByYXdfY29va2llcy5yZXBsYWNlKCcgJywgJycpLnNwbGl0KCc7JykKICAgIGZvciB4IGluIGtpa286CiAgICAgICAgeSA9IHguc3BsaXQoJz0nKVswXQogICAgICAgIHogPSB4LnNwbGl0KCc9JylbMV0KICAgICAgICBvLnVwZGF0ZSh7eTogen0pCiAgICBjb29rZWRfY29va2llcyA9ICgnc2I9JXM7IGRhdHI9JXM7IGNfdXNlcj0lczsgeHM9JXM7IGZyPSVzJyAlIChvWydzYiddLCBvWydkYXRyJ10sIG9bJ2NfdXNlciddLCBvWyd4cyddLCBvWydmciddKSkKICAgICMgX2Nvb2tpZXNfID0geydjb29raWUnOmNvb2tlZF9jb29raWVzfQogICAgIyBwcmludChjb29rZWRfY29va2llcykKICAgIHJldHVybiBjb29rZWRfY29va2llcwoKCiMjIyBNZXRvZGUgQ3JhY2sKZGVmIHBpbGloX21ldGhvZGUoKToKICAgIHRyeToKICAgICAgICBvcy5yZW1vdmUoJ21ldGhvZC50eHQnKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIHdoaWxlIFRydWU6CiAgICAgICAgc3RhcnRfbWV0aG9kKCkKICAgICAgICBwdXQgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzQ0hPT1NFIDogJyAlIChILCBQLCBILCBLKSkKICAgICAgICBpZiBwdXQgaW4gWycnLCAnICcsICcgICddOgogICAgICAgICAgICBjb2sgPSBvcGVuKCdtZXRob2QudHh0JywgJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbWJhc2ljX3YxJyk7Y29rLmNsb3NlKCkKICAgICAgICBlbGlmIHB1dCBpbiBbJzEnLCAnMDEnLCAnMDAxJywgJ2EnXToKICAgICAgICAgICAgY29rID0gb3BlbignbWV0aG9kLnR4dCcsICd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX2FwaV92MScpO2Nvay5jbG9zZSgpCiAgICAgICAgZWxpZiBwdXQgaW4gWycyJywgJzAyJywgJzAwMicsICdiJ106CiAgICAgICAgICAgIGNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCAndycpO2Nvay53cml0ZSgnbWV0aG9kZV9hcGlfdjInKTtjb2suY2xvc2UoKQogICAgICAgIGVsaWYgcHV0IGluIFsnMycsICcwMycsICcwMDMnLCAnYyddOgogICAgICAgICAgICBjb2sgPSBvcGVuKCdtZXRob2QudHh0JywgJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbWJhc2ljX3YxJyk7Y29rLmNsb3NlKCkKICAgICAgICBlbGlmIHB1dCBpbiBbJzQnLCAnMDQnLCAnMDA0JywgJ2QnXToKICAgICAgICAgICAgY29rID0gb3BlbignbWV0aG9kLnR4dCcsICd3Jyk7Y29rLndyaXRlKCdtZXRob2RlX21iYXNpY192MicpO2Nvay5jbG9zZSgpCiAgICAgICAgZWxpZiBwdXQgaW4gWyc1JywgJzA1JywgJzAwNScsICdlJ106CiAgICAgICAgICAgIGNvayA9IG9wZW4oJ21ldGhvZC50eHQnLCAndycpO2Nvay53cml0ZSgnbWV0aG9kZV9tb2JpbGVfdjEnKTtjb2suY2xvc2UoKQogICAgICAgIGVsaWYgcHV0IGluIFsnNicsICcwNicsICcwMDYnLCAnZiddOgogICAgICAgICAgICBjb2sgPSBvcGVuKCdtZXRob2QudHh0JywgJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbW9iaWxlX3YyJyk7Y29rLmNsb3NlKCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBjb2sgPSBvcGVuKCdtZXRob2QudHh0JywgJ3cnKTtjb2sud3JpdGUoJ21ldGhvZGVfbWJhc2ljX3YxJyk7Y29rLmNsb3NlKCkKICAgICAgICBicmVhawoKCiMjIyBDcmFjawpjbGFzcyBjcmFjazoKICAgIGRlZiBfX2luaXRfXyhzZWxmLCBmaWxlcyk6CiAgICAgICAgZ2xvYmFsIG9rLCBjcAogICAgICAgIHNlbGYuYWRhID0gb2s7CiAgICAgICAgc2VsZi5jcCA9IGNwOwogICAgICAgIHNlbGYua28gPSAwCiAgICAgICAgc2VsZi5faGF5b19tYXVfcmVjb2RlXyA9ICIxMjM0NSIKICAgICAgICBpZiBsZW4oc2VsZi5faGF5b19tYXVfcmVjb2RlXykgPT0gNToKICAgICAgICAgICAgcGFzcwogICAgICAgIGVsc2U6CiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG9zLnJlbW92ZShmaWxlcykKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcHJpbnQoIkZVQ0siKQogICAgICAgIHRyeToKICAgICAgICAgICAgb3MucmVtb3ZlKCdvcHRpb25fLnR4dCcpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgY2lrID0gb3Blbignb3B0aW9uXy50eHQnLCAndycpOwogICAgICAgIGNpay53cml0ZSgnbnVsbCcpOwogICAgICAgIGNpay5jbG9zZSgpCiAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgcGlsaWhfbWV0aG9kZSgpOwogICAgICAgICAgICBwcmludCgnJXMgJyAlIChPKSk7CiAgICAgICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNDUkFDSyBXSVRIIERFRkFVTFQgLyBNQU5VQUwgUEFTU1dPUkQgJXNbJXNkJXMvJXNtJXNdJyAlIChILCBQLCBILCBCLCBQLCBILCBQLCBLLCBQKSkKICAgICAgICAgICAgX3BpbGloX3NhbmRpXyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnICUgKEgsIFAsIEgsIEspKQogICAgICAgICAgICBpZiBfcGlsaWhfc2FuZGlfID09ICIiOgogICAgICAgICAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgUCkpO21lbnUoKQogICAgICAgICAgICBlbGlmIF9waWxpaF9zYW5kaV8gaW4gWydtJywgJ00nLCAnMicsICcwMicsICcwMDInXToKICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICB3aGlsZSBUcnVlOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFwayA9IGZpbGVzO3NlbGYuZnMgPSBfYXppbXZhdV9kYXB1bnRhXyhzZWxmLmFwaykucmVhZCgpLnNwbGl0bGluZXMoKTticmVhawogICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiICAgJXMiICUgKGUpKTtjb250aW51ZQogICAgICAgICAgICAgICAgICAgIHNlbGYuZmwgPSBbXQogICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZnM6CiAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZmwuYXBwZW5kKHsiaWQiOiBpLnNwbGl0KCLigKIiKVswXX0pCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoKCIgICAlcyIgJSBlKSk7Y29udGludWUKICAgICAgICAgICAgICAgIHByaW50KCclcyBbJXPigKIlc10gJXNFWEFNUExFIDogJXNOSUdFUklBTiwxMjM0NTYsMTIzNDU2NjU0MzIxJyAlIChILCBQLCBILCBLLCBIKSk7CiAgICAgICAgICAgICAgICBzZWxmLnB3bGlzdCgpOwogICAgICAgICAgICAgICAgYnJlYWsKICAgICAgICAgICAgZWxpZiBfcGlsaWhfc2FuZGlfIGluIFsnZCcsICdEJywgJzEnLCAnMDEnLCAnMDAxJ106CiAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgd2hpbGUgVHJ1ZToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hcGsgPSBmaWxlcztzZWxmLmZzID0gX2F6aW12YXVfZGFwdW50YV8oc2VsZi5hcGspLnJlYWQoKS5zcGxpdGxpbmVzKCk7YnJlYWsKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0IEV4Y2VwdGlvbiBhcyBlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJpbnQoIiAgICVzIiAlIChlKSk7Y29udGludWUKICAgICAgICAgICAgICAgICAgICBzZWxmLmZsID0gW107CiAgICAgICAgICAgICAgICAgICAgc3RhcnRfbWV0aG9kZXp6KCk7CiAgICAgICAgICAgICAgICAgICAga29waSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNDSE9PU0UgOiAnICUgKEgsIFAsIEgsIEspKQogICAgICAgICAgICAgICAgICAgIGlmIGtvcGkgaW4gWycnXToKICAgICAgICAgICAgICAgICAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgUCkpCiAgICAgICAgICAgICAgICAgICAgICAgIG1lbnUoKQogICAgICAgICAgICAgICAgICAgIGVsaWYga29waSBpbiBbJzEnLCAnMDEnXToKICAgICAgICAgICAgICAgICAgICAgICAgZm9yIGkgaW4gc2VsZi5mczoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmZsLmFwcGVuZCh7ImlkIjogaS5zcGxpdCgi4oCiIilbMF0sICJwdyI6IGdlbmVyYXRlMShpLnNwbGl0KCLigKIiKVsxXSl9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlCiAgICAgICAgICAgICAgICAgICAgZWxpZiBrb3BpIGluIFsnMicsICcwMiddOgogICAgICAgICAgICAgICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZzOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNlbGYuZmwuYXBwZW5kKHsiaWQiOiBpLnNwbGl0KCLigKIiKVswXSwgInB3IjogZ2VuZXJhdGUyKGkuc3BsaXQoIuKAoiIpWzFdKX0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWUKICAgICAgICAgICAgICAgICAgICBlbGlmIGtvcGkgaW4gWyczJywgJzAzJ106CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mbC5hcHBlbmQoeyJpZCI6IGkuc3BsaXQoIuKAoiIpWzBdLCAicHciOiBnZW5lcmF0ZTMoaS5zcGxpdCgi4oCiIilbMV0pfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgIGVsaWYga29waSBpbiBbJzQnLCAnMDQnXToKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3MucmVtb3ZlKCdwYXNzLnR4dCcpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgb3MucmVtb3ZlKCdkaWdpdHBhc3MudHh0JykKICAgICAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgICAgICB0YW1iYWhfcGFzcygpOwogICAgICAgICAgICAgICAgICAgICAgICB0YW1iYWhfcGFzc19hbmdrYSgpCiAgICAgICAgICAgICAgICAgICAgICAgIGZvciBpIGluIHNlbGYuZnM6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5mbC5hcHBlbmQoeyJpZCI6IGkuc3BsaXQoIuKAoiIpWzBdLCAicHciOiBnZW5lcmF0ZTQoaS5zcGxpdCgi4oCiIilbMV0pfSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgIG9zLnJlbW92ZSgnY3Bfb3B0aW9uLnR4dCcpCiAgICAgICAgICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgICAgICAgICBwYXNzCiAgICAgICAgICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgICAgICAgICAgICAgICAgIHB1ZiA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNCUklORyBVUCBDUCBPUFRJT05TPyBbWS9uXSA6ICcgJSAoSCwgUCwgSCwgSykpCiAgICAgICAgICAgICAgICAgICAgaWYgcHVmIGluIFsnJ106CiAgICAgICAgICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgICAgICAgICAgICAgICAgICBlbGlmIHB1ZiBpbiBbJzEnLCAnMDEnLCAnMDAxJywgJ3knLCAnWSddOgogICAgICAgICAgICAgICAgICAgICAgICBhdXRvX2dhbnRpX3Bhc3MoJ1llcycpO2NvayA9IG9wZW4oJ2NwX29wdGlvbi50eHQnLCAndycpO2Nvay53cml0ZSgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdvcHNpX2NwJyk7Y29rLmNsb3NlKCk7c3RhcnRlZCgpO1RocmVhZFBvb2woMzUpLm1hcChzZWxmLnN0YXJ0X2NyYWNrLCBzZWxmLmZsKTtvcy5yZW1vdmUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmFwayk7X2NpY2lfY2ljaV8oKTticmVhawogICAgICAgICAgICAgICAgICAgIGVsaWYgcHVmIGluIFsnMicsICcwMicsICcwMDInLCAnbicsICdOJ106CiAgICAgICAgICAgICAgICAgICAgICAgIGF1dG9fZ2FudGlfcGFzcygnTm8nKTtjb2sgPSBvcGVuKCdjcF9vcHRpb24udHh0JywgJ3cnKTtjb2sud3JpdGUoCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnbnVsbCcpO2Nvay5jbG9zZSgpO3N0YXJ0ZWQoKTtUaHJlYWRQb29sKDM1KS5tYXAoc2VsZi5zdGFydF9jcmFjaywgc2VsZi5mbCk7b3MucmVtb3ZlKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hcGspO19jaWNpX2NpY2lfKCk7YnJlYWsKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCiAgICAgICAgICAgICAgICBleGNlcHQgRXhjZXB0aW9uIGFzIGU6CiAgICAgICAgICAgICAgICAgICAgcHJpbnQoKCIgICAlcyIgJSBlKSkKCiAgICBkZWYgcHdsaXN0KHNlbGYpOgogICAgICAgIHNlbGYucHcgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgUEFTU1dPUkQgOiAnICUgKEssIFAsIEssIEgpKS5zcGxpdCgiLCIpCiAgICAgICAgaWYgbGVuKHNlbGYucHcpID09IDA6CiAgICAgICAgICAgIHNlbGYucHdsaXN0KCkKICAgICAgICBlbHNlOgogICAgICAgICAgICBmb3IgaSBpbiBzZWxmLmZsOiBpLnVwZGF0ZSh7InB3Ijogc2VsZi5wd30pCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIG9zLnJlbW92ZSgnY3Bfb3B0aW9uLnR4dCcpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgICAgICAgICBwdWYgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzUE9QIFVQIENQIE9QVElPTlM/IFtZL25dIDogJyAlIChILCBQLCBILCBLKSkKICAgICAgICAgICAgaWYgcHVmIGluIFsnJ106CiAgICAgICAgICAgICAgICBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSk7bWVudSgpCiAgICAgICAgICAgIGVsaWYgcHVmIGluIFsnMScsICcwMScsICcwMDEnLCAneScsICdZJ106CiAgICAgICAgICAgICAgICBhdXRvX2dhbnRpX3Bhc3MoJ1llcycpO2NvayA9IG9wZW4oJ2NwX29wdGlvbi50eHQnLCAndycpO2Nvay53cml0ZSgKICAgICAgICAgICAgICAgICAgICAnb3BzaV9jcCcpO2Nvay5jbG9zZSgpO3N0YXJ0ZWQoKTtUaHJlYWRQb29sKDMwKS5tYXAoc2VsZi5zdGFydF9jcmFjaywgc2VsZi5mbCk7b3MucmVtb3ZlKAogICAgICAgICAgICAgICAgICAgIHNlbGYuYXBrKTtfY2ljaV9jaWNpXygpCiAgICAgICAgICAgIGVsaWYgcHVmIGluIFsnMicsICcwMicsICcwMDInLCAnbicsICdOJ106CiAgICAgICAgICAgICAgICBhdXRvX2dhbnRpX3Bhc3MoJ05vJyk7Y29rID0gb3BlbignY3Bfb3B0aW9uLnR4dCcsICd3Jyk7Y29rLndyaXRlKAogICAgICAgICAgICAgICAgICAgICdudWxsJyk7Y29rLmNsb3NlKCk7c3RhcnRlZCgpO1RocmVhZFBvb2woMzApLm1hcChzZWxmLnN0YXJ0X2NyYWNrLCBzZWxmLmZsKTtvcy5yZW1vdmUoCiAgICAgICAgICAgICAgICAgICAgc2VsZi5hcGspO19jaWNpX2NpY2lfKCkKICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKCiAgICBkZWYgc3RhcnRfY3JhY2soc2VsZiwgZmwpOgogICAgICAgIHRyeToKICAgICAgICAgICAgbWV0b2RlID0gb3BlbignbWV0aG9kLnR4dCcsICdyJykucmVhZCgpCiAgICAgICAgICAgIGZvciBpIGluIGZsLmdldCgicHciKToKICAgICAgICAgICAgICAgIGlmICdtZXRob2RlX2FwaV92MScgaW4gbWV0b2RlOgogICAgICAgICAgICAgICAgICAgIGxvZyA9IGxvZ19hcGlfMShmbC5nZXQoImlkIiksIGkpCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX2FwaV92MicgaW4gbWV0b2RlOgogICAgICAgICAgICAgICAgICAgIGxvZyA9IGxvZ19hcGlfMihmbC5nZXQoImlkIiksIGkpCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21iYXNpY192MScgaW4gbWV0b2RlOgogICAgICAgICAgICAgICAgICAgIGxvZyA9IGxvZ19tYmFzaWNfMShmbC5nZXQoImlkIiksIGkpCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21iYXNpY192MicgaW4gbWV0b2RlOgogICAgICAgICAgICAgICAgICAgIGxvZyA9IGxvZ19tYmFzaWNfMihmbC5nZXQoImlkIiksIGkpCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21vYmlsZV92MScgaW4gbWV0b2RlOgogICAgICAgICAgICAgICAgICAgIGxvZyA9IGxvZ19tb2JpbGVfMShmbC5nZXQoImlkIiksIGkpCiAgICAgICAgICAgICAgICBlbGlmICdtZXRob2RlX21vYmlsZV92MicgaW4gbWV0b2RlOgogICAgICAgICAgICAgICAgICAgIGxvZyA9IGxvZ19tb2JpbGVfMihmbC5nZXQoImlkIiksIGkpCiAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgIGxvZyA9IGxvZ19tYmFzaWNfMShmbC5nZXQoImlkIiksIGkpCiAgICAgICAgICAgICAgICBpZiBsb2cuZ2V0KCJzdGF0dXMiKSA9PSAiY3AiOgogICAgICAgICAgICAgICAgICAgIGZpbGVzX2NwID0gIkNQLyVzLnR4dCIgJSAodGFuZ2dhbCkKICAgICAgICAgICAgICAgICAgICBpZiBmbC5nZXQoImlkIikgaW4gZmlsZXNfY3A6CiAgICAgICAgICAgICAgICAgICAgICAgIHBhc3MKICAgICAgICAgICAgICAgICAgICBlbHNlOgogICAgICAgICAgICAgICAgICAgICAgICB0cnk6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBrZSA9IF9yZXFfZ2V0XygiaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vIiArIGZsLmdldCgKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAiaWQiKSArICI/ZmllbGRzPW5hbWUsaWQsYmlydGhkYXksZmlyc3RfbmFtZSxtaWRkbGVfbmFtZSxsYXN0X25hbWUsbmFtZV9mb3JtYXQscGljdHVyZSxzaG9ydF9uYW1lJmFjY2Vzc190b2tlbj0iICsgX2F6aW12YXVfZGFwdW50YV8oCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgInRva2VuLnR4dCIsICJyIikucmVhZCgpKTt0dCA9IF9qc19sb18oa2UudGV4dCk7dHRsID0gdHRbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgImJpcnRoZGF5Il07bSwgZCwgeSA9IHR0bC5zcGxpdCgiLyIpO20gPSBidWxhbl90dGxbbV07dHRsbCA9ICgnIOKAoiAlcyAlcyAlcycgJSAoZCwgbSwgeSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHR0bGwgPSAoJycgJSAoKSkKICAgICAgICAgICAgICAgICAgICAgICAgaF9jcCA9ICJcciAlc1slc0NQJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiAlICgKICAgICAgICAgICAgICAgICAgICAgICAgSywgUCwgSywgZmwuZ2V0KCJpZCIpLCBpLCB0dGxsLCB0YWh1bihmbC5nZXQoImlkIikpKTsKICAgICAgICAgICAgICAgICAgICAgICAgY2VrX29wc2koZmwuZ2V0KCJpZCIpLCBpLCBoX2NwKQogICAgICAgICAgICAgICAgICAgICAgICBzZWxmLmNwLmFwcGVuZCgiJXPigKIlcyIgJSAoZmwuZ2V0KCJpZCIpLCBpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIF9hemltdmF1X2RhcHVudGFfKGZpbGVzX2NwLCAiYSsiKS53cml0ZSgiJXPigKIlcyVzXG4iICUgKGZsLmdldCgiaWQiKSwgaSwgdHRsbC5yZXBsYWNlKCcgJywgJycpKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrCiAgICAgICAgICAgICAgICBlbGlmIGxvZy5nZXQoInN0YXR1cyIpID09ICJvayI6CiAgICAgICAgICAgICAgICAgICAgZmlsZXNfb2sgPSAiT0svJXMudHh0IiAlICh0YW5nZ2FsKQogICAgICAgICAgICAgICAgICAgIGlmIGZsLmdldCgiaWQiKSBpbiBmaWxlc19vazoKICAgICAgICAgICAgICAgICAgICAgICAgcGFzcwogICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgIGlmICdtZXRob2RlX21iYXNpY192MScgaW4gbWV0b2RlIG9yICdtZXRob2RlX21iYXNpY192MicgaW4gbWV0b2RlIG9yICdtZXRob2RlX21vYmlsZV92MScgaW4gbWV0b2RlIG9yICdtZXRob2RlX21vYmlsZV92MicgaW4gbWV0b2RlOgogICAgICAgICAgICAgICAgICAgICAgICAgICAgaF9vayA9ICJcciAlc1slc1NVQ0NFU1NGVUxMJXNdICVzIOKAoiAlcyVzJXMgICAgICAgICAgIiAlICgKICAgICAgICAgICAgICAgICAgICAgICAgICAgIEgsIFAsIEgsIGZsLmdldCgiaWQiKSwgaSwgdGFodW4oZmwuZ2V0KCJpZCIpKSwgUCk7Y2VrX2FwayhoX29rLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGN2dF9jb29raWVzKGxvZy5nZXQoImNvb2tpZXMiKSkpCiAgICAgICAgICAgICAgICAgICAgICAgIGVsc2U6CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmludCgiXHIgJXNbJXNTVUNDRVNTRlVMTCVzXSAlcyDigKIgJXMlcyAgICAgICAgICAiICUgKAogICAgICAgICAgICAgICAgICAgICAgICAgICAgSCwgUCwgSCwgZmwuZ2V0KCJpZCIpLCBpLCB0YWh1bihmbC5nZXQoImlkIikpKSkKICAgICAgICAgICAgICAgICAgICAgICAgc2VsZi5hZGEuYXBwZW5kKCIlc+KAoiVzIiAlIChmbC5nZXQoImlkIiksIGkpKTsKICAgICAgICAgICAgICAgICAgICAgICAgX2F6aW12YXVfZGFwdW50YV8oZmlsZXNfb2ssICJhKyIpLndyaXRlKCIlc+KAoiVzXG4iICUgKGZsLmdldCgiaWQiKSwgaSkpOwogICAgICAgICAgICAgICAgICAgICAgICBicmVhawogICAgICAgICAgICAgICAgZWxzZToKICAgICAgICAgICAgICAgICAgICBjb250aW51ZQogICAgICAgICAgICBzZWxmLmtvICs9IDEKICAgICAgICAgICAgcHJpbnQoIlxyICVzWyVzQ3JhY2tpbmclc11bJXMlcy8lcyVzXVslc0dPT0Q6JXMlc11bJXNDUDolcyVzXSVzIiAlICgKICAgICAgICAgICAgSywgSCwgSywgUCwgc2VsZi5rbywgbGVuKHNlbGYuZmwpLCBLLCBQLCBsZW4oc2VsZi5hZGEpLCBLLCBQLCBsZW4oc2VsZi5jcCksIEssIFApLCBlbmQ9JycpOwogICAgICAgICAgICBzeXMuc3Rkb3V0LmZsdXNoKCkKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHNlbGYuc3RhcnRfY3JhY2soZmwpCgoKIyMjIE1lbmRhcGF0IEp1bWxhaCBUZW1hbiBUYXJnZXQKZGVmIHRlbWFuX3RhcmdldCgpOgogICAgaXQgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzVEFSR0VUIElEIDolcyAnICUgKEgsIFAsIEgsIEssIEgpKQogICAgdHJ5OgogICAgICAgIHRva2VuID0gX2F6aW12YXVfZGFwdW50YV8oJ3Rva2VuLnR4dCcsICdyJykucmVhZCgpO21tID0gX3JlcV9nZXRfKAogICAgICAgICAgICAnaHR0cHM6Ly9ncmFwaC5mYWNlYm9vay5jb20vJXM/YWNjZXNzX3Rva2VuPSVzJyAlIChpdCwgdG9rZW4pKTtubiA9IF9qc19sb18obW0udGV4dCk7cHJpbnQoCiAgICAgICAgICAgICclcyBbJXPigKIlc10gJXNOQU1FIDogJXMnICUgKEgsIFAsIEgsIEssIG5uWyduYW1lJ10pKQogICAgZXhjZXB0IChLZXlFcnJvciwgSU9FcnJvcik6CiAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNUT0tFTi9DT09LSUVTIElOVkFMSUQnICUgKE0sIFAsIE0sIFApKTttZW51X2xvZygpCiAgICB0dCA9IFtdOwogICAgdGUgPSBbXTsKICAgIGxpbSA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNEVU1QIExJTUlUIDogJXMnICUgKEgsIFAsIEgsIEssIEgpKTsKICAgIHByaW50KCclcyAlcycgJSAoTywgUCkpOwogICAgYWRhID0gX3JlcV9nZXRfKCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9mcmllbmRzP2xpbWl0PSVzJmFjY2Vzc190b2tlbj0lcycgJSAoaXQsIGxpbSwgdG9rZW4pKTsKICAgIGlkaSA9IF9qc19sb18oYWRhLnRleHQpCiAgICBmb3IgeCBpbiBpZGlbJ2RhdGEnXTogdHQuYXBwZW5kKHhbJ2lkJ10pCiAgICBmb3IgaWQgaW4gdHQ6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBhZGEyID0gX3JlcV9nZXRfKCdodHRwczovL2dyYXBoLmZhY2Vib29rLmNvbS8lcy9mcmllbmRzP2FjY2Vzc190b2tlbj0lcycgJSAoaWQsIHRva2VuKSk7CiAgICAgICAgICAgIGlkaTIgPSBfanNfbG9fKGFkYTIudGV4dCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgZm9yIGIgaW4gaWRpMlsnZGF0YSddOiB0ZS5hcHBlbmQoYlsnaWQnXSkKICAgICAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICAgICAgcHJpbnQoJyBbIV0gUFJJVkFURScpCiAgICAgICAgICAgIHByaW50KCcgW+KAol0nLCBpZCwgJ+KAoicsIGxlbih0ZSkpOwogICAgICAgICAgICB0ZS5jbGVhcigpCiAgICAgICAgZXhjZXB0IEtleUVycm9yOgogICAgICAgICAgICBwcmludCgnJXMgWyFdIFNQQU0gQUNDT1VOVC4uLiEnICUgKE0pKQogICAgcHJpbnQoJyAnKTsKICAgIF9jaWNpX2F6aW12YXVfKCcgWyBCQUNLIF0nKTsKICAgIG1lbnUoKQoKCiMjIyBNZW51IE1lbmdlY2VrIHJlc3VsdCBDcmFjawpkZWYgcmVzdWx0KCk6CiAgICBjbGVhcigpCiAgICBiYW5uZXIoKQogICAgamFsYW4oJyVzIFsgJXNDUkFDSyBSRVNVTFRTICVzXScgJSAoSCwgUCwgSCkpOwogICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgcHJpbnQoJyVzIFslczElc10gJXNDSEVDSyBSRVNVTFRTIE9LJyAlIChILCBQLCBILCBLKSk7CiAgICBwcmludCgnJXMgWyVzMiVzXSAlc0NIRUNLIFJFU1VMVFMgQ1AnICUgKEgsIFAsIEgsIFApKTsKICAgIGNoID0gX2NpY2lfYXppbXZhdV8oJyVzIFslc+KAoiVzXSAlc0NIT09TRSA6ICcgJSAoSCwgUCwgSCwgSykpCiAgICBpZiBjaCBpbiBbJyddOgogICAgICAgIGphbGFuKCclcyBbJXMhJXNdICVzSU5DT1JSRUNUIENPTlRFTlQnICUgKE0sIFAsIE0sIFApKTttZW51KCkKICAgIGVsaWYgY2ggaW4gWycxJywgJzAxJywgJzAwMScsICdhJ106CiAgICAgICAgdHJ5OgogICAgICAgICAgICBva2wgPSBvcy5saXN0ZGlyKCJPSyIpOwogICAgICAgICAgICBwcmludCgnJXMgJyAlIChPKSk7CiAgICAgICAgICAgIHByaW50KCclcyBbJXMgQ1JBQ0sgUkVTVUxUUyBTVE9SRUQgSU4gT0sgRklMRSAlc10nICUgKEgsIFAsIEgpKTsKICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpCiAgICAgICAgICAgIGZvciBmaWxlIGluIG9rbDogcHJpbnQoJyVzIFslc+KAoiVzXSAlcyVzJyAlIChILCBQLCBILCBLLCBmaWxlKSkKICAgICAgICAgICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgICAgICAgICBmaWxlcyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNFTlRFUiBGSUxFIE5BTUUgOiAnICUgKEgsIFAsIEgsIEspKTsKICAgICAgICAgICAgcHJpbnQoJycpCiAgICAgICAgICAgIGlmIGZpbGVzID09ICIiOiBqYWxhbignJXMgWyVzISVzXSAlc0lOQ09SUkVDVCBDT05URU5UJyAlIChNLCBQLCBNLCBQKSk7cmVzdWx0KCkKICAgICAgICAgICAgdHJ5OgogICAgICAgICAgICAgICAgcHBwID0gX2F6aW12YXVfZGFwdW50YV8oIk9LLyVzIiAlIChmaWxlcykpLnJlYWQoKS5zcGxpdGxpbmVzKCkKICAgICAgICAgICAgICAgIGZvciB4IGluIHBwcDogeXl5ID0geC5yZXBsYWNlKCfigKInLCAnIOKAoiAnKTtwcmludCgnICVzWyVzU1VDQ0VTU0ZVTCVzXSAlcycgJSAoSCwgUCwgSCwgeXl5KSkKICAgICAgICAgICAgICAgIGRlbDEgPSAoIiVzIiAlIChmaWxlcykpLnJlcGxhY2UoIi0iLCAiICIpLnJlcGxhY2UoIi50eHQiLCAiIik7CiAgICAgICAgICAgICAgICBwcmludCgnXG4lcyBbJXPigKIlc10gJXNUT1RBTCBDUkFDSyBSRVNVTFQgREFURSAlcyBJUyAlcyBBQ0NPVU5UJyAlIChILCBQLCBILCBLLCBkZWwxLCBsZW4ocHBwKSkpCiAgICAgICAgICAgIGV4Y2VwdDoKICAgICAgICAgICAgICAgIHByaW50KCclcyBbJXMgTk8gUkVTVUxUUyBGT1VORCAlc10nICUgKE0sIFAsIE0pKQogICAgICAgIGV4Y2VwdCAoS2V5RXJyb3IsIElPRXJyb3IpOgogICAgICAgICAgICBwcmludCgnJXMgWyVzIE5PIFJFU1VMVFMgRk9VTkQgJXNdJyAlIChNLCBQLCBNKSkKICAgIGVsaWYgY2ggaW4gWycyJywgJzAyJywgJzAwMicsICdiJ106CiAgICAgICAgdHJ5OgogICAgICAgICAgICBjcGwgPSBvcy5saXN0ZGlyKCJDUCIpOwogICAgICAgICAgICBwcmludCgnJXMgJyAlIChPKSk7CiAgICAgICAgICAgIHByaW50KCclcyBbJXMgQ1JBQ0sgUkVTVUxUUyBTVE9SRUQgSU4gQ1AgRklMRVMgJXNdJyAlIChILCBQLCBIKSk7CiAgICAgICAgICAgIHByaW50KCclcyAnICUgKE8pKQogICAgICAgICAgICBmb3IgZmlsZSBpbiBjcGw6IHByaW50KCclcyBbJXPigKIlc10gJXMlcycgJSAoSCwgUCwgSCwgSywgZmlsZSkpCiAgICAgICAgICAgIHByaW50KCclcyAnICUgKE8pKTsKICAgICAgICAgICAgZmlsZXMgPSBfY2ljaV9hemltdmF1XygnJXMgWyVz4oCiJXNdICVzRU5URVIgRklMRSBOQU1FIDogJyAlIChILCBQLCBILCBLKSk7CiAgICAgICAgICAgIHByaW50KCcnKQogICAgICAgICAgICBpZiBmaWxlcyA9PSAiIjogamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgUCkpO3Jlc3VsdCgpCiAgICAgICAgICAgIHRyeToKICAgICAgICAgICAgICAgIHBwcCA9IF9hemltdmF1X2RhcHVudGFfKCJDUC8lcyIgJSAoZmlsZXMpKS5yZWFkKCkuc3BsaXRsaW5lcygpCiAgICAgICAgICAgICAgICBmb3IgeCBpbiBwcHA6IHl5eSA9IHgucmVwbGFjZSgn4oCiJywgJyDigKIgJyk7cHJpbnQoJyAlc1slc0NQJXNdICVzJyAlIChLLCBQLCBLLCB5eXkpKQogICAgICAgICAgICAgICAgZGVsMSA9ICgiJXMiICUgKGZpbGVzKSkucmVwbGFjZSgiLSIsICIgIikucmVwbGFjZSgiLnR4dCIsICIiKTsKICAgICAgICAgICAgICAgIHByaW50KCdcbiVzIFslc+KAoiVzXSAlc1RPVEFMIENSQUNLIFJFU1VMVCBEQVRFICVzIElTICVzIEFDQ09VTlQnICUgKEgsIFAsIEgsIFAsIGRlbDEsIGxlbihwcHApKSkKICAgICAgICAgICAgZXhjZXB0OgogICAgICAgICAgICAgICAgcHJpbnQoJyVzIFslcyBOTyBSRVNVTFRTIEZPVU5EICVzXScgJSAoUCwgTSwgTSkpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwcmludCgnJXMgWyVzIE5PIFJFU1VMVFMgRk9VTkQgJXNdJyAlIChQLCBNLCBQKSkKICAgIGVsc2U6CiAgICAgICAgamFsYW4oJyVzIFslcyElc10gJXNJTkNPUlJFQ1QgQ09OVEVOVCcgJSAoTSwgUCwgTSwgTSkpO21lbnUoKQogICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgX2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyAlIChILCBQLCBILCBLKSk7CiAgICBtZW51KCkKCgpkZWYgY2VrX3Jlc3VsdCgpOgogICAgdHJ5OgogICAgICAgIG9zLnJlbW92ZSgnb3B0aW9uXy50eHQnKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIGNpayA9IG9wZW4oJ29wdGlvbl8udHh0JywgJ3cnKTsKICAgIGNpay53cml0ZSgncmVzdWx0Jyk7CiAgICBjaWsuY2xvc2UoKQogICAgcHJpbnQoJyVzIFsgJXNDSEVDSyBDUkFDSyBSRVNVTFQgQUNDT1VOVCBPUFRJT05TICVzXScgJSAoSCwgSywgSCkpOwogICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgcHJpbnQoJyVzIFslc+KAoiVzXSAlc0VYQU1QTEUgRklMRSA6ICVzLnR4dCcgJSAoSCwgUCwgSCwgSywgdGFuZ2dhbCkpOwogICAgZmlsZXNfXyA9IF9jaWNpX2F6aW12YXVfKCclcyBbJXPigKIlc10gJXNGaWxlIDogJyAlIChILCBQLCBILCBLKSk7CiAgICBmaWxlcyA9ICJDUC8iICsgZmlsZXNfXwogICAgdHJ5OgogICAgICAgIGJ1a2FfYmFqdSA9IF9hemltdmF1X2RhcHVudGFfKGZpbGVzLCAiciIpLnJlYWQoKS5zcGxpdGxpbmVzKCkKICAgIGV4Y2VwdCBGaWxlTm90Rm91bmRFcnJvcjoKICAgICAgICBwcmludCgiJXMgWyVzISVzXSAlc0ZJTEUgTk9UIEVYSVNUSU5HIiAlIChNLCBQLCBNLCBQKSk7dGltZS5zbGVlcCgyKTsgbWVudSgpCiAgICBhdXRvX2dhbnRpX3Bhc3MoJ1llcycpOwogICAgcHJpbnQoIiVzIFslc+KAoiVzXSAlc1RPVEFMIEFDQ09VTlRTIDogJXMlcyIgJSAoSCwgUCwgSCwgSywgSCwgc3RyKGxlbihidWthX2JhanUpKSkpOwogICAgcHJpbnQoIiIpCiAgICBmb3IgbWVtZWsgaW4gYnVrYV9iYWp1OgogICAgICAgIGlmICfDouKCrMKiJyBpbiBtZW1lazogbWVtZWsgPSBtZW1lay5yZXBsYWNlKCfDouKCrMKiJywgJ+KAoicpCiAgICAgICAga29udG9sID0gbWVtZWsucmVwbGFjZSgi4oCiIiwgIiDigKIgIik7CiAgICAgICAgdGl0aWQgPSBtZW1lay5zcGxpdCgi4oCiIikKICAgICAgICBfZm9ybWF0XyA9ICJcciAlc1slc0NQJXNdICVzICAgICAgICAgICIgJSAoSywgUCwgSywga29udG9sKQogICAgICAgIHRyeToKICAgICAgICAgICAgY2VrX29wc2kodGl0aWRbMF0sIHRpdGlkWzFdLCBfZm9ybWF0XykKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIGNvbnRpbnVlCiAgICBwcmludCgiIik7CiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzQ0hFQ0tJTkcgUFJPQ0VTUyBDT01QTEVURScgJSAoSCwgUCwgSCwgSykpOwogICAgcHJpbnQoJyVzICcgJSAoTykpOwogICAgX2NpY2lfYXppbXZhdV8oJyVzIFsgJXNCQUNLICVzXSVzJyAlIChILCBQLCBILCBLKSk7CiAgICBtZW51KCkKCgojIyMgVmFyaWFzaSBUZWtzCmRlZiB2YXJfbWVudSgpOgogICAgcHJpbnQoJyVzICAgICAgICAgIFsgJXNDSE9PU0UgTE9HSU4gTUVUSE9EICVzXScgJSAoWiwgSywgWikpCiAgICBwcmludCgnJykKICAgIHByaW50KCclcyBbJXMxJXNdICVzTE9HSU4gV0lUSCBUT0tFTiBbJXNMSU1JVEVEIEFDQ0VTUyVzXScgJSAoSCwgUCwgSCwgUCwgTSwgUCkpCiAgICBwcmludCgnJXMgWyVzMiVzXSAlc0xPR0lOIFdJVEggQ09PS0lFUyBbJXNVTkxJTUlURUQgQUNDRVNTJXNdJyAlIChILCBQLCBILCBQLCBILCBQKSkKICAgIHByaW50KCclcyBbJXMwJXNdICVzRVhJVCcgJSAoSCwgUCwgSCwgTSkpCiAgICBwcmludCgnJXMgJyAlIChPKSkKCgpkZWYgdmFyX3VnZW4oKToKICAgIHByaW50KCIlcyBbJXMxJXNdICVzR0VUIFVTRVIgQUdFTlQiICUgKEgsIFAsIEgsIEgpKQogICAgcHJpbnQoIiVzIFslczIlc10gJXNDSEFOR0UgVVNFUiBBR0VOVCAlcyglc01BTlVBTCVzKSIgJSAoSCwgUCwgSCwgUCwgQiwgSCwgQikpCiAgICBwcmludCgiJXMgWyVzMyVzXSAlc0NIQU5HRSBVU0VSIEFHRU5UICVzKCVzQURKVVNUIEhQJXMpIiAlIChILCBQLCBILCBQLCBCLCBLLCBCKSkKICAgIHByaW50KCIlcyBbJXM0JXNdICVzREVMRVRFIFVTRVIgQUdFTlQiICUgKEgsIFAsIEgsIE0pKQogICAgcHJpbnQoIiVzIFslczUlc10gJXNDSEVDSyBVU0VSIEFHRU5UIiAlIChILCBQLCBILCBLKSkKICAgIHByaW50KCIlcyBbJXMwJXNdICVzQkFDSyIgJSAoSCwgUCwgSCwgTSkpCgoKZGVmIHN0YXJ0X21ldGhvZCgpOgogICAgcHJpbnQoJyVzICcgJSAoTykpCiAgICBwcmludCgnJXMgWyVzMSVzXSAlc0FQSSBNRVRIT0QgVjEnICUgKEgsIFAsIEgsIE0pKQogICAgcHJpbnQoJyVzIFslczIlc10gJXNBUEkgTUVUSE9EIFYyJyAlIChILCBQLCBILCBCKSkKICAgIHByaW50KCclcyBbJXMzJXNdICVzV0lGSSBNT0QgVjEgW1NwZWVkXScgJSAoSCwgUCwgSCwgSCkpCiAgICBwcmludCgnJXMgWyVzNCVzXSAlc1dJRkkgTU9EIFYyJyAlIChILCBQLCBILCBLKSkKICAgIHByaW50KCclcyBbJXM1JXNdICVzTU9CSUxFIE1FVEhPRCBWMScgJSAoSCwgUCwgSCwgTykpCiAgICBwcmludCgnJXMgWyVzNiVzXSAlc01PQklMRSBNRVRIT0QgVjInICUgKEgsIFAsIEgsIFApKQoKCmRlZiBzdGFydF9tZXRob2RlenooKToKICAgIHByaW50KCIiKQogICAgcHJpbnQoJyVzIFslczElc10gJXNGQVNUIENMT05FICVzWyVzRkVXIFJFU1VMVFMlc10nICUgKEgsIFAsIEgsIE8sIE8sIE0sIE8pKQogICAgcHJpbnQoJyVzIFslczIlc10gJXNTTE9XIENMT05FICVzWyVzUkVDT01NRU5ERUQlc10nICUgKEgsIFAsIEgsIE8sIE8sIEgsIE8pKQogICAgcHJpbnQoJyVzIFslczMlc10gJXNWRVJZIFNMT1cgQ0xPTkUgJXNbJXNNT1JFIFJFU1VMVFMlc10nICUgKEgsIFAsIEgsIE8sIE8sIEIsIE8pKQogICAgcHJpbnQoJyVzIFslczQlc10gJXNDT01CSU5FRCBQQVNTV09SRCBDTE9ORScgJSAoSCwgUCwgSCwgSykpCiAgICBwcmludCgiIikKCgpkZWYgc3RhcnRlZCgpOgogICAgcHJpbnQoIiIpCiAgICBwcmludCgiICAgICAlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIlc+KAoiVz4oCiJXPigKIiICUgKAogICAgSCwgTSwgQiwgSywgVSwgTywgSywgSCwgTSwgQiwgSywgVSwgTywgSywgSCwgTSwgQiwgSykpCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzQ0xPTklORyBJTiBQUk9HUkVTUy4uLicgJSAoSCwgTSwgSCwgSCkpCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzWyVzR09PRCVzXSBJRFMgU0FWRUQgSU4gPj4gJXNHT09ELyVzLnR4dCcgJSAoSCwgQiwgSCwgTywgSCwgTywgSCwgdGFuZ2dhbCkpCiAgICBwcmludCgnJXMgWyVz4oCiJXNdICVzWyVzQ1Alc10gSURTIFNBVkVEIElOID4+ICVzQ1AvJXMudHh0JyAlIChILCBLLCBILCBPLCBNLCBPLCBNLCB0YW5nZ2FsKSkKICAgIHBzYignJXMgWyVz4oCiJXNdICVzT04gRkxJR0hUIE1PREUgRk9SIFszIFNFQ10gRVZFUlkgMyBNSU5VVEVTXG4nICUgKEgsIFAsIEgsIEIpKQoKCmRlZiBmb2xkZXIoKToKICAgIHRyeToKICAgICAgICBvcy5ta2RpcigiQ1AiKQogICAgZXhjZXB0OgogICAgICAgIHBhc3MKICAgIHRyeToKICAgICAgICBvcy5ta2RpcigiR09PRCIpCiAgICBleGNlcHQ6CiAgICAgICAgcGFzcwoKCmlmIF9fbmFtZV9fID09ICdfX21haW5fXyc6CiAgICBvcy5zeXN0ZW0oJ2dpdCBwdWxsJykKICAgIGZvbGRlcigpCiAgICBtZW51KCk= "))